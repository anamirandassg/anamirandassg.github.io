const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-BqE7FqiY.js","assets/index-CEZmhTqZ.js","assets/index-BRlA1Q7g.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/FlexSpace-_LC45Isv.js","assets/SVG-DLWu1Pum.js","assets/Util-BvnLaC1J.js"])))=>i.map(i=>d[i]);
import{l as q,_ as R,r as ne,c as D,a as V,o as ie,b as se,d as re,i as s,e as l,S as v,z as ae,F as le,E as ce,f as J,s as oe,j as w,m as H,h as de,t as p,A as K,J as me}from"./index-CEZmhTqZ.js";import{g as z,f as Q,m as ue,e as I,u as G,M as U,O as ge,b as fe,T as Y,Q as X,R as Z}from"./Util-BvnLaC1J.js";import{u as _e}from"./debounces-CcaEeBWg.js";import he from"./ButonHrm-C-2YmiFW.js";import{P as be}from"./ShowQRPrintLabel-BMsDDggY.js";/* empty css                 */import"./SVG-DLWu1Pum.js";import"./fontkit.es-CT-D8DzF.js";import"./qrcode-DHy8FFhS.js";import"./InitPrintServices-CLOyuAbw.js";import"./Toast-BVnTl0uP.js";var ee=p("<h5>"),ye=p('<div><div class=bottombx style=padding:16px><div class="_dsplFlx flxWrp spaceAround centerBx"><h4></h4>|<h4></h4><div class="icon_status centerBx"></div></div></div><div>'),ve=p("<div> <!>."),pe=p("<div> "),ke=p('<div class="bottombx flxWrp spaceAround centerBx"><h4></h4><div class="icon_status centerBx">'),$e=p('<div class="bottombx flxWrp spaceAround centerBx"><h4>'),xe=p('<div class="icon_status centerBx">'),Be=p("<h5 class=rpto>"),Se=p('<div><div class=" flxWrp centerBx "style=" margin:0 auto;;padding:8px 9px;"><div class="bag_number centerBx"><div class="icon_status centerBx"></div><h5></h5></div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5></div></div></div><div><p class=" textleft "></p><div class=vertseparator>');const we=q(()=>R(()=>import("./LoadingColorSpinner-BqE7FqiY.js"),__vite__mapDeps([0,1,2,3]))),F=q(()=>R(()=>import("./FlexSpace-_LC45Isv.js"),__vite__mapDeps([4,1,2]))),L=q(()=>R(()=>import("./SVG-DLWu1Pum.js"),__vite__mapDeps([5,1,2,6])));function Re(){const[t,u]=ne(),[n,o]=D({search:""}),[_,a]=D(),[m,N]=V(0),[P,O]=D(),[C,E]=V("");_e(E,400),ie(()=>{}),se(()=>{});const j=async()=>{if(t?.mId&&m()<Y()){N(Y()+7e3);let e={id:t?.mId},c=await Ne(e);o("manifestObj",void 0),a("linked",void 0),o("manifestObj",c),a("linked",{...c?.linkedBags}),n?.province||(o("province",c?.province),o("city",c?.city))}};re(async()=>{let e=[];[33,46,40,41,42,50,52,54,56].map(y=>{let i=y,f=I("M023009")?.whStList?.[i];K?.roles?.[f?.id]?.isActive&&e.push(f)}),O("list",e);let g=[];I("M023009")?.provincias.map(y=>{let i=y.label;K?.roles?.[i]?.isActive&&g.push(y)}),O("prov",g),j()});const x=async()=>{let e={...I("manifestList")};e[t?.mId].linkedBags=n?.manifestObj?.linkedBags,G("manifestList",e),await U(Z,X,e),j()},k=e=>e||"",h=e=>e?" "+e:"",r=e=>(k(e?.ybestate)+"_"+k(e?.ybcity)+"_"+k(e?.ybreparto)+"_"+k(e?.ybstreet)+"_"+k(e?.ybstreetNo)).toLowerCase(),b=e=>{let c=e?.consigneeInfo;return h(c?.firstName)+h(c?.middleName)+h(c?.lastName)+h(c?.lastName2)},$=e=>{let c=e?.consigneeInfo,g=h(c?.altPhoneNumber);return h(c?.phoneNumber)+(g?" |"+g:"")},te=async()=>{let e={},c={},g={};n?.manifestObj?.linkedBagsInfo?.map(i=>{if(i?.currentStatus!="YABA_99"){let f=r(i?.consigneeInfo),B=i?.cidentity,M=i?.estate||i?.consigneeInfo?.ybestate,d=i?.city||i?.consigneeInfo?.ybcity,S=i?.consigneeInfo?.ybreparto;if(g[S]||(g[S]=1),c[d]||(c[d]=1),e[f]||(e[f]={city:d,estate:M,rpto:S,address:{ybstreetNo:i?.consigneeInfo?.ybstreetNo,ybstreet:i?.consigneeInfo?.ybstreet,ybapt:i?.consigneeInfo?.ybapt,ybbetwen1:i?.consigneeInfo?.ybbetwen1,ybbetwen2:i?.consigneeInfo?.ybbetwen2},currentStatus:i?.currentStatus,customers:{},bagsNo:0}),!e[f].customers[B]){let A={name:b(i),phoneNumber:$(i),cid:i?.cidentity,nameshipper:i?.nameshipper},T={...i,...A};T.bagsNumb={},e[f].customers[B]=T}let W={bagnumber:i?.bagnumber,idairguide:"all",tracking:i?.tracking,hbls:i?.hbls};e[f].customers[B].bagsNumb[i?.ssg_track_key]=W,e[f].bagsNo+=1}});let y=await be(ge(e),e);window.open(y)};return(()=>{var e=ye(),c=e.firstChild,g=c.firstChild,y=g.firstChild,i=y.nextSibling,f=i.nextSibling,B=f.nextSibling,M=c.nextSibling;return s(y,()=>n?.manifestObj?.name),s(g,l(v,{get when(){return n?.manifestObj?.city},get children(){return["|",(()=>{var d=ee();return s(d,()=>n?.manifestObj?.city),d})()]}}),i),s(f,()=>n?.manifestObj?.province),s(g,l(v,{get when(){return 0},get children(){return l(he,{color:"#c8193c",label:"updManifest",handleClick:x})}}),B),B.$$click=te,s(B,l(L,{name:"printer",size:24,color:"firebrick"})),s(M,l(ce,{fallback:d=>(()=>{var S=ve(),W=S.firstChild,A=W.nextSibling;return A.nextSibling,s(S,()=>d.toString(),A),S})(),get children(){return l(ae,{get fallback(){return(()=>{var d=pe();return d.firstChild,s(d,l(we,{stroke:"rgb(200 25 60 / 1)",size:62}),null),d})()},get children(){return l(v,{get when(){return n?.manifestObj?.linkedBagsInfo?.length>0},get children(){return l(le,{get each(){return n?.manifestObj?.linkedBagsInfo},children:d=>l(Ie,{item:d,get city(){return n?.manifestObj?.city},get manifestObj(){return n?.manifestObj},get isAlready(){return n?.manifestObj?.linkedBags?.[d.ssg_track_key]},setFormsM:o,get mId(){return t?.mId}})})}})}})}})),J(d=>oe(M,` ${w(),"width:86vw;"} margin: 0 auto;`,d)),e})()}const Ie=t=>{const u=()=>{let a=t?.item?.street.split(",");return a.slice(0,a.length-2).join(",")},n=a=>a?" "+a:"",o=()=>{let a=t?.item?.consigneeInfo;return n(a?.firstName)+n(a?.middleName)+n(a?.lastName)+n(a?.lastName2)},_=async a=>{if(t?.item?.currentStatus!=="99"){let m=fe(I("manifestList"));m[t?.mId].linkedBags[t?.item?.ssg_track_key]&&(delete m[t?.mId].linkedBags[t?.item?.ssg_track_key],G("manifestList",m),await U(Z,X,m)),t?.setFormsM("manifestObj","linkedBags",t?.item?.ssg_track_key,void 0)}};return l(v,{get when(){return t?.manifestObj?.linkedBags[t?.item?.ssg_track_key]},get children(){var a=Se(),m=a.firstChild,N=m.firstChild,P=N.firstChild,O=P.nextSibling,C=N.nextSibling,E=C.firstChild,j=E.firstChild,x=m.nextSibling,k=x.firstChild,h=k.nextSibling;return s(a,l(v,{get when(){return w()},get children(){var r=ke(),b=r.firstChild,$=b.nextSibling;return s(b,o),s(r,l(F,{}),$),$.$$click=_,s($,l(L,{name:"outline_delete",size:28,color:"var(--background-red-ssg)"})),r}}),m),s(P,l(L,{name:"open_package_file_outline",size:20})),s(O,()=>t?.item?.bagnumber),s(m,l(v,{get when(){return!w()},get children(){var r=$e(),b=r.firstChild;return s(b,o),r}}),C),s(m,l(F,{}),C),s(j,()=>t?.item?.idairguide),s(m,l(v,{get when(){return!w()},get children(){var r=xe();return r.$$click=_,s(r,l(L,{get name(){return t?.item?.currentStatus==="YABA_99"?"check_circle":"outline_delete"},size:24,get color(){return t?.item?.currentStatus==="YABA_99"?"var(--hrm-palette-tertiary60)":"var(--background-red-ssg)"}})),r}}),null),s(k,u),s(x,l(F,{}),h),s(x,l(v,{get when(){return t?.item?.consigneeInfo?.ybreparto},get children(){return[(()=>{var r=Be();return s(r,()=>t?.item?.consigneeInfo?.ybreparto),r})(),"|"]}}),h),s(x,l(v,{get when(){return!t?.city&&t?.item?.city},get children(){var r=ee();return s(r,()=>t?.item?.city),r}}),null),J(r=>{var b=`client_item_box gWXAaj jlytmu manifest ${w()?"isMobile":""}`,$=` ${w(),"centerBx"} bottombx flxWrp  centerBx`;return b!==r.e&&H(a,r.e=b),$!==r.t&&H(x,r.t=$),r},{e:void 0,t:void 0}),a}})},ze=async(t,u)=>{let n={params:t,data2update:u},o=z(709002);return n={...n,...o},await Q(n)},Ne=async t=>{let u={params:t};if(me()){let n={...I("manifestList")?.[t?.id]},o=[],_=n?.linkedBags;return _&&Object.keys(_)?.map(async a=>{if(a){let m=I("manifestByKeys")?.[a];o.push(m)}}),n.linkedBagsInfo=o,n}else{let n=z(703003);return u={...u,...n},await Q(u)}},Qe=async t=>{let u=[];t.map(n=>{let o={params:{id:n?.ssg_track_key,idairguide:"all"}},_=z(802002);o={...o,..._},u.push(o)}),ue(u,Oe)},Oe=async t=>{const n=await Q(t);if(n)return n};de(["click"]);export{Re as default,Oe as fetchCSVInve,Qe as loadManifest,ze as updLinkedBags};
