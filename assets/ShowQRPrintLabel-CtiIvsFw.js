import{P as C,f as I,r as d}from"./fontkit.es-DH4QHzrK.js";import{q as V}from"./qrcode-DHy8FFhS.js";import{i as N,t as a}from"./InitPrintServices-C5n_a2a5.js";import{OpenToast as X}from"./Toast-B6brb46Z.js";import{q as tt,h as B,O as A}from"./index-B9OoOeu1.js";const et=s=>{let c=window?.DATAMatrix;return c?c({msg:s,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1}):null},ot=s=>{let h=s.cloneNode(!0).outerHTML,o=new Blob([h],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(o)},at=async(s,c)=>{const h=document.createElement("img");document.body.appendChild(h),h.onload=function(){const o=document.createElement("canvas");o.width=h.clientWidth,o.height=h.clientHeight,o.getContext("2d").drawImage(h,0,0);const w=o.toDataURL("image/png");document.body.removeChild(h),c(w)},h.src=s},wt=s=>new Promise(async(c,h)=>{let o=et(s),t=o&&ot(o);t&&at(t,async w=>{var p=await nt(w,"image/png");let e=URL.createObjectURL(p);c(e)})}),gt=s=>new V.QRCodeCanvas(s+"").toDataUrl(),nt=async(s,c)=>{let o=await(await fetch(s)).blob();return o=o.slice(0,o.size,c),o},bt=s=>{window.navigator.clipboard.writeText(s),X({text:s+"  copiado",timeout:1500,id:tt()})};function R(s){let c=new Blob([s],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(c)}const G=(s,c,h)=>{const o=c.widthOfTextAtSize(s,40),t=c.widthOfTextAtSize(s,10);return Math.floor(h/((o-t)/30))},ft=async(s,c,h)=>{const o=await C.create();o.registerFontkit(I);const t=await N(o);let w=265;const p=s.map(async(e,S)=>{const n=o.addPage([426,284]),{height:x}=n.getSize();let i=x-34;const _=await fetch(e?.qr).then(r=>r.arrayBuffer()),L=await o.embedPng(_);n&&L&&n.drawImage(L,{x:10,y:x-220,width:150,height:150});let y=G(a(e?.state),t.roboto_bold,w);y>42&&(y=42,i=i-6);let m=a(e?.bulto).trim();const z=t.Lexend_700?.widthOfTextAtSize(a(m),33);if(e?.isSSG){e?.state&&n.drawText(a(e?.state),{x:5,y:i-6,size:y,font:t.roboto_bold,color:d(0,0,0)}),n.drawText(a(m),{x:18,y:x-270,size:40,font:t.GSansBold,color:d(0,0,0)});const r=await fetch(B("SSG-black.png")).then(l=>l.arrayBuffer()),g=await o.embedPng(r);if(n&&g&&n.drawImage(g,{x:210,y:x-232,width:190,height:190}),e?.lbss){const l=t.Lexend_700?.widthOfTextAtSize("LBS: "+a(e?.lbss?.toFixed(2)),32);n.drawText("LBS: "+a(e?.lbss?.toFixed(2)),{x:418-l,y:i-8,size:32,font:t.Lexend_700,color:d(0,0,0)})}}else{let r=G(a(e?.name),t.GSansItalic,w);var u=t.GSansItalic?.widthOfTextAtSize(a(e?.name),r);if(u>w&&(r=r-1,u=t.GSansItalic?.widthOfTextAtSize(a(e?.name),r)),r=300/u*21,r=r>25?25:r*1,n.drawText(a(e?.name),{x:10,y:i-0,size:r,font:t.GSansItalic,color:d(0,0,0)}),e?.state){const F=t.roboto_bold?.widthOfTextAtSize(a(e?.state),y);n.drawText(a(e?.state),{x:420-F,y:i-46,size:y,font:t.roboto_bold,color:d(0,0,0)}),i=i-r}let g=29;const l=t.Lexend_700?.widthOfTextAtSize(a(e?.phoneNumber),g);n.drawText(a(e?.phoneNumber),{x:400-l,y:i-70,size:g,font:t.Lexend_700,color:d(0,0,0)});const v=t.Lexend_700?.widthOfTextAtSize(a(e?.altPhoneNumber),g);if(n.drawText(a(e?.altPhoneNumber),{x:400-v,y:i-105,size:g,font:t.Lexend_700,color:d(0,0,0)}),e?.lbss){const F=t.Lexend_700?.widthOfTextAtSize("LBS: "+a(e?.lbss?.toFixed(2)),32);n.drawText("LBS: "+a(e?.lbss?.toFixed(2)),{x:418-F,y:i-155,size:32,font:t.Lexend_700,color:d(0,0,0)})}n.drawText(a(m),{x:418-z,y:i-160,size:33,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.street),{x:2,y:i-189,size:12,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.city),{x:2,y:i-209,size:12,font:t.GSansBold,color:d(0,0,0)})}});await Promise.all(p);{const e=await o.save();return R(e)}},xt=async(s,c,h)=>{const o=await C.create();o.registerFontkit(I);const t=await N(o),w=s.map(async(p,e)=>{let S=2.795;const n=o.addPage([45*S,24*S]),{height:x}=n.getSize(),i=await fetch(p?.mtrx).then(f=>f.arrayBuffer()),_=await o.embedPng(i),L=await fetch(p?.mtrx2).then(f=>f.arrayBuffer()),y=await o.embedPng(L);n&&_&&n.drawImage(_,{x:0,y:x-32,width:30,height:30}),n.drawText(a(p?.lbl),{x:33,y:x-20,size:13,font:t.Lexend_700,color:d(0,0,0)}),n&&y&&n.drawImage(y,{x:0,y:x-66,width:30,height:30}),n.drawText(a(p?.lbl2),{x:33,y:x-56,size:13,font:t.Lexend_700,color:d(0,0,0)})});await Promise.all(w);{const p=await o.save();return R(p)}},pt=async(s,c,h)=>{const o=await C.create();o.registerFontkit(I);const t=await N(o);let w=265;const p=s.map(async(e,S)=>{const n=o.addPage([426,284]),{height:x}=n.getSize();let i=x-34,_=G(a(e?.state),t.roboto_bold,w);_>42&&(_=42,i=i-6);let y=a(e?.bulto).trim();n.drawText("("+e?.currency+") $"+(a(e?.amount)*1).toFixed(2),{x:10,y:x-260,size:45,font:t.Lexend_700,color:d(0,0,0)});let f=G(a(e?.name),t.GSansItalic,w);var m=t.GSansItalic?.widthOfTextAtSize(a(e?.name),f);m>w&&(f=f-1,m=t.GSansItalic?.widthOfTextAtSize(a(e?.name),f)),f=300/m*21,f=f>25?25:f,n.drawText(a(e?.name),{x:10,y:i-0,size:f,font:t.GSansItalic,color:d(0,0,0)});let z=29;if(e?.state){let g="CID: "+e?.state;const l=t.roboto_bold?.widthOfTextAtSize(a(g),z);n.drawText(a(g),{x:410-l,y:i-46,size:z,font:t.roboto_bold,color:d(0,0,0)}),i=i-z}let u=29;const r=t.Lexend_700?.widthOfTextAtSize(a(e?.phoneNumber),u);n.drawText(a(e?.phoneNumber),{x:400-r,y:i-60,size:u,font:t.Lexend_700,color:d(0,0,0)}),n.drawText(a(y),{x:10,y:i-95,size:10,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.rpto),{x:10,y:i-115,size:12,font:t.Lexend_700,color:d(0,0,0)}),n.drawText(a(e?.city),{x:10,y:i-135,size:15,font:t.roboto_bold,color:d(0,0,0)})});await Promise.all(p);{const e=await o.save();return R(e)}},U=(s,c)=>c?" "+s+" "+c:"",st=s=>`${U("Calle",s?.streetName)}${U("#",s?.streetNo)}${U("E/",s?.betwen)}`,ut=async(s,c,h)=>{const o=await C.create();o.registerFontkit(I);const t=await N(o),w=await fetch(B("icon_cellphone")).then(r=>r.arrayBuffer()),p=await o.embedPng(w),e=await fetch(B("icon_receipt")).then(r=>r.arrayBuffer()),S=await o.embedPng(e),n=await fetch(B("icon_home")).then(r=>r.arrayBuffer()),x=await o.embedPng(n),i=await fetch(B("icon_open_package_file_outline")).then(r=>r.arrayBuffer()),_=await o.embedPng(i),L=await fetch(B("icon_user")).then(r=>r.arrayBuffer()),y=await o.embedPng(L);let f=50,m=0,z={0:[]},u=15;console.log(s),s.map(r=>{let g=15,l=c[r];g+=A(l?.customers).length*(u+4),A(l?.customers).map(v=>{g+=A(l?.customers?.[v]?.bagsNumb).length*(u+1)}),g+=u+2,console.log({item:l,hdim:g}),console.log({h:f+g}),f+g>940&&(m+=1,z[m]||(f=50,z[m]=[])),f+=g,l.height=g,z[m].push(l)}),A(z).map((r,g)=>{const l=o.addPage(),{height:v,width:F}=l.getSize();let b=v-34;z[r].map(async(T,Q)=>{b-T.height,console.log(b-(T.height+17),T.height),Q%2&&l?.drawRectangle({x:5,y:b-(T.height-24),width:585,height:T.height-10,color:d(.895,.895,.895)});const j=(O,k)=>O?k+O:"";let H=st(T?.address)+j(T?.rpto,", Rpto ")+" |  "+a(T?.city)+"  |  "+a(T?.estate);l.drawText(""+H.toUpperCase(),{x:24,y:b,size:7,font:t.roboto_bold,color:d(0,0,0)}),x&&l.drawImage(x,{x:10,y:b-3,width:12,height:12}),b=b-u,A(T?.customers).map((O,k)=>{let P=T?.customers[O],M="Recibe:     "+P?.phoneNumber+"       "+O+" | "+P?.name+": ";var W=t.Lexend_700?.widthOfTextAtSize("Recibe: ",8.5),q=t.Lexend_700?.widthOfTextAtSize(M,8.5);l?.drawRectangle({x:24+q,y:b-1,width:560-q,height:.21,border:d(.895,.895,.895)}),l.drawText(""+M,{x:23,y:b,size:8.5,font:t.Lexend_700,color:d(0,0,0)}),p&&l.drawImage(p,{x:W+23,y:b-2.5,width:10,height:10});let Y="     "+P?.phoneNumber;var $=t.Lexend_700?.widthOfTextAtSize(Y,8.5);y&&l.drawImage(y,{x:W+23+$,y:b-2.5,width:10,height:10}),b=b-(u+2),A(P?.bagsNumb).map(E=>{let D="HBLS: ";P?.bagsNumb?.[E]?.hbls.map(J=>{D+=J?.hbl+"; "});let Z=D+"         Bolso: "+P?.bagsNumb?.[E]?.bagnumber;S&&l.drawImage(S,{x:27,y:b-2,width:9,height:9}),l.drawText(""+Z,{x:39,y:b,size:8,font:t.roboto_bold,color:d(0,0,0)});var K=t.roboto_bold?.widthOfTextAtSize(D+"  ",8);_&&l.drawImage(_,{x:K+39,y:b-2,width:9,height:9}),b=b-u}),b=b-u})})});{const r=await o.save();return R(r)}},yt=async s=>{const c=await C.create();c.registerFontkit(I);const h=await N(c),o=s.map(async(w,p)=>{const e=c.addPage([142,71]),{height:S}=e.getSize();if(w?.qr)try{const n=await fetch(w?.qr).then(i=>i.arrayBuffer()),x=await c.embedPng(n);x&&e.drawImage(x,{x:5,y:S-45,width:35,height:35})}catch(n){console.log(n)}e.drawText(a(w?.lbl),{x:50,y:S-27,size:9,font:h.Lexend_700,color:d(0,0,0)}),e.drawText(a(w?.lbl2),{x:4,y:S-62,size:7,font:h.Lexend_700,color:d(0,0,0)})});await Promise.all(o);const t=await c.save();return R(t)};export{pt as C,ut as P,ft as S,gt as a,nt as b,bt as c,yt as d,wt as g,xt as l};
