const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-nYWhmofq.js","assets/index-BZXQGr8I.js","assets/index-DI_XrWgU.css","assets/FlexSpace-DP92pPZD.js","assets/DropDwnSearch-BmBf_PVY.js","assets/debounces-C1dO4n2P.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-Bv3N0OBJ.js","assets/html5-qrcode-scanner-B1zgtRxG.js","assets/Toast-DHdi5F_B.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-iHI7sPBU.js","assets/DialogHRM-DzWfmHHw.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-12ZV3MJe.js","assets/ShowQRPrintLabel-Cb3y-6NC.js","assets/fontkit.es-D0GMkxC2.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-DOPBjM-B.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-sZwnqGpt.js","assets/LoadingColorSpinner-BRXQfn3B.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{c as H,l as h,_ as L,a as F,b as ce,o as de,d as ge,i as c,e as o,S as j,av as N,f as D,R as ue,aL as be,aM as q,F as pe,am as fe,k as b,g as Z,x as X,r as _e,t as y,aN as ye,aO as Se,aP as me,ao as ve,aQ as Q,aR as M,aS as G,an as $,O as E,$ as u,aT as he,aU as U,aV as Y,aW as W,aX as T,aY as J,m as ee,Z as Le,W as te,n as ae,p as ke,v as xe,aZ as we,ax as $e}from"./index-BZXQGr8I.js";import"./Toast-DHdi5F_B.js";import{s as Ie}from"./App.module-CbHnVtRQ.js";var Be=y('<div class="_dsplFlx flxWrp spaceAround centerBx">'),Ce=y('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),De=y('<div class="centerBx100 ">'),Ee=y('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Oe=y('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class=centerBx100 style=margin-top:20px>'),Ae=y('<div class="_dsplFlx flxWrp spaceAround centerBx"><div class=centerBx><h5 style=margin-left:12px>Iniciando...'),Fe=y("<div class=loader>Loading..."),Pe=y('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Re,je]=H(),K=h(()=>L(()=>import("./SVG-nYWhmofq.js"),__vite__mapDeps([0,1,2]))),Ke=h(()=>L(()=>import("./FlexSpace-DP92pPZD.js"),__vite__mapDeps([3,1,2]))),Me=h(()=>L(()=>import("./DropDwnSearch-BmBf_PVY.js"),__vite__mapDeps([4,1,2,5,0,6]))),Ge=h(()=>L(()=>import("./ScanningCamera-Bv3N0OBJ.js"),__vite__mapDeps([7,1,2,8,5,9,10,11,12,13,14,15,16,17,18,19,20]))),We=h(()=>L(()=>import("./ScanningManual-sZwnqGpt.js"),__vite__mapDeps([21,1,2,12,13,9,10,19,20]))),Te=h(()=>L(()=>import("./LoadingColorSpinner-BRXQfn3B.js"),__vite__mapDeps([22,1,2,23]))),[S,ne]=F(""),[O,re]=F([]);function Ve(){H({});const[e,t]=F(1),[a,s]=ye(),n=l=>()=>s(()=>t(l));ce(()=>{p()}),de(()=>{}),ge(()=>{X()&&t(0),Se(),at(),ie(),rt()});function d(){return"geolocation"in navigator}function i(l){ve({latitude:l?.coords?.latitude,longitude:l?.coords?.longitude})}function p(){d()?navigator.geolocation.getCurrentPosition(i):showMessage("Geolocation isn't supported by your browser")}const k=()=>me?.list;return(()=>{var l=Oe(),P=l.firstChild,R=P.nextSibling,m=R.nextSibling;return c(l,o(j,{get when(){return k()?.length},get fallback(){return(()=>{var r=Ae(),g=r.firstChild,f=g.firstChild;return c(g,o(Te,{stroke:"rgb(200 25 60 / 1)",size:32}),f),r})()},get children(){var r=Be();return c(r,o(Me,{get list(){return k()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return S()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:g=>ne(g.id),width:"260px"})),r}}),m),c(m,o(j,{get when(){return S()},get children(){return[(()=>{var r=Ce(),g=r.firstChild,f=g.firstChild,I=f.firstChild,v=g.nextSibling,x=v.firstChild,B=x.firstChild;return N(g,"click",n(0),!0),c(I,o(K,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),N(v,"click",n(1),!0),c(B,o(K,{name:"keyboard",size:32,color:"#2b2b2b"})),D(_=>{var w=e()===0,C=e()===1;return w!==_.e&&g.classList.toggle("selected",_.e=w),C!==_.t&&v.classList.toggle("selected",_.t=C),_},{e:void 0,t:void 0}),r})(),(()=>{var r=De();return c(r,o(ue,{get fallback(){return Fe()},get children(){return o(be,{get children(){return[o(q,{get when(){return e()===0},get children(){return o(Ge,{get status(){return S()},get locat(){return S()}})}}),o(q,{get when(){return e()===1},get children(){return o(We,{get status(){return S()},get locat(){return S()}})}})]}})}})),D(()=>r.classList.toggle("pending",!!a())),r})()]}}),null),c(m,o(j,{get when(){return O()?.length>0},get children(){return[Ee(),o(pe,{get each(){return fe(O(),"timeStamp",0)},children:(r,g)=>(()=>{var f=Pe(),I=f.firstChild,v=I.firstChild,x=v.nextSibling,B=x.nextSibling,_=I.nextSibling,w=_.firstChild,C=w.nextSibling,oe=C.nextSibling;return c(v,o(K,{get name(){return b("M023009")?.statusListIcons?.[r?.currentStatus]},size:32})),x.style.setProperty("padding","8px"),c(x,()=>r?.idairguide),B.style.setProperty("padding","8px"),c(B,()=>r?.tracking),c(f,o(Ke,{}),_),c(w,()=>r?.city),c(oe,()=>r?.consigneeInfo?.ybestate),D(()=>Z(f,`client_item_box gWXAaj jlytmu manifest  ${X()?"isMobile":"centerBx"}`)),f})()})]}}),null),D(()=>Z(l,Ie.App)),l})()}_e(["click"]);const ct=Object.freeze(Object.defineProperty({__proto__:null,default:Ve,scannedQRs:Re,setScannedQRs:je,setStatus:ne,setTaskScan:re,status:S,taskScan:O},Symbol.toStringTag,{value:"Module"}));let ze=[400,300,400,300,400],V=[300,80,300,80,300,80,300];const[He,dt]=F(!1),[gt,ut]=H({scan:{}}),Qe=e=>(e=we(e),e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-"),{params:{":search0":e.split("/")?.[0]},code:1}),bt=async(e,t)=>{let a=Qe(e),s={timeStamp:new Date().getTime(),latitude:J?.latitude,longitude:J?.longitude,statusId:t,userId:ee?.profile?.userId,userName:ee?.profile?.name,source:"webapp"};if(He(),t&&a?.params)return await Ne(a.params,s);{let n=a?.txt||a?.params?.[":search0"];return navigator.vibrate(V),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},Ne=async(e,t)=>{let a=null;if(Le()){Ue();let s=b("manifestByHbls")?.[e?.[":search0"]],n=b("manifestByKeys")?.[s];if(!n?.ssg_track_key){let d={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(V),{error:{alert:"error",color:"rgb(200 25 60)",scanData:d}}}a=Ze(n,t)}else a=await Xe(e,t);if(a?.code===203||a?.code===303)return navigator.vibrate(ze),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let s={...a.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),re([...O(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(V),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},qe=e=>e.reduce((t,a)=>t+a.hbl+";",""),Ze=(e,t)=>{let a={currentStatus:t?.statusId};e?.isSSG&&te?.roles?.SSG?.isActive;let s=e?.address?.estate||e?.consigneeInfo?.ybestate,n=e?.address?.city||e?.consigneeInfo?.ybcity;if(!te?.roles?.[s]?.isActive)return{code:303,data:{consigneeInfo:{ybcity:"Zona incorrecta ",ybestate:s,bagnumber:e?.bagnumber}}};let d=b("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(d===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:s,bagnumber:e?.bagnumber}}};let i=d?.split("_")?.[1],p=t?.statusId?.split("_")?.[1];if(i&&p&&i*1>p*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+d,ybestate:s,bagnumber:e?.bagnumber}}};let k={idairguide:e?.idairguide,city:n,estate:s,consigneeInfo:{ybestate:s,ybcity:n},bagnumber:e?.bagnumber,isSSG:e?.isSSG},l={...t};l.ssg_track_key=e?.ssg_track_key,l.ssg_scan_key=$e(),l.hbls=qe(e.hbls);let P={form:l,itmN:k,params:{airguide:e?.guia},actionKey:815005};et(P);let R={...l};tt(R);let m={...b("ScannedLocByKey")};return m[e?.ssg_track_key]=l,u("ScannedLocByKey",m),{code:200,data:{...k,...a}}},Xe=async(e,t)=>{let a={params:e,form:t},s=ae(802001);return s=ae(802008),a={...a,...s},(await ke(a))?.data};let se=null;const Ue=()=>{se||(se=setInterval(()=>{Je(),Ye()},750))},pt=()=>{A=new Date().getTime()};let A=0;const Ye=()=>{A+1250<new Date().getTime()&&(A=99999999999990,$(G,M,b("dbScannedStore")))};let z=0;const Je=()=>{z+1250<new Date().getTime()&&(z=99999999999990,$(T,W,b("ScannedLocList")))},et=async e=>{A=new Date().getTime();let t={...b("dbScannedStore")};t[xe()]=e,u("dbScannedStore",t)},tt=async e=>{z=new Date().getTime();let t={...b("ScannedLocList")};t[e?.ssg_scan_key]=e,u("ScannedLocList",t)},at=async()=>{let e=await Q(G,M);e||await $(G,M,{}),st(e)},st=async e=>{let t={};e&&E(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key,d=s?.guia;console.log(d);let i=s?.data2update?.currentStatus;t[n]||(t[n]={}),t[n][i]||(t[n][i]=1)}),u("alredyScan",t),nt(),he(E(e)?.length)},ie=async()=>{let e=await Q(Y,U);e||await $(Y,U,{});let t={},a={},s={},n={};return e&&E(e)?.map(d=>{let i=e?.[d];i?.hbls?.map(p=>{a[p?.hbl]||(a[p?.hbl]=i?.ssg_track_key,s[p?.hbl]=i)}),t[i?.ssg_track_key]||(t[i?.ssg_track_key]=i),n[i?.guia]?n[i?.guia]+=1:n[i?.guia]=1}),u("total_guia",n),u("manifestByKeys",t),u("manifestByHbls",a),u("hblsObjDBInd",s),t},nt=async()=>{await le()},rt=async()=>{await le(),ie()},le=async()=>{let e=await Q(T,W);e||await $(T,W,{});let t={};return E(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key;t[n]?t[n]?.timeStamp<s?.timeStamp&&(t[n]=s):t[n]=s}),u("ScannedLocList",e),u("ScannedLocByKey",t),e};export{ct as S,at as a,pt as b,dt as c,ut as d,gt as f,bt as h,rt as l,He as o,Ue as s,et as u};
