const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FlexSpace-D6w2aKoc.js","assets/index-CaW80A_h.js","assets/index-DEEWbFNK.css","assets/SVG-7dDJ9Chz.js","assets/Util-CKCUAuLU.js","assets/ShowQRProducts-B6nSsRS8.js","assets/ShowQRPrintLabel-DJymcF2p.js","assets/PDFButton-DzKPI8bv.js","assets/qrcode-DHy8FFhS.js","assets/fontkit.es-xY8_R9eo.js","assets/InitPrintServices-Cu6eu-iZ.js","assets/Toast-B6X5D4cW.js","assets/Toast-DLpFKn-Q.css","assets/InputHr-BBaKiPsK.js","assets/InputHr-M3rJ9grQ.css","assets/LoadingColorSpinner-BV0gCbdN.js","assets/LoadingColorSpinner-DPNLfwBi.css","assets/ButonHrm-DsEjvatv.js","assets/ButonHrm-BSeWNUGQ.css","assets/ItemOnSalesPos-DXEX9S2_.js","assets/components-C3XWuMcG.js"])))=>i.map(i=>d[i]);
import{l as S,_ as w,c as G,a as U,o as tt,k as et,b as H,i as m,d as v,F as L,S as N,j as at,e as V,s as K,n as Q,w as rt,h as it,t as E}from"./index-CaW80A_h.js";import{G as A,O as P,c as W,f as st,j as lt,i as ct,b as O}from"./Util-CKCUAuLU.js";import"./DialogHRM-CvtZeFHI.js";import"./browser-image-compression-BVJ4p9S0.js";import{OpenToast as D}from"./Toast-B6X5D4cW.js";import"./PDFButton-DzKPI8bv.js";import"./qrcode-DHy8FFhS.js";import"./fontkit.es-xY8_R9eo.js";import{I as nt}from"./print_invoice_service-v9P72DJC.js";import{g as Y,a as X}from"./handelImagesServices-D8YC5Xxt.js";import{LookupInventory as z}from"./DashInventoryMov-B1A-qoba.js";import"./DashInventory-Oxsqhg3c.js";import"./InitPrintServices-Cu6eu-iZ.js";import"./App.module-CbHnVtRQ.js";S(()=>w(()=>import("./FlexSpace-D6w2aKoc.js"),__vite__mapDeps([0,1,2])));S(()=>w(()=>import("./SVG-7dDJ9Chz.js"),__vite__mapDeps([3,1,2,4])));S(()=>w(()=>import("./ShowQRProducts-B6nSsRS8.js"),__vite__mapDeps([5,1,2,6,7,4,8,9,10,11,12])));S(()=>w(()=>import("./InputHr-BBaKiPsK.js"),__vite__mapDeps([13,1,2,14])));const j=e=>new Promise((s,o)=>{A.get(e,function(c,_){s(_)})});var ot=E('<div style="padding:50px 0"><section class=qsuVSc><section class=bLl6je><section class=dvPdhb>'),dt=E('<section class="h6rxkc ">'),ut=E('<section class=KgyCAd><section class=WirBi><section class=""><section class="EMijzc centerBx"><div class="icon_status centerBx "style="margin:0 4px"></div><div class="icon_status centerBx "style="margin:0 4px">'),mt=E('<section class=rtS8wf><div class=X3QHFf><div class="LhAUHc evth2b"><div class=kDdWge><div class=QCNFEe><p class=jhB0af>Summario de la orden</p></div><div class=qntUl><p class=B7xUP><span data-test-integ-cart-subtotal-label="">Subtotal</span><span data-test-integ-cart-subtotal-value="">$</span></p><p class=B7xUP><span data-test-integ-cart-subtotal-label="">Estimated tax</span><span data-test-integ-cart-subtotal-value="">$</span></p><p class=B7xUP><span data-test-integ-cart-subtotal-label=""class=OGw7rb>Estimated total</span><span data-test-integ-cart-subtotal-value=""class=OGw7rb> $</span></p></div></div><section class=JM2zDb>'),pt=E('<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty:</span><select class=RIw0b aria-label="Product Quantity"></select></section><p class=GehUpe data-test-line-item-price=""><span data-test-integ-cart-current-price="">$</span></p><section class=dEfaq><section class=JpKBkb><button class=yjHiqb jsaction=click:IY6UFe data-line-number=1 data-selected-quantity=1 data-test-remove-btn=1 aria-label="Remove Nest Doorbell (wired, 2nd gen) (Snow) from cart"><span>Remover'),Z=E("<option>"),ft=E('<section class=dEfaq><section><button class="yjHiqb wv2Pxc"jsaction=click:A4e0fe data-line-number=1 data-test-sfl-btn=1 aria-label="Move Nest Doorbell (wired, 2nd gen) (Snow) from cart to save for later cart."><span>Save for later</span></button></section><section class=JpKBkb><button class=yjHiqb jsaction=click:IY6UFe data-line-number=1 data-selected-quantity=1 data-test-remove-btn=1 aria-label="Remove Nest Doorbell (wired, 2nd gen) (Snow) from cart"><span>Remove'),_t=E('<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty:</span><select class=RIw0b aria-label="Product Quantity"></select></section><p class=GehUpe data-test-line-item-price=""><span data-test-integ-cart-current-price="">$');S(()=>w(()=>import("./FlexSpace-D6w2aKoc.js"),__vite__mapDeps([0,1,2])));const M=S(()=>w(()=>import("./SVG-7dDJ9Chz.js"),__vite__mapDeps([3,1,2,4])));S(()=>w(()=>import("./LoadingColorSpinner-BV0gCbdN.js"),__vite__mapDeps([15,1,2,16])));const ht=S(()=>w(()=>import("./InputHr-BBaKiPsK.js"),__vite__mapDeps([13,1,2,14]))),bt=S(()=>w(()=>import("./ButonHrm-DsEjvatv.js"),__vite__mapDeps([17,1,2,3,4,18])));S(()=>w(()=>import("./ItemOnSalesPos-DXEX9S2_.js"),__vite__mapDeps([19,1,2,4,11,12,20])));const[B,T]=G({items:{}}),F="348723orh2idsffs";function jt(){U(0),U(0);const[e,s]=U("");tt(()=>{}),et(()=>{}),H(()=>{o()});const o=async()=>{(await Ct())?.map(c=>{T("items",c.doc)})};return(()=>{var l=ot(),c=l.firstChild,_=c.firstChild,h=_.firstChild;return m(h,v(N,{get when(){return P(B?.items?.cart)},get children(){return v(L,{get each(){return P(B?.items?.cart)},children:(d,p)=>v(yt,{get itm(){return B?.items?.cart?.[d]}})})}})),m(c,v(gt,{updSearch:s}),null),m(c,v($t,{get item(){return B?.items?.cart}}),null),l})()}const gt=e=>{const[s,o]=U(""),[l,c]=U(1),_=()=>{l()===1&&s().length>8&&h(s())},h=async n=>{let b=Q?.profile?.agencyStore?.id,u=`${n}`,i=await J(u),t=P(i)?.[0],g=`${t} ${b}`,f=await z(g),a=0,r=0;P(f)?.map(C=>{f[C]?.products?.map($=>{t===$?.product?.id&&(a+=$?.price*1*$?.qty*1,r+=$?.qty*1)})});let y=1,x=await j(F)||{};x?.cart?.[t]&&(y=x?.cart?.[t].qty*1+1);const q=r?a/r:0;if(r&&r-y>=0){let C=x;if(x?.cart||(C.cart={}),x?.cart?.[t])C.cart[t].qty=y;else{let $={product:{id:t,label:i?.[t]?.name,code:i?.[t]?.code},qty:y,price:q,salePrice:i?.[t]?.salePrice};C.cart[t]=$}console.log(C),A.put(C,function(I,k){console.log(I,k)}),T("items",C),o(""),D({text:i?.[t]?.name+" agregado al carrito",timeout:3500,theme:"blue",id:O()})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})},[d,{refetch:p}]=at(s,async n=>{if(l()===2&&n.length>4){const b=await J(n);let u=[];return P(b).map(i=>{let t=b[i];u.push(t)}),u}else return[]});return(()=>{var n=ut(),b=n.firstChild,u=b.firstChild,i=u.firstChild,t=i.firstChild,g=t.nextSibling;return m(u,v(N,{get when(){return d()?.length>0},get children(){var f=dt();return m(f,v(L,{get each(){return d()},children:(a,r)=>v(xt,{itm:a})})),f}}),i),m(i,v(ht,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return s()},placeholder:"buscar productos ...",colors:"#2b2b2b",handleClick:o,onEnter:_}),t),t.$$click=()=>c(1),m(t,v(M,{name:"qrcode-scan",size:22,get color(){return l()===1?"#646cff":""}})),g.$$click=()=>c(2),m(g,v(M,{name:"keyboard",size:22,get color(){return l()===2?"#646cff":""}})),n})()},$t=e=>{const s=l=>{let c=0;return P(e?.item)?.map(_=>{let h=e?.item?.[_];c+=h?.qty*1*h?.salePrice}),c},o=async l=>{let c={...e?.item};c.amount=s();let _=await nt(c);window.open(_)};return(()=>{var l=mt(),c=l.firstChild,_=c.firstChild,h=_.firstChild,d=h.firstChild,p=d.nextSibling,n=p.firstChild,b=n.firstChild,u=b.nextSibling;u.firstChild;var i=n.nextSibling,t=i.firstChild,g=t.nextSibling;g.firstChild;var f=i.nextSibling,a=f.firstChild,r=a.nextSibling;r.firstChild;var y=h.nextSibling;return m(u,()=>s().toFixed(2),null),m(g,()=>(s()*.06).toFixed(2),null),m(r,()=>(s()*.06+s()).toFixed(2),null),m(y,v(bt,{color:"#646cff",label:"Imprimir",handleClick:o})),l})()},yt=e=>{const[s,o]=G(),l=()=>s?.[e?.itm?.product?.id]?.productImageUrl?Y()+X()+"/"+s?.[e?.itm?.product?.id]?.productImageUrl:null,c=async()=>{let d=e?.itm?.product?.id,p=`${d}`,n=await J(p);n?.[d]?.productImageUrl&&o(d,n?.[d])};H(()=>{c()});let _=Array.from(Array(10).keys());const h=async d=>{let p=Q?.profile?.agencyStore?.id,n=e?.itm?.product?.id,b=`${n} ${p}`,u=await z(b),i=0,t=0;P(u)?.map(f=>{u[f]?.products?.map(a=>{n===a?.product?.id&&(i+=a?.price*1*a?.qty*1,t+=a?.qty*1)})});const g=t?i/t:0;if(t&&t-d>=0){let f=await j(F)||{},a=f;if(f?.cart||(a.cart={}),f?.cart?.[n])a.cart[n].qty=d;else{let r={product:{id:n,label:e?.itm?.name,code:e?.itm?.code},qty:d,price:g,salePrice:e?.itm?.salePrice};a.cart[n]=r}A.put(a,function(y,x){}),T("items",a),D({text:" El carrito fue actualizado",timeout:3500,theme:"blue",id:O()})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})};return(()=>{var d=pt(),p=d.firstChild,n=p.firstChild,b=n.firstChild,u=b.firstChild,i=u.firstChild,t=u.nextSibling,g=t.firstChild,f=g.firstChild,a=f.firstChild;a.firstChild;var r=g.nextSibling,y=r.firstChild,x=y.firstChild,q=x.nextSibling,C=y.nextSibling,$=C.firstChild;return $.firstChild,m(a,()=>e?.itm?.product?.label,null),q.addEventListener("change",I=>{h(I?.target?.value)}),m(q,v(L,{each:_,children:(I,k)=>(()=>{var R=Z();return R.value=I*1+1+"",m(R,I*1+1),V(()=>R.selected=I*1+1===e?.itm?.qty*1),R})()})),m($,()=>(e?.itm?.salePrice*1).toFixed(2),null),V(()=>K(i,"src",l())),d})()},J=async(e,s)=>{let o={params:{businessId:Q?.profile?.businessYId}};e&&e.split(" ").map((_,h)=>{_&&(o.params[":search"+h]=_.trim())});let l=W(122001);o={...o,...l},o.params[":search0"];const c=await st(o);return c?.error?{}:c},Ft=async e=>{let s=[];e.map(o=>{let l={params:{id:o?.ssg_track_key,idairguide:"all"}},c=W(802002);l={...l,...c},s.push(l)}),lt(s,vt)},vt=async e=>{const o=await ct(e);if(o)return o},Ct=()=>new Promise((e,s)=>{A.allDocs({include_docs:!0,descending:!0},function(o,l){e(l.rows)})}),xt=e=>{const[s,o]=G(),l=()=>s?.prod?.productImageUrl?Y()+X()+"/"+s?.prod?.productImageUrl:null;H(()=>{o("prod",e?.itm)});let c=Array.from(Array(10).keys());const _=async h=>{let d=Q?.profile?.agencyStore?.id,p=e?.itm?.product?.id,n=`${p} ${d}`,b=await z(n),u=0,i=0;P(b)?.map(a=>{b[a]?.products?.map(r=>{p===r?.product?.id&&(u+=r?.price*1*r?.qty*1,i+=r?.qty*1)})});let t=1,g=await j(F)||{};g?.cart?.[p]&&(t=g?.cart?.[p].qty+1);const f=i?u/i:0;if(i&&i-t>=0){let a=await j(F)||{},r=a;if(a?.cart||(r.cart={}),a?.cart?.[p])r.cart[p].qty=t;else{let y={product:{id:p,label:e?.itm?.name,code:e?.itm?.code},qty:t,price:f,salePrice:e?.itm?.salePrice};r.cart[p]=y}A.put(r,function(x,q){}),T("items",r),D({text:" El carrito fue actualizado",timeout:3500,theme:"blue",id:O()})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})};return(()=>{var h=_t(),d=h.firstChild,p=d.firstChild,n=p.firstChild,b=n.firstChild,u=b.firstChild,i=b.nextSibling,t=i.firstChild,g=t.firstChild,f=g.firstChild;f.firstChild;var a=t.nextSibling,r=a.firstChild,y=r.firstChild,x=y.nextSibling,q=r.nextSibling,C=q.firstChild;return C.firstChild,m(f,()=>e?.itm?.name,null),x.addEventListener("change",$=>{_($?.target?.value)}),m(x,v(L,{each:c,children:($,I)=>(()=>{var k=Z();return k.value=$*1+1+"",m(k,$*1+1),V(()=>k.selected=$*1+1===e?.itm?.qty*1),k})()})),m(C,()=>(e?.itm?.salePrice*1).toFixed(2),null),m(a,v(N,{get when(){return rt()},get children(){return ft()}}),null),V(()=>K(u,"src",l())),h})()};it(["click"]);export{J as LookupProducts,B as cartItems,F as cartKey,jt as default,vt as fetchCSVInve,Ct as loadCarts,Ft as loadProduct,T as setCartItems};
