const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-BhZpf4cT.js","assets/index-CNUk02wX.js","assets/index-B8bAFC38.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/FlexSpace-DqsnDapP.js","assets/SVG-C3WI3KHa.js","assets/Util-CfNBEKzJ.js"])))=>i.map(i=>d[i]);
import{l as q,_ as H,r as se,c as G,a as V,o as re,b as ne,d as ae,i as s,e as l,S as N,z as le,F as ce,E as oe,f as R,h as C,j as T,s as de,k as K,m as me,t as b,A as Y,T as ge}from"./index-CNUk02wX.js";import{j as O,g as X,b as Z,n as ue,u as ee,O as he,d as fe,F as _e,J,G as ve,H as pe}from"./Util-CfNBEKzJ.js";import{u as be}from"./debounces-Oe_cYys3.js";import"./ButonHrm-C-tUVSXw.js";import{P as $e}from"./ShowQRPrintLabel-B7-gl4A5.js";import{i as ye,h as xe}from"./DashManifest-BJSQJsX7.js";import"./Reports-C5c3pYCo.js";/* empty css                 */import"./SVG-C3WI3KHa.js";import"./fontkit.es-MWxJo8uD.js";import"./qrcode-DHy8FFhS.js";import"./InitPrintServices-C-73XkvZ.js";import"./Toast-BagKC026.js";import"./App.module-CbHnVtRQ.js";import"./DialogHRM-CCkYNqX4.js";import"./ScanningServices-MFXrLS_A.js";var ke=b('<svg viewBox="0 0 24 24"xmlns=http://www.w3.org/2000/svg height=22 width=22><path>'),te=b("<h5>"),Se=b('<div><div class=bottombx style=padding:16px><div class="_dsplFlx flxWrp spaceAround centerBx"><h4></h4>|<h4></h4><div class="icon_status centerBx"><a class=centerBx></a></div>|<div class="icon_status centerBx"></div></div></div><div>'),we=b("<div> <!>."),Be=b("<div> "),Ne=b('<div class="bottombx flxWrp spaceAround centerBx"><h4></h4><div class="icon_status centerBx">'),Ae=b("<img width=48 height=24 class=picture-profile alt=ssg decoding=async>"),Ie=b('<div class="bottombx flxWrp spaceAround centerBx"><h4>'),Ce=b('<div class="icon_status centerBx">'),Oe=b("<h5 class=rpto>"),je=b('<div><div class=" flxWrp centerBx "style=" margin:0 auto;;padding:8px 9px;"><div class="bag_number centerBx"><div class="icon_status centerBx"></div><h5></h5></div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5></div></div></div><div><p class=" textleft "></p><div class=vertseparator>');const Le=q(()=>H(()=>import("./LoadingColorSpinner-BhZpf4cT.js"),__vite__mapDeps([0,1,2,3]))),U=q(()=>H(()=>import("./FlexSpace-DqsnDapP.js"),__vite__mapDeps([4,1,2]))),L=q(()=>H(()=>import("./SVG-C3WI3KHa.js"),__vite__mapDeps([5,1,2,6])));function Ze(){const[t,g]=se(),[i,m]=G({search:""}),[x,o]=G(),[d,j]=V(0),[z,E]=G(),[M,F]=V("");be(F,400),re(()=>{}),ne(()=>{});const W=async()=>{if(t?.mId&&d()<J()){j(J()+7e3);let e={id:t?.mId},c=await Me(e);m("manifestObj",void 0),o("linked",void 0),m("manifestObj",c),o("linked",{...c?.linkedBags}),i?.province||(m("province",c?.province),m("city",c?.city))}};ae(async()=>{ye();let e=[];[33,46,40,41,42,50,52,54,56].map(h=>{let $=h,w=O("M023009")?.whStList?.[$];Y?.roles?.[w?.id]?.isActive&&e.push(w)}),E("list",e);let u=[];O("M023009")?.provincias.map(h=>{let $=h.label;Y?.roles?.[$]?.isActive&&u.push(h)}),E("prov",u),W()});const v=e=>e||"",k=e=>e?" "+e:"",P=e=>(v(e?.estate)+"_"+v(e?.city)+"_"+v(e?.rpto)+"_"+v(e?.streetName)+"_"+v(e?.streetNo)).toLowerCase(),r=e=>{if(e?.consigneeName)return e?.consigneeName;let c=e?.consigneeInfo;return k(c?.firstName)+k(c?.middleName)+k(c?.lastName)+k(c?.lastName2)},S=e=>{if(e?.ctelephone)return e?.ctelephone;let c=e?.consigneeInfo,u=k(c?.altPhoneNumber);return k(c?.phoneNumber)+(u?" |"+u:"")},A=e=>new Promise((c,u)=>{let h=(()=>{var _=ke(),B=_.firstChild;return R(()=>T(B,"d",ge?.[e])),_})(),$=h.cloneNode(!0);const w=new XMLSerializer().serializeToString($),y=`data:image/svg+xml;charset=utf-8;base64,${btoa(unescape(encodeURIComponent(w)))}`,f=new Image;f.addEventListener("load",()=>{const _=h.getAttribute("width"),B=h.getAttribute("height"),a=document.createElement("canvas");a.setAttribute("width",_),a.setAttribute("height",B),a.getContext("2d").drawImage(f,0,0,_,B);const I=a.toDataURL("image/png");c(I)}),f.src=y}),ie=async()=>{let e={},c={},u={};const $=["cellphone","receipt","home","open_package_file_outline","user"].map(async n=>{let y=await A(n);ee("icon_"+n,y)});await Promise.all($),i?.manifestObj?.linkedBagsInfo?.map(n=>{if(n?.currentStatus!="YABA_99"){let y=n?.address;n?.isSSG&&(y={streetName:"ANGEL GUERRA",streetNo:"16A",rpto:"PERALTA",betwen:"ESQUINA FOMENTO",city:"HOLGUIN",estate:"HOLGUIN"});let f=P(y),_=n?.cidentity,B=n?.address?.estate,a=n?.address?.city,p=n?.address?.Rpto||n?.address?.rpto;if(u[p]||(u[p]=1),c[a]||(c[a]=1),e[f]||(e[f]={city:a,estate:B,rpto:p,address:y,currentStatus:n?.currentStatus,customers:{},bagsNo:0}),!e[f].customers[_]){let D={name:r(n),phoneNumber:S(n),cid:n?.cidentity,nameshipper:n?.nameshipper},Q={...n,...D};Q.bagsNumb={},e[f].customers[_]=Q}let I={bagnumber:n?.bagnumber,idairguide:n?.guia,tracking:n?.tracking,hbls:n?.hbls};e[f].customers[_].bagsNumb[n?.ssg_track_key]=I,e[f].bagsNo+=1}});let w=await $e(he(e),e);window.open(w)};return(()=>{var e=Se(),c=e.firstChild,u=c.firstChild,h=u.firstChild,$=h.nextSibling,w=$.nextSibling,n=w.nextSibling,y=n.firstChild,f=n.nextSibling,_=f.nextSibling,B=c.nextSibling;return s(h,()=>i?.manifestObj?.name),s(u,l(N,{get when(){return i?.manifestObj?.city},get children(){return["|",(()=>{var a=te();return s(a,()=>i?.manifestObj?.city),a})()]}}),$),s(w,()=>i?.manifestObj?.province),n.$$click=()=>{},s(y,l(L,{name:"link",size:22})),_.$$click=ie,s(_,l(L,{name:"printer",size:24,color:"firebrick"})),s(B,l(oe,{fallback:a=>(()=>{var p=we(),I=p.firstChild,D=I.nextSibling;return D.nextSibling,s(p,()=>a.toString(),D),p})(),get children(){return l(le,{get fallback(){return(()=>{var a=Be();return a.firstChild,s(a,l(Le,{stroke:"rgb(200 25 60 / 1)",size:62}),null),a})()},get children(){return l(N,{get when(){return i?.manifestObj?.linkedBagsInfo?.length>0},get children(){return l(ce,{get each(){return i?.manifestObj?.linkedBagsInfo},children:a=>l(Ee,{item:a,get city(){return i?.manifestObj?.city},get manifestObj(){return i?.manifestObj},get isAlready(){return i?.manifestObj?.linkedBags?.[a.ssg_track_key]},setFormsM:m,get mId(){return t?.mId}})})}})}})}})),R(a=>{var p=`/link-manifest?mId=${t?.mId}`,I=` ${C(),"width:86vw;"} margin: 0 auto;`;return p!==a.e&&T(y,"href",a.e=p),a.t=de(B,I,a.t),a},{e:void 0,t:void 0}),e})()}const Ee=t=>{const g=()=>{let o=t?.item?.street.split(",");return o.slice(0,o.length-2).join(",")},i=o=>o?" "+o:"",m=o=>{if(o?.consigneeName)return o?.consigneeName;let d=o?.consigneeInfo;return i(d?.firstName)+i(d?.middleName)+i(d?.lastName)+i(d?.lastName2)},x=async o=>{if(t?.item?.currentStatus!=="99"){let d=fe(O("manifestList"));d[t?.mId].linkedBags[t?.item?.ssg_track_key]&&(delete d[t?.mId].linkedBags[t?.item?.ssg_track_key],ee("manifestList",d),await _e(pe,ve,d)),t?.setFormsM("manifestObj","linkedBags",t?.item?.ssg_track_key,void 0)}};return l(N,{get when(){return t?.manifestObj?.linkedBags[t?.item?.ssg_track_key]},get children(){var o=je(),d=o.firstChild,j=d.firstChild,z=j.firstChild,E=z.nextSibling,M=j.nextSibling,F=M.firstChild,W=F.firstChild,v=d.nextSibling,k=v.firstChild,P=k.nextSibling;return s(o,l(N,{get when(){return C()},get children(){var r=Ne(),S=r.firstChild,A=S.nextSibling;return s(S,()=>m(t?.item)),s(r,l(U,{}),A),A.$$click=x,s(A,l(L,{name:"outline_delete",size:28,color:"var(--background-red-ssg)"})),r}}),d),s(d,l(N,{get when(){return t?.item?.isSSG},get children(){var r=Ae();return R(()=>T(r,"src",O("SSG.webp"))),r}}),j),s(z,l(L,{name:"open_package_file_outline",size:20})),s(E,()=>t?.item?.bagnumber),s(d,l(N,{get when(){return!C()},get children(){var r=Ie(),S=r.firstChild;return s(S,()=>m(t?.item)),r}}),M),s(d,l(U,{}),M),s(W,()=>t?.item?.idairguide),s(d,l(N,{get when(){return!C()},get children(){var r=Ce();return r.$$click=x,s(r,l(L,{get name(){return t?.item?.currentStatus==="YABA_99"?"check_circle":"outline_delete"},size:24,get color(){return t?.item?.currentStatus==="YABA_99"?"var(--hrm-palette-tertiary60)":"var(--background-red-ssg)"}})),r}}),null),s(k,g),s(v,l(U,{}),P),s(v,l(N,{get when(){return t?.item?.address?.rpto},get children(){return[(()=>{var r=Oe();return s(r,()=>t?.item?.address?.rpto),r})(),"|"]}}),P),s(v,l(N,{get when(){return!t?.city&&t?.item?.address?.city},get children(){var r=te();return s(r,()=>t?.item?.address?.city),r}}),null),R(r=>{var S=`client_item_box gWXAaj jlytmu manifest ${C()?"isMobile":""}`,A=` ${C(),"centerBx"} bottombx flxWrp  centerBx`;return S!==r.e&&K(o,r.e=S),A!==r.t&&K(v,r.t=A),r},{e:void 0,t:void 0}),o}})},et=async(t,g)=>{let i={params:t,data2update:g},m=X(709002);return i={...i,...m},await Z(i)},Me=async t=>{let g={...O("manifestList")?.[t?.id]};g||(g=await xe());let i=[],m=g?.linkedBags;return m&&Object.keys(m)?.map(async x=>{if(x){let o=O("manifestByKeys")?.[x];i.push(o)}}),g.linkedBagsInfo=i,g},tt=async t=>{let g=[];t.map(i=>{let m={params:{id:i?.ssg_track_key,idairguide:"all"}},x=X(802002);m={...m,...x},g.push(m)}),ue(g,Pe)},Pe=async t=>{const i=await Z(t);if(i)return i};me(["click"]);export{Ze as default,Pe as fetchCSVInve,tt as loadManifest,et as updLinkedBags};
