const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-fUSyGZur.js","assets/index-CaXA0mR0.js","assets/index-D4QuRvi-.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-Ena0jYS0.js","assets/debounces-C7Wz-qd_.js","assets/SVG-DEfsU4Im.js","assets/index-Ci0zXM0r.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-Ov8gpAjA.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-BCTfHerG.js","assets/Util-D7b_hj3C.js","assets/DialogHRM-DNoXdE5V.js","assets/DialogHRM-V9_lZntj.css","assets/globalSignal-wMqKMl0q.js","assets/manifestList-CT6VCobT.js","assets/fontkit.es-DEjOtITv.js","assets/InitPrintServices--pV7_9n8.js"])))=>i.map(i=>d[i]);
import{l as z,_ as D,c as P,a as _e,u as fe,C as be,o as pe,h as he,m as ve,b as ye,i as o,d as g,f as de,e as xe,t as O,z as ee,S as Y,D as ke,q as we,F as Se,E as $e,s as Ce}from"./index-CaXA0mR0.js";import{w as Oe,p as Ae,m as Le}from"./manifestList-CT6VCobT.js";import{f as E,O as $,e as Me,a as T,g as ge,p as Be,q as F}from"./Util-D7b_hj3C.js";import{u as Pe}from"./debounces-C7Wz-qd_.js";import{i as te}from"./globalSignal-wMqKMl0q.js";import{P as ze,f as De,r as S}from"./fontkit.es-DEjOtITv.js";import{i as Ee,t as v,b as Te}from"./InitPrintServices--pV7_9n8.js";import"./index-Ci0zXM0r.js";const Fe=(a,l,e)=>{const i=l.widthOfTextAtSize(a,40),n=l.widthOfTextAtSize(a,10);return Math.floor(e/((i-n)/30))},Ie=async(a,l,e)=>{const i=await ze.create();i.registerFontkit(De);const n=await Ee(i);let m=265,p=30,f=Math.ceil(a.length/p);Array.from(Array(f).keys()).map(y=>{let G=a.slice(y*p,(y+1)*p);const h=i.addPage(),{height:A}=h.getSize();let I=A-74;G.map((_,q)=>{let c=I;q%2&&h?.drawRectangle({x:10,y:c-15,width:580,height:24,color:S(.7,.7,.7)});let H=Fe(v(_?.state),n.roboto_bold,m),K=0;H>42&&(H=42,c=c-6);let R=_?.bagnumber;const U=n.Lexend_700.widthOfTextAtSize(v(R),5);h.drawText(v(R),{x:575-U,y:c-3,size:5,font:n.Lexend_700,color:S(0,0,0)});let W=_?.consigneeInfo?.ybcity+" | "+_?.consigneeInfo?.ybestate;const J=n.Lexend_700.widthOfTextAtSize(v(W),7);_?.cidentity&&h.drawText(v(_?.cidentity),{x:25,y:c+3,size:7,font:n.Lexend_700,color:S(0,0,0)}),_?.consigneeInfo?.ybestate&&h.drawText(v(W),{x:575-J,y:c+3,size:7,font:n.Lexend_700,color:S(0,0,0)});let t="";_?.hbls.map((s,u)=>{t+=(u>0?"  |  ":"")+s?.hbl}),h.drawText(v(t),{x:45,y:c-3,size:5,font:n.Lexend_700,color:S(0,0,0)}),K+=_?.pricePP*_?.totalWeight,I=c-18}),h.drawText("Guia: "+v(e?.guia),{x:17,y:A-22,size:12,font:n.Lexend_700,color:S(0,0,0)}),h.drawText("Fecha: "+v(e?.date),{x:19,y:A-35,size:10,font:n.Lexend_700,color:S(0,0,0)})});{const y=await i.save();return Te(y)}};var qe=O("<h5>"),Re=O("<div style=padding:4px>"),We=O('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div><div class="icon align_itm"></div></div><div><div class="icon align_itm">'),je=O('<div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5><h4></h4><h4></h4></div></div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Ve=O("<div> <!>."),Qe=O("<div> ");const Ye=z(()=>D(()=>import("./LoadingColorSpinner-fUSyGZur.js"),__vite__mapDeps([0,1,2,3]))),ue=z(()=>D(()=>import("./DropDwnSearch-Ena0jYS0.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),Ne=z(()=>D(()=>import("./InputHr-Ov8gpAjA.js"),__vite__mapDeps([9,1,2,10]))),re=z(()=>D(()=>import("./SVG-DEfsU4Im.js"),__vite__mapDeps([6,1,2,7]))),Ge=z(()=>D(()=>import("./ItemOnManifestList-BCTfHerG.js"),__vite__mapDeps([11,1,2,12,7,5,13,14,15,16,17,18]))),[B,N]=P({list:{}}),[lt,ot]=_e("");function ct(){const[a,l]=fe(),[e,i]=P({search:""}),[n,m]=P(),[p,f]=P(),y=be(),[G,h]=P(),[A,I]=_e(""),_=Pe(I,400),q=(t,s)=>{i({[t]:s}),_(ge())};pe(()=>{N("list",void 0)}),he(()=>{}),ve(async()=>{let t=[];[33,46,40,41,42,50,52,54,56].map(d=>{let x=Oe?.[d];ee?.roles?.[x?.id]?.isActive&&t.push(x)}),h("list",t);let u=[];if(Ae.map(d=>{let b=d.label;ee?.roles?.[b]?.isActive&&u.push(d)}),h("prov",u),a?.mId){let d={id:a?.mId},b=await Je(d);i("province",b?.province),i("city",b?.city),i("manifestObj",b),f("linked",b?.linkedBags)}});const[c,{refetch:H}]=ye(A,async t=>{let s=e?.manifest?.id,u=e?.province,d=u&&e?.city,b=e?.warehouse?.id,x=[];if(s){const w=await He(e.search,s,u,d,b);m("bags",w),$(w).map(j=>{let V=w[j],C=V.currentStatus;ee?.roles?.[C]?.isActive&&C.split("_")?.[1]>=33&&x.push(V)})}return x}),K=(t,s)=>{i({[t]:s}),_(ge()),N("list",void 0),setTimeout(()=>{N("list",{})},670)},R=()=>{let t={},s=0;$(B?.list)?.length!==c()?.length?(s=1,c().map(u=>{let d=u.ssg_track_key;t[d]=s})):c().map(u=>{let d=u.ssg_track_key;t[d]=void 0}),N("list",t)},U=async()=>{let t={...p?.linked};$(B?.list).map(s=>{t?.[s]||(t[s]={idairguide:n?.bags?.[s]?.idairguide})}),f("linked",t),await Ke({ssg_manifest_key:a?.mId},{linkedBags:t}),y("/manifest",{replace:!0})},W=()=>{let t=[];$(B?.list).map(s=>{n?.bags?.[s]&&t.push(n?.bags?.[s])}),J(t)},J=async t=>{let s=await Ie(t,!0,{guia:t[0]?.idairnumber,date:Be()});window.open(s)};return(()=>{var t=je(),s=t.firstChild,u=s.firstChild,d=u.firstChild,b=d.nextSibling,x=b.nextSibling,w=s.nextSibling,j=w.firstChild,V=j.nextSibling,C=w.nextSibling;return o(d,()=>e?.manifestObj?.ssg_manifest_key),o(b,()=>e?.manifestObj?.name),o(u,g(Y,{get when(){return e?.manifestObj?.city},get children(){return["|",(()=>{var r=qe();return o(r,()=>e?.manifestObj?.city),r})()]}}),x),o(x,()=>e?.manifestObj?.province),o(j,g(ue,{list:Le,lbl_empty:"Guia",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>K("manifest",r),width:"260px"})),o(V,g(ue,{get list(){return G?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>q("warehouse",r),width:"260px"})),o(w,g(Y,{get when(){return e?.manifest?.id},get children(){var r=Re();return o(r,g(Ne,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return e?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:k=>q("search",k)})),r}}),null),o(C,g(Y,{get when(){return ke(()=>!!e?.manifest?.id)()&&c().length>0},get children(){var r=We(),k=r.firstChild,Q=k.firstChild,L=k.nextSibling,X=L.firstChild,ie=X.firstChild,se=ie.nextSibling;se.nextSibling;var me=L.nextSibling,Z=me.nextSibling,ae=Z.firstChild,ne=Z.nextSibling,le=ne.firstChild;return r.style.setProperty("margin","18px 0"),Q.$$click=R,o(Q,g(re,{get name(){return $(B?.list)?.length<c()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),o(X,()=>$(B?.list)?.length,ie),o(X,()=>c()?.length,se),ae.$$click=U,o(ae,g(re,{name:"link",color:"var(--background-red-ssg)"})),le.$$click=W,o(le,g(re,{name:"printer",color:"var(--background-red-ssg)"})),de(M=>{var oe=` ${te()?"tr_bar_15":"tr_bar_05"} tr_bar  align_itm centerBx"`,ce=` ${te()?"tr_bar_10":"tr_bar_05"} tr_bar  align_itm centerBx"`;return oe!==M.e&&(Z.className=M.e=oe),ce!==M.t&&(ne.className=M.t=ce),M},{e:void 0,t:void 0}),r}}),null),o(C,g($e,{fallback:r=>(()=>{var k=Ve(),Q=k.firstChild,L=Q.nextSibling;return L.nextSibling,o(k,()=>r.toString(),L),k})(),get children(){return g(we,{get fallback(){return(()=>{var r=Qe();return r.firstChild,o(r,g(Ye,{stroke:"rgb(200 25 60 / 1)",size:62}),null),r})()},get children(){return g(Y,{get when(){return c()},get children(){return g(Se,{get each(){return c()},children:r=>g(Ge,{item:r,get isAlready(){return p?.linked?.[r.ssg_track_key]}})})}})}})}}),null),de(r=>Ce(C,` ${te(),"width:86vw;"} margin: 0 auto;`,r)),t})()}const He=async(a,l,e,i,n)=>{let m={params:{idairguide:l,":store":n}};a&&a.split(" ").map((f,y)=>{f&&(m.params[":search"+y]=f.trim())}),e&&(m.params[":estate"]=e),i&&(m.params[":city"]=i);let p={...T(F())}[802001];if(m={...m,...p},l&&n){const f=await E(m);return console.log(f),f?.error?{}:f}else return{}},Ke=async(a,l)=>{let e={params:a,data2update:l},i={...T(F())}[709002];e={...e,...i};const n=await E(e),m=$(l?.linkedBags).map(async(p,f)=>{await Ue({ssg_track_key:p,idairguide:l?.linkedBags?.[p]?.idairguide},{currentManifestKey:a?.ssg_manifest_key})});return await Promise.all(m),n},Ue=async(a,l)=>{let e={params:a,data2update:l},i={...T(F())}[709002];return e={...e,...i},await E(e)},Je=async a=>{let l={params:a},e={...T(F())}[703003];return l={...l,...e},await E(l)},dt=async a=>{let l=[];a.map(e=>{let i={params:{id:e?.ssg_track_key,idairguide:e?.idairguide}},n={...T(F())}[802002];i={...i,...n},l.push(i)}),Me(l,Xe)},Xe=async a=>{const e=await E(a);if(e)return e};xe(["click"]);export{ct as default,Xe as fetchCSVInve,dt as loadManifest,lt as manifestObs,B as selectedManifest,ot as setManifestObs,N as setSelectedManifest,Ke as updLinkedBags};
