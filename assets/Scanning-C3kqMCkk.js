const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CheckBoxSlide-CwBjGrvo.js","assets/index-C41AzTw0.js","assets/index-BmzAZVve.css","assets/CheckBoxSlide-uVD3DHDO.css","assets/ButonHrm-BwyEjoxs.js","assets/SVG-CnRMbWAr.js","assets/ButonHrm-BSeWNUGQ.css","assets/DropDwnSearch-49dvRWqj.js","assets/debounces-BHS0nOMl.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-bQcd2crD.js","assets/html5-qrcode-scanner-Y_qpaCoc.js","assets/ShowScanAlert-CreLZEOh.js","assets/Toast-BbtwG6WL.js","assets/Toast-DLpFKn-Q.css","assets/ShowQRPrintLabel-CfFOKe1M.js","assets/PDFButton-DwNa45To.js","assets/qrcode-C5vWJp7P.js","assets/fontkit.es--Plr9tMz.js","assets/InitPrintServices-CBVoHSkg.js","assets/DialogHRM-DHLCj8Ah.js","assets/DialogHRM-V9_lZntj.css","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-CqWwXfjC.js","assets/FlexSpace-DUktsJpG.js","assets/LoadingColorSpinner-5N3n4s4-.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{l as _,_ as p,c as j,i as s,d as e,F as le,e as L,g as W,t as b,O as oe,a as I,k as ve,r as ye,s as xe,M as z,N as Se,S as w,P as U,H as $e,Q as ke,R as X,T as Ce,o as Y,f as Z,h as we,U as Pe,V as J,W as G,X as Ie,j as ee,Y as te,Z as Be,p as ce,q as de}from"./index-C41AzTw0.js";import{s as Ee}from"./App.module-CbHnVtRQ.js";import{OpenToast as Le}from"./Toast-BbtwG6WL.js";import{CloseModal as ne,OpenModal as Oe}from"./DialogHRM-DHLCj8Ah.js";var Ae=b('<div><div><div class="_dsplFlx flxWrp spaceAround "><div class="_dsplFlx bottombx lowbordr"><h5>Descargar Guias </h5></div></div><div class="centerBx bottombx spaceAround"style=margin-top:20px>|'),De=b('<div class="centerBx bottombx "><h5 class="">');const Me=_(()=>p(()=>import("./CheckBoxSlide-CwBjGrvo.js"),__vite__mapDeps([0,1,2,3]))),se=_(()=>p(()=>import("./ButonHrm-BwyEjoxs.js"),__vite__mapDeps([4,1,2,5,6])));function Te(u){const[f,l]=j({}),h=()=>{ne(u?.modalId)},$=()=>{ne(u?.modalId),u?.confirm(oe(f))};let C=[42,43,44,45];return(()=>{var o=Ae(),O=o.firstChild,A=O.firstChild,m=A.nextSibling,D=m.firstChild;return o.style.setProperty("max-height","80vh"),o.style.setProperty("overflow","auto"),o.style.setProperty("background","#ffffff"),o.style.setProperty("border-radius","13"),o.style.setProperty("padding","50px 25px"),s(O,e(le,{each:C,children:(c,V)=>(()=>{var B=De(),M=B.firstChild;return s(B,e(Me,{get initValue(){return f?.[c]},updChange:()=>l(c,!f?.[c]),color:"var(--background-red-ssg)"}),M),s(M,c),B})()}),m),s(m,e(se,{icon:"cancel",color:"#7d7d7d",label:"Cancelar",handleClick:h}),D),s(m,e(se,{icon:"success",color:"#c8193c",label:"Confirmar",handleClick:$}),null),L(c=>(c=W()?"86vw":"420px")!=null?o.style.setProperty("width",c):o.style.removeProperty("width")),o})()}var Fe=b('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Re=b('<div class="centerBx100 ">'),Ve=b('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Ne=b('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2><div class="centerBx bottombx "><h5 class="">Fuera de Linea</h5></div></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),ze=b('<div class="centerBx bottombx "><h5> descargando guias... '),Ge=b('<div class="centerBx bottombx "><h5> subiendo al servidor <!> / <!> '),Qe=b("<div class=loader>Loading..."),We=b('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[st,rt]=j(),je=_(()=>p(()=>import("./DropDwnSearch-49dvRWqj.js"),__vite__mapDeps([7,1,2,8,5,9]))),He=_(()=>p(()=>import("./ScanningCamera-bQcd2crD.js"),__vite__mapDeps([10,1,2,11,8,12,13,14,15,16,17,18,19,20,21,22,23]))),qe=_(()=>p(()=>import("./ScanningManual-CqWwXfjC.js"),__vite__mapDeps([24,1,2,12,13,14,15,16,17,18,19,20,21,22,23]))),Q=_(()=>p(()=>import("./SVG-CnRMbWAr.js"),__vite__mapDeps([5,1,2]))),Ke=_(()=>p(()=>import("./FlexSpace-DUktsJpG.js"),__vite__mapDeps([25,1,2]))),re=_(()=>p(()=>import("./LoadingColorSpinner-5N3n4s4-.js"),__vite__mapDeps([26,1,2,27]))),Ue=_(()=>p(()=>import("./CheckBoxSlide-CwBjGrvo.js"),__vite__mapDeps([0,1,2,3]))),ae=_(()=>p(()=>import("./ButonHrm-BwyEjoxs.js"),__vite__mapDeps([4,1,2,5,6]))),[P,Xe]=I(""),[ie,at]=I([]);function it(){j({});const[u,f]=I(0),[l,h]=I(1),[$,C]=Pe(),o=t=>()=>C(()=>h(t)),[O,A]=I(!1),[m,D]=I(0);ve(()=>{_e()}),ye(()=>{}),xe(()=>{W()&&h(0),T(c),H(V)});const c=t=>{f(t?.length)},V=t=>{let n={},r={};t.map(i=>{i?.doc?.hbls?.map(d=>{r[d?.hbl]||(r[d?.hbl]=i?.doc?.ssg_track_key)}),n[i?.doc?.ssg_track_key]||(n[i?.doc?.ssg_track_key]=i?.doc,n[i?.doc?.ssg_track_key].key=i?.key)}),te("manifestByKeys",n),te("manifestByHbls",r)},B=async t=>{A(!0);let n={};const r=t.map(async i=>{let d=await Ye("guia",i);n=Object.assign({},n,d)});await Promise.all(r),oe(n).map(i=>{let d={...n[i]};d.id=d.ssg_track_key,Y("manifestByKeys")[d?.ssg_track_key]||M(n[i])}),H(V),T(c),Le({text:"El modo offline esta listo para escanear",timeout:2500,id:ee()}),A(!1)},M=async t=>{J.post(t,function(r,i){r||console.log("Successfully posted")})},H=async t=>{J.allDocs({include_docs:!0,descending:!0},function(n,r){t(r.rows)})},T=async t=>{G.allDocs({include_docs:!0,descending:!0},function(n,r){t(r.rows)})};function ue(){return"geolocation"in navigator}function ge(t){Be({latitude:t?.coords?.latitude,longitude:t?.coords?.longitude})}function _e(){ue()?navigator.geolocation.getCurrentPosition(ge):showMessage("Geolocation isn't supported by your browser")}const pe=()=>Ie?.list?.filter(t=>t.id),be=async t=>{D(u());const n=t.map(async r=>{await Ze({ssg_track_key:r?.doc?.ssg_track_key,idairguide:"all"},r?.doc?.data2update),G.remove(r?.doc,function(d,N){d||(console.log("dbScanned successfully removed "),T(c))})});await Promise.all(n),T(c),D(0)},fe=async t=>{G.allDocs({include_docs:!0,descending:!0},function(n,r){be(r.rows)})},he=t=>{let n={},r=ee();n.id=r,n.props={minHeight:"1vh",overlay:!0,height:"93vh",zIndex:450},n.content=e(Te,{confirm:B,modalId:r}),Oe(n)};return(()=>{var t=Ne(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,d=i.firstChild,N=n.nextSibling,q=N.nextSibling,K=q.nextSibling;return s(i,e(Ue,{get initValue(){return z()},updChange:()=>Se(!z()),color:"var(--background-red-ssg)"}),d),s(n,e(w,{get when(){return z()},get children(){return e(w,{get when(){return!O()},get fallback(){return(()=>{var a=ze();return s(a,e(re,{stroke:"rgb(200 25 60 / 1)",size:32}),null),a})()},get children(){return e(ae,{color:"rgb(200 25 60 / 1)",label:"preparar datos fuera de linea",handleClick:he})}})}}),null),s(n,e(w,{get when(){return u()>0},get children(){return e(w,{get when(){return!m()},get fallback(){return(()=>{var a=Ge(),g=a.firstChild,v=g.firstChild,k=v.nextSibling,y=k.nextSibling,x=y.nextSibling;return x.nextSibling,s(a,e(re,{stroke:"rgb(200 25 60 / 1)",size:32}),g),s(g,()=>m()-u(),k),s(g,m,x),a})()},get children(){return e(ae,{color:"rgb(200 25 60 / 1)",label:"Subir pendientes",handleClick:fe})}})}}),null),s(q,e(je,{get list(){return pe()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return P()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:a=>Xe(a.id),width:"260px"})),s(K,e(w,{get when(){return P()},get children(){return[(()=>{var a=Fe(),g=a.firstChild,v=g.firstChild,k=v.firstChild,y=g.nextSibling,x=y.firstChild,F=x.firstChild;return U(g,"click",o(0),!0),s(k,e(Q,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),U(y,"click",o(1),!0),s(F,e(Q,{name:"keyboard",size:32,color:"#2b2b2b"})),L(S=>{var E=l()===0,R=l()===1;return E!==S.e&&g.classList.toggle("selected",S.e=E),R!==S.t&&y.classList.toggle("selected",S.t=R),S},{e:void 0,t:void 0}),a})(),(()=>{var a=Re();return s(a,e($e,{get fallback(){return Qe()},get children(){return e(ke,{get children(){return[e(X,{get when(){return l()===0},get children(){return e(He,{get status(){return P()},get locat(){return P()}})}}),e(X,{get when(){return l()===1},get children(){return e(qe,{get status(){return P()},get locat(){return P()}})}})]}})}})),L(()=>a.classList.toggle("pending",!!$())),a})()]}}),null),s(K,e(w,{get when(){return ie()?.length>0},get children(){return[Ve(),e(le,{get each(){return Ce(ie(),"timeStamp",0)},children:(a,g)=>(()=>{var v=We(),k=v.firstChild,y=k.firstChild,x=y.nextSibling,F=x.nextSibling,S=k.nextSibling,E=S.firstChild,R=E.nextSibling,me=R.nextSibling;return s(y,e(Q,{get name(){return Y("M023009")?.statusListIcons?.[a?.currentStatus]},size:32})),x.style.setProperty("padding","8px"),s(x,()=>a?.idairguide),F.style.setProperty("padding","8px"),s(F,()=>a?.tracking),s(v,e(Ke,{}),S),s(E,()=>a?.city),s(me,()=>a?.consigneeInfo?.ybestate),L(()=>Z(v,`client_item_box gWXAaj jlytmu manifest  ${W()?"isMobile":"centerBx"}`)),v})()})]}}),null),L(()=>Z(t,Ee.App)),t})()}const Ye=async(u,f)=>{let l={params:{idairguide:"all"},fldswQry:["street","agency","idairguide","currentStatus","cidentity","ssg_track_key","bagnumber","tracking","estate","city","zone","guia","consigneeInfo:phoneNumber","consigneeInfo:altPhoneNumber","consigneeInfo:firstName","consigneeInfo:middleName","consigneeInfo:lastName","consigneeInfo:lastName2","consigneeInfo:ybstreet","consigneeInfo:ybstreetNo","consigneeInfo:ybbetwen1","consigneeInfo:ybbetwen2","consigneeInfo:ybreparto","consigneeInfo:ybestate","consigneeInfo:ybcity","deliveryUserId","deliveryTime","isSSG","isLMH","isPaid","hbls","noteTag","nameshipper","billedBy"]};u.split(" ").map((C,o)=>{C&&(l.params[":search"+o]=C.trim())}),l.params[":guia"]=f+"";let h=ce(802001);l={...l,...h};const $=await de(l);return $?.data?.error?{}:$},Ze=async(u,f)=>{let l={params:u,data2update:f},h=ce(809004);return l={...l,...h},await de(l)};we(["click"]);export{it as default,st as scannedQRs,rt as setScannedQRs,Xe as setStatus,at as setTaskScan,P as status,ie as taskScan};
