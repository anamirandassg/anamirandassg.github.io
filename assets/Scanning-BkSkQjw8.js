const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-HbM4daMy.js","assets/index-ulQ-TQRi.js","assets/index-lCkr9jrN.css","assets/FlexSpace-DowtU6xW.js","assets/DropDwnSearch-COtwgE1z.js","assets/debounces-CvBw6x0E.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-K9WcS1Ab.js","assets/html5-qrcode-scanner-C2fgrOQl.js","assets/Toast-BqY88JNg.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-DJIphnDI.js","assets/DialogHRM-DZp4S579.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-DYhV30Hp.js","assets/ShowQRPrintLabel-BYQ9prbT.js","assets/PDFButton-Dz6VzGAS.js","assets/qrcode-DHy8FFhS.js","assets/fontkit.es-CsdXM_oZ.js","assets/InitPrintServices-Bo3sBUqm.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-BHbSSs8-.js","assets/LoadingColorSpinner-B3berfe5.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{Q as b,N as ne,am as W,an as F,n as A,M as re,o as S,O as ie,K as j,ad as H,p as E,q as z,ao as K,ap as le,ac as oe,c as N,l as f,_ as p,a as M,k as ce,r as de,s as ue,i as l,d as i,ah as R,e as L,H as ge,aq as be,ar as G,S as q,F as fe,ab as pe,f as Q,g as V,h as _e,t as _,as as ye,at as he,ae as ve}from"./index-ulQ-TQRi.js";import{s as me}from"./App.module-CbHnVtRQ.js";import"./Toast-BqY88JNg.js";let Se=[400,300,400,300,400],T=[300,80,300,80,300,80,300];const ke=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let t=e.split("/")?.[0];return t.indexOf("230")>=0&&(t="230"+(t.split("230")?.[1]).slice(0,6)),t.indexOf("231")>=0&&(t="231"+(t.split("231")?.[1]).slice(0,5)),{params:{":search0":t},code:1}},Te=async(e,a)=>{let t=ke(e),s={timeStamp:new Date().getTime(),latitude:F?.latitude,longitude:F?.longitude,statusId:a,userId:A?.profile?.userId,userName:A?.profile?.name};if(a&&t?.params)return await we(t.params,s);{let n=t?.txt||t?.params?.[":search0"];return navigator.vibrate(T),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},we=async(e,a)=>{let t=null;if(re()){let s=S("manifestByHbls")?.[e?.[":search0"]],n=S("manifestByKeys")?.[s];t=xe(n,a)}else{let s=await Le(e),n=ie(s)?.[0];s?.[n]?.guia&&(t=(await Ie({":search0":n,idairguide:s?.[n]?.guia},a))?.data)}if(t?.code===203||t?.code===303)return navigator.vibrate(Se),{error:{alert:"warning",color:"#FF6F1D",scanData:t.data}};if(t?.code===200){navigator.vibrate(500);let s={...t.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),ee([...$(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:t.data}}}else if(!t||t?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(T),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},xe=(e,a)=>{let t=e?.statusHistory||[];t.push(a);let s={statusHistory:t,currentStatus:a?.statusId};if(e?.isSSG&&j?.roles?.SSG?.isActive,!j?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};if(S("alredyScan")?.[a.statusId]?.[e?.ssg_track_key])return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};if(e?.currentStatus===a.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let n={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},y={data2update:s,itmN:n,ssg_track_key:e?.ssg_track_key,params:{ssg_track_key:e?.ssg_track_key,idairguide:e?.guia},actionKey:809004};return H.post(y,function(C,O){C||console.log("successfully posted on queue")}),$e(e?.ssg_track_key,a.statusId),{code:200,data:{...n,...s}}},Ie=async(e,a)=>{let t={params:e,form:a},s=E(802001);s=E(802008),t={...t,...s};const n=await z(t);return console.log(t),console.log(n),n},Le=async(e,a)=>{let t={params:e},s=E(265002);return t={...t,...s},await z(t)},X=async e=>{H.allDocs({include_docs:!0,descending:!0},function(a,t){e(t.rows)})},Z=e=>{let a={};e?.map(t=>{let s=t?.doc?.ssg_track_key,n=t?.doc?.data2update?.currentStatus;a[n]||(a[n]={}),a[n][s]||(a[n][s]=1)}),b("alredyScan",a),K(e?.length)},$e=(e,a)=>{let t=S("alredyScan")||{};t[a]||(t[a]={}),t[a][e]||(t[a][e]=1),b("alredyScan",t),K(le()+1)},J=async()=>{let e=await Ce(),a={},t={};return e.map(s=>{s?.doc?.hbls?.map(n=>{t[n?.hbl]||(t[n?.hbl]=s?.doc?.ssg_track_key)}),a[s?.doc?.ssg_track_key]||(a[s?.doc?.ssg_track_key]=s?.doc,a[s?.doc?.ssg_track_key].key=s?.key)}),b("manifestByKeys",a),b("manifestByHbls",t),a},Ce=()=>new Promise((e,a)=>{W.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Be=async()=>{let e=await Ee(),a={};e?.map(t=>{let s=t?.doc?.params?.ssg_manifest_key;a[s]||(a[s]=t?.doc)}),b("alinkM",a)},Ee=()=>new Promise((e,a)=>{oe.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Me=async()=>{let e=await U(),a={};return e?.map(t=>{let s=t?.doc?.ssg_manifest_key;a[s]=t?.doc}),b("manifestList",a),a},U=()=>new Promise((e,a)=>{ne.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Xe=async()=>((await U())?.map(a=>{W.remove(a?.doc,function(s,n){})}),1),Ze=async()=>{await Me(),await Be(),X(Z),J()};var Oe=_('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),De=_('<div class="centerBx100 ">'),Pe=_('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Fe=_('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Ae=_("<div class=loader>Loading..."),je=_('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Re,Ge]=N(),B=f(()=>p(()=>import("./SVG-HbM4daMy.js"),__vite__mapDeps([0,1,2]))),qe=f(()=>p(()=>import("./FlexSpace-DowtU6xW.js"),__vite__mapDeps([3,1,2]))),Qe=f(()=>p(()=>import("./DropDwnSearch-COtwgE1z.js"),__vite__mapDeps([4,1,2,5,0,6]))),Ve=f(()=>p(()=>import("./ScanningCamera-K9WcS1Ab.js"),__vite__mapDeps([7,1,2,8,5,9,10,11,12,13,14,15,16,17,18,19,20,21]))),We=f(()=>p(()=>import("./ScanningManual-BHbSSs8-.js"),__vite__mapDeps([22,1,2,12,13,20,21,9,10])));f(()=>p(()=>import("./LoadingColorSpinner-B3berfe5.js"),__vite__mapDeps([23,1,2,24])));const[d,Y]=M(""),[$,ee]=M([]);function He(){N({});const[e,a]=M(1),[t,s]=ye(),n=o=>()=>s(()=>a(o));ce(()=>{C()}),de(()=>{}),ue(()=>{V()&&a(0),X(Z),J()});function y(){return"geolocation"in navigator}function k(o){ve({latitude:o?.coords?.latitude,longitude:o?.coords?.longitude})}function C(){y()?navigator.geolocation.getCurrentPosition(k):showMessage("Geolocation isn't supported by your browser")}const O=()=>he?.list?.filter(o=>o.id);return(()=>{var o=Fe(),te=o.firstChild,ae=te.nextSibling,D=ae.nextSibling,P=D.nextSibling;return l(D,i(Qe,{get list(){return O()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return d()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:r=>Y(r.id),width:"260px"})),l(P,i(q,{get when(){return d()},get children(){return[(()=>{var r=Oe(),h=r.firstChild,u=h.firstChild,w=u.firstChild,g=h.nextSibling,v=g.firstChild,x=v.firstChild;return R(h,"click",n(0),!0),l(w,i(B,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),R(g,"click",n(1),!0),l(x,i(B,{name:"keyboard",size:32,color:"#2b2b2b"})),L(c=>{var m=e()===0,I=e()===1;return m!==c.e&&h.classList.toggle("selected",c.e=m),I!==c.t&&g.classList.toggle("selected",c.t=I),c},{e:void 0,t:void 0}),r})(),(()=>{var r=De();return l(r,i(ge,{get fallback(){return Ae()},get children(){return i(be,{get children(){return[i(G,{get when(){return e()===0},get children(){return i(Ve,{get status(){return d()},get locat(){return d()}})}}),i(G,{get when(){return e()===1},get children(){return i(We,{get status(){return d()},get locat(){return d()}})}})]}})}})),L(()=>r.classList.toggle("pending",!!t())),r})()]}}),null),l(P,i(q,{get when(){return $()?.length>0},get children(){return[Pe(),i(fe,{get each(){return pe($(),"timeStamp",0)},children:(r,h)=>(()=>{var u=je(),w=u.firstChild,g=w.firstChild,v=g.nextSibling,x=v.nextSibling,c=w.nextSibling,m=c.firstChild,I=m.nextSibling,se=I.nextSibling;return l(g,i(B,{get name(){return S("M023009")?.statusListIcons?.[r?.currentStatus]},size:32})),v.style.setProperty("padding","8px"),l(v,()=>r?.idairguide),x.style.setProperty("padding","8px"),l(x,()=>r?.tracking),l(u,i(qe,{}),c),l(m,()=>r?.city),l(se,()=>r?.consigneeInfo?.ybestate),L(()=>Q(u,`client_item_box gWXAaj jlytmu manifest  ${V()?"isMobile":"centerBx"}`)),u})()})]}}),null),L(()=>Q(o,me.App)),o})()}_e(["click"]);const Je=Object.freeze(Object.defineProperty({__proto__:null,default:He,scannedQRs:Re,setScannedQRs:Ge,setStatus:Y,setTaskScan:ee,status:d,taskScan:$},Symbol.toStringTag,{value:"Module"}));export{Je as S,Te as a,X as b,Xe as c,Z as d,Me as h,J as i,Ze as l};
