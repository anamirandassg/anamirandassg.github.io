const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FlexSpace-CIM_Wn2D.js","assets/index-C-1XLrnY.js","assets/index-CJxZRJNk.css","assets/SVG-b2O7CS5i.js","assets/Util-Df9CfxGL.js","assets/LoadingColorSpinner-C1IaWTFV.js","assets/LoadingColorSpinner-DPNLfwBi.css","assets/InputHr-BKkUQoj4.js","assets/InputHr-M3rJ9grQ.css","assets/ButonHrm-CfHlo3jl.js","assets/ButonHrm-BSeWNUGQ.css"])))=>i.map(i=>d[i]);
import{l as j,_ as U,c as T,a as q,o as mt,k as ft,b as N,i as u,d as b,F as L,S as F,j as _t,e as B,s as Y,g as ht,n as W,h as $t,t as k}from"./index-C-1XLrnY.js";import{O as S,c as H,f as Z,j as bt,i as gt,E,b as tt}from"./Util-Df9CfxGL.js";import{g as et,a as st}from"./handelImagesServices-BQGF6iy1.js";import{OpenToast as rt}from"./Toast-DjPnEMIN.js";import{validStores as yt}from"./AddInventory-aHiYFWdy.js";import"./browser-image-compression-BVJ4p9S0.js";import"./DialogHRM-BKOGqijo.js";import"./debounces-PmbqfJwO.js";import"./DashProducts-BbqViLFN.js";import"./App.module-CbHnVtRQ.js";import"./FlexSpace-CIM_Wn2D.js";var Ct=k('<div style="padding:50px 0 0 0"><section class=qsuVSc><section class=bLl6je><section class="dvPdhb ">'),vt=k('<section class="h6rxkc ">'),kt=k('<section class="rtS8wf InvE"><div class=X3QHFf><section class=WirBi><section class=""><section class="EMijzc centerBx"><div class="icon_status centerBx "style="margin:0 4px"></div><div class="icon_status centerBx "style="margin:0 4px"></div></section><section class="EMijzc centerBx"><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true class=h5M7vb>Almacen: <select class=RIw0b aria-label="Product Quantity"></select></span></section><p class=GehUpe data-test-line-item-price=""> </p><section class=dEfaq><section class=JpKBkb><button class=yjHiqb><span>Imprimir Inventario</span></button></section><section class=JpKBkb><button class=yjHiqb><span>Comparar Inventario'),xt=k("<option>"),It=k('<section class="kGEQJf "><section class="Z722Ge InvE"><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty: <span class=h5M7vb></span></span></section><section class=dEfaq><section class=JpKBkb><button class=yjHiqb><span>Remover'),wt=k('<div class="icon_status centerBx "style="margin:0 4px">'),St=k('<span class=" centerBx"><span class=fnT8></span><span><div class="icon_status centerBx "style="margin:0 4px">'),qt=k('<div class="GehUpe centerBx"data-test-line-item-price="">'),Et=k("<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe>");j(()=>U(()=>import("./FlexSpace-CIM_Wn2D.js"),__vite__mapDeps([0,1,2])));const J=j(()=>U(()=>import("./SVG-b2O7CS5i.js"),__vite__mapDeps([3,1,2,4])));j(()=>U(()=>import("./LoadingColorSpinner-C1IaWTFV.js"),__vite__mapDeps([5,1,2,6])));const it=j(()=>U(()=>import("./InputHr-BKkUQoj4.js"),__vite__mapDeps([7,1,2,8])));j(()=>U(()=>import("./ButonHrm-CfHlo3jl.js"),__vite__mapDeps([9,1,2,3,4,10])));const[Q,D]=T({items:{}}),I="348723orh2idsffs";function zt(){q(0);const[t,i]=q("");mt(()=>{}),ft(()=>{}),N(()=>{e()});const e=async()=>{(await jt())?.map(c=>{D("items",c.doc)})};return(()=>{var s=Ct(),c=s.firstChild,a=c.firstChild,n=a.firstChild;return u(n,b(F,{get when(){return S(Q?.items?.products)},get children(){return b(L,{get each(){return S(Q?.items?.products)},children:(h,f)=>b(Ot,{get itm(){return Q?.items?.products?.[h]}})})}})),u(c,b(Pt,{updSearch:i}),null),s})()}const Pt=t=>{const[i,e]=q(""),[s,c]=q(1),[a,n]=q(""),h=()=>{s()===1&&i().length>8&&f(i())},f=async p=>{let _=`${p}`,$=await M(_),r=S($)?.[0],l=1,m=await O(I)||{};m?.products?.[r]&&(l=m?.products?.[r].qty*1+1);let o=m;if(m?.products||(o.products={},o._id=I),m?.products?.[r])o.products[r].qty=l;else{let d={product:{id:r,label:$?.[r]?.name,code:$?.[r]?.code},qty:l};o.products[r]=d}E.put(o,function(V,A){}),D("items",o),e(""),rt({text:$?.[r]?.name+" agregado al inventario",timeout:3500,theme:"blue",id:tt()})},[y,{refetch:C}]=_t(i,async p=>{if(s()===2&&p.length>4){const _=await M(p);let $=[];return S(_).map(r=>{let l=_[r];$.push(l)}),$}else return[]}),g=()=>{e(""),c(1)},v=async()=>{let p=`${a()}`,_=await X(p,p);console.log(_);let r=(await O(I)||{})?.products;S(_)?.map(m=>{_[m]?.products?.map(o=>{let d=o?.product?.id;r[d]&&(r[d].stock||(r[d].stock=0),r[d].stock+=o?.qty*1)})});let l=await O(I)||{};l.products=r,D("items",l)},w=async()=>{let p=`${a()}`,_=await X(p,p),r=(await O(I)||{})?.products,l={};S(r)?.map(m=>{l[m]=r[m]}),S(_)?.map(m=>{_[m]?.products?.map(o=>{let d=o?.product?.id;l[d]?(l[d].stock||(l[d].stock=0),l[d].stock+=o?.qty*1):(l[d]||(l[d]={product:o?.product,stock:o?.qty*1}),l[d].stock+=o?.qty*1)})}),console.log(l)};return(()=>{var p=kt(),_=p.firstChild,$=_.firstChild,r=$.firstChild,l=r.firstChild,m=l.firstChild,o=m.nextSibling,d=l.nextSibling,V=d.firstChild,A=V.firstChild,ct=A.nextSibling,R=ct.firstChild,lt=R.firstChild,nt=lt.firstChild,z=nt.nextSibling,at=R.nextSibling,ot=at.nextSibling,G=ot.firstChild,dt=G.firstChild,ut=G.nextSibling,pt=ut.firstChild;return u(r,b(F,{get when(){return y()?.length>0},get children(){var x=vt();return u(x,b(L,{get each(){return y()},children:(K,P)=>b(Ut,{itm:K,clearTx:g})})),x}}),l),u(l,b(it,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return i()},placeholder:"buscar productos ...",colors:"#2b2b2b",handleClick:e,onEnter:h}),m),m.$$click=()=>c(1),u(m,b(J,{name:"qrcode-scan",size:22,get color(){return s()===1?"#646cff":""}})),o.$$click=()=>c(2),u(o,b(J,{name:"keyboard",size:22,get color(){return s()===2?"#646cff":""}})),z.addEventListener("change",x=>{n(x?.target?.value)}),u(z,b(L,{get each(){return yt()},children:(x,K)=>(()=>{var P=xt();return u(P,()=>x?.label),B(()=>P.selected=a()===x?.id),B(()=>P.value=x?.id),P})()})),dt.$$click=w,pt.$$click=v,p})()},Ot=t=>{const[i,e]=T(),s=()=>i?.[t?.itm?.product?.id]?.productImageUrl?et()+st()+"/"+i?.[t?.itm?.product?.id]?.productImageUrl:null,c=async()=>{let n=t?.itm?.product?.id,h=`${n}`,f=await M(h);f?.[n]?.productImageUrl&&e(n,f?.[n])};N(()=>{c()});const a=()=>{E.get(I,function(h,f){let y={...f};delete y.products[t?.itm?.product?.id],E.put(y,function(g,v){g||D("items","products",t?.itm?.product?.id,void 0)})})};return(()=>{var n=It(),h=n.firstChild,f=h.firstChild,y=f.firstChild,C=y.firstChild,g=C.firstChild,v=C.nextSibling,w=v.firstChild,p=w.firstChild,_=p.firstChild;_.firstChild;var $=w.nextSibling,r=$.firstChild,l=r.firstChild,m=l.firstChild,o=m.nextSibling,d=r.nextSibling,V=d.firstChild,A=V.firstChild;return u(_,()=>t?.itm?.product?.label,null),u(o,()=>t?.itm?.qty),u($,b(Bt,{get itm(){return t?.itm}}),d),A.$$click=a,B(()=>Y(g,"src",s())),n})()},Bt=t=>{const i=()=>t?.itm?.stock&&t?.itm?.stock-t?.itm?.qty>1?null:1,e=()=>t?.itm?.stock&&t?.itm?.stock===t?.itm?.qty?1:0;return(()=>{var s=qt();return u(s,b(F,{get when(){return e()},get children(){var c=wt();return u(c,b(J,{name:"check_circle_outline",size:26,color:"#137333ff"})),c}}),null),u(s,b(F,{get when(){return!e()},get children(){var c=St(),a=c.firstChild,n=a.nextSibling,h=n.firstChild;return u(a,()=>(t?.itm?.stock?t?.itm?.stock:0)?.toFixed(2)),u(h,b(J,{get name(){return i()?"plus":"minus"},size:18,get color(){return i()?"#137333ff":"#c8193c"}})),u(n,()=>(t?.itm?.stock?t?.itm?.stock-t?.itm?.qty:t?.itm?.qty)?.toFixed(2),null),B(()=>ht(n,`${i()?"mnwi":"koi3M"} fnT8 centerBx`)),c}}),null),s})()},M=async(t,i)=>{let e={params:{businessId:W?.profile?.businessYId}};t&&t.split(" ").map((a,n)=>{a&&(e.params[":search"+n]=a.trim())});let s=H(122001);e={...e,...s},e.params[":search0"];const c=await Z(e);return c?.error?{}:c},Gt=async t=>{let i=[];t.map(e=>{let s={params:{id:e?.ssg_track_key,idairguide:"all"}},c=H(802002);s={...s,...c},i.push(s)}),bt(i,Dt)},Dt=async t=>{const e=await gt(t);if(e)return e},jt=()=>new Promise((t,i)=>{E.allDocs({include_docs:!0,descending:!0},function(e,s){t(s.rows)})}),Ut=t=>{const[i,e]=T(),[s,c]=q(""),a=()=>i?.prod?.productImageUrl?et()+st()+"/"+i?.prod?.productImageUrl:null;N(()=>{e("prod",t?.itm)}),Array.from(Array(10).keys());const n=async()=>{let h=s()*1,f=i?.prod?.ssg_product_key,y=h,C=await O(I)||{};C?.products?.[f]&&(y=C?.products?.[f].qty+h);let g=C;if(C?.products||(g.products={},g._id=I),C?.products?.[f])g.products[f].qty=y;else{let v={product:{id:f,label:t?.itm?.name,code:t?.itm?.code},qty:y};g.products[f]=v}E.put(g,function(w,p){}),D("items",g),t?.clearTx(),rt({text:" El inventario fue actualizado",timeout:3500,theme:"blue",id:tt()})};return(()=>{var h=Et(),f=h.firstChild,y=f.firstChild,C=y.firstChild,g=C.firstChild,v=g.firstChild,w=g.nextSibling,p=w.firstChild,_=p.firstChild,$=_.firstChild;$.firstChild;var r=p.nextSibling;return u($,()=>t?.itm?.name,null),u(r,b(it,{width:"90px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",type:"number",get value(){return s()},placeholder:"Cantidad",colors:"#2b2b2b",handleClick:c,onEnter:n})),B(()=>Y(v,"src",a())),h})()},O=t=>new Promise((i,e)=>{E.get(t,function(c,a){i(a)})}),X=async(t,i)=>{let e={params:{businessId:W?.profile?.businessYId,":store":i.trim()}};t&&t.split(" ").map((a,n)=>{a&&(e.params[":search"+n]=a.trim())});let s=H(132001);e={...e,...s},e.params[":search0"];const c=await Z(e);return console.log(e),c?.error?{}:c};$t(["click"]);export{X as LookupInventory,M as LookupProducts,zt as default,Dt as fetchCSVInve,O as getCartId,Q as inventoryItems,I as inventoryKey,jt as loadCarts,Gt as loadProduct,D as setInventoryItems};
