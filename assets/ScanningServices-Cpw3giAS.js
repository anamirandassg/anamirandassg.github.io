const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-DMiGpZWQ.js","assets/index-Ce3BY-tN.js","assets/index-D_ebk4lx.css","assets/Util-DtU7H3gG.js","assets/FlexSpace-DSC2sduv.js","assets/DropDwnSearch-BnNzkfgQ.js","assets/debounces-CiNSHqsb.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-CVnMjrfL.js","assets/html5-qrcode-scanner-BOjvwlZz.js","assets/Toast-D_5srogq.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-DJAbYKAZ.js","assets/DialogHRM-DuW6oSzj.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-C6ZoVLhk.js","assets/ShowQRPrintLabel-DuGX-S23.js","assets/fontkit.es-B14bDeoZ.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-DIbjXe9Q.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-BNd8khGy.js","assets/LoadingColorSpinner-ChdfNGy8.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{c as T,l as S,_ as m,a as O,b as ce,o as de,d as ge,i as c,e as o,Q as z,f as C,z as ue,U as be,V as Q,S as N,F as fe,m as H,j as q,h as pe,t as h,W as _e,X as ye,O as Se,Y as me,Z as X,g as P,J as he,A as U}from"./index-Ce3BY-tN.js";import"./Toast-D_5srogq.js";import{E as ve,e as b,S as G,T as J,U as ee,O as B,u,V as Le,W as Ie,X as te,Y as ae,g as Y,f as ke,F as ne,a as xe,K as we}from"./Util-DtU7H3gG.js";import{s as De}from"./App.module-CbHnVtRQ.js";var Ce=h('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Be=h('<div class="centerBx100 ">'),$e=h('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Ee=h('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Oe=h("<div class=loader>Loading..."),Fe=h('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Ae,Pe]=T(),j=S(()=>m(()=>import("./SVG-DMiGpZWQ.js"),__vite__mapDeps([0,1,2,3]))),je=S(()=>m(()=>import("./FlexSpace-DSC2sduv.js"),__vite__mapDeps([4,1,2]))),Ke=S(()=>m(()=>import("./DropDwnSearch-BnNzkfgQ.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),Me=S(()=>m(()=>import("./ScanningCamera-CVnMjrfL.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),Re=S(()=>m(()=>import("./ScanningManual-BNd8khGy.js"),__vite__mapDeps([22,1,2,3,13,14,10,11,20,21])));S(()=>m(()=>import("./LoadingColorSpinner-ChdfNGy8.js"),__vite__mapDeps([23,1,2,24])));const[p,se]=O(""),[$,re]=O([]);function Te(){T({});const[e,t]=O(1),[a,n]=_e(),s=l=>()=>n(()=>t(l));ce(()=>{g()}),de(()=>{}),ge(()=>{q()&&t(0),Je(),ie(),at()});function d(){return"geolocation"in navigator}function r(l){Se({latitude:l?.coords?.latitude,longitude:l?.coords?.longitude})}function g(){d()?navigator.geolocation.getCurrentPosition(r):showMessage("Geolocation isn't supported by your browser")}const F=()=>ye?.list?.filter(l=>l.id);return(()=>{var l=Ee(),k=l.firstChild,A=k.nextSibling,V=A.nextSibling,W=V.nextSibling;return c(V,o(Ke,{get list(){return F()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return p()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:i=>se(i.id),width:"260px"})),c(W,o(N,{get when(){return p()},get children(){return[(()=>{var i=Ce(),v=i.firstChild,_=v.firstChild,x=_.firstChild,y=v.nextSibling,L=y.firstChild,w=L.firstChild;return z(v,"click",s(0),!0),c(x,o(j,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),z(y,"click",s(1),!0),c(w,o(j,{name:"keyboard",size:32,color:"#2b2b2b"})),C(f=>{var I=e()===0,D=e()===1;return I!==f.e&&v.classList.toggle("selected",f.e=I),D!==f.t&&y.classList.toggle("selected",f.t=D),f},{e:void 0,t:void 0}),i})(),(()=>{var i=Be();return c(i,o(ue,{get fallback(){return Oe()},get children(){return o(be,{get children(){return[o(Q,{get when(){return e()===0},get children(){return o(Me,{get status(){return p()},get locat(){return p()}})}}),o(Q,{get when(){return e()===1},get children(){return o(Re,{get status(){return p()},get locat(){return p()}})}})]}})}})),C(()=>i.classList.toggle("pending",!!a())),i})()]}}),null),c(W,o(N,{get when(){return $()?.length>0},get children(){return[$e(),o(fe,{get each(){return ve($(),"timeStamp",0)},children:(i,v)=>(()=>{var _=Fe(),x=_.firstChild,y=x.firstChild,L=y.nextSibling,w=L.nextSibling,f=x.nextSibling,I=f.firstChild,D=I.nextSibling,le=D.nextSibling;return c(y,o(j,{get name(){return b("M023009")?.statusListIcons?.[i?.currentStatus]},size:32})),L.style.setProperty("padding","8px"),c(L,()=>i?.idairguide),w.style.setProperty("padding","8px"),c(w,()=>i?.tracking),c(_,o(je,{}),f),c(I,()=>i?.city),c(le,()=>i?.consigneeInfo?.ybestate),C(()=>H(_,`client_item_box gWXAaj jlytmu manifest  ${q()?"isMobile":"centerBx"}`)),_})()})]}}),null),C(()=>H(l,De.App)),l})()}pe(["click"]);const ot=Object.freeze(Object.defineProperty({__proto__:null,default:Te,scannedQRs:Ae,setScannedQRs:Pe,setStatus:se,setTaskScan:re,status:p,taskScan:$},Symbol.toStringTag,{value:"Module"}));let Ge=[400,300,400,300,400],M=[300,80,300,80,300,80,300];const[Ve,lt]=O(!1),[K,ct]=T({scan:{}}),We=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let a=e.split("/")?.[0];return a.indexOf("230")>=0&&(a="230"+(a.split("230")?.[1]).slice(0,6)),a.indexOf("231")>=0&&(a="231"+(a.split("231")?.[1]).slice(0,5)),{params:{":search0":a},code:1}};function ze(e,t){return Math.floor(Math.random()*(t-e+1))+e}const dt=async(e,t)=>{let a=We(e),n={timeStamp:new Date().getTime(),latitude:X?.latitude,longitude:X?.longitude,statusId:t,userId:P?.profile?.userId,userName:P?.profile?.name};if(Ve()){let s=36e5;n.timeStamp=K?.scan?.timeStamp+s*10+ze(1,s*10),n.userId=K?.scan?.userId,n.userName=K?.scan?.userName,n.userIdAdm=P?.profile?.userId}if(t&&a?.params)return await Qe(a.params,n);{let s=a?.txt||a?.params?.[":search0"];return navigator.vibrate(M),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:s}}}}}},Qe=async(e,t)=>{let a=null;if(he()){qe();let n=b("manifestByHbls")?.[e?.[":search0"]],s=b("manifestByKeys")?.[n];if(!s){let d={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(M),{error:{alert:"error",color:"rgb(200 25 60)",scanData:d}}}a=Ne(s,t)}else a=await He(e,t);if(a?.code===203||a?.code===303)return navigator.vibrate(Ge),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let n={...a.data};return n.tracking=e?.[":search0"],n.timeStamp=new Date().getTime(),re([...$(),n]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let n={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(M),{error:{alert:"error",color:"rgb(200 25 60)",scanData:n}}}},Ne=(e,t)=>{let a={currentStatus:t?.statusId};if(e?.isSSG&&U?.roles?.SSG?.isActive,!U?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};let n=b("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(n===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let s=n?.split("_")?.[1],d=t?.statusId?.split("_")?.[1];if(s&&d&&s*1>d*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+n,ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let r={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},g={...t};g.ssg_track_key=e?.ssg_track_key,g.ssg_scan_key=we();let F={form:g,itmN:r,params:{airguide:e?.guia},actionKey:815005};Ye(F);let l={...g};Ze(l);let k={...b("ScannedLocByKey")};return k[e?.ssg_track_key]=g,u("ScannedLocByKey",k),{code:200,data:{...r,...a}}},He=async(e,t)=>{let a={params:e,form:t},n=Y(802001);return n=Y(802008),a={...a,...n},(await ke(a))?.data};let Z=null;const qe=()=>{Z||(Z=setInterval(()=>{Ue(),Xe()},750))},gt=()=>{E=new Date().getTime()};let E=0;const Xe=()=>{E+1250<new Date().getTime()&&(E=99999999999990,ne(ee,J,b("dbScannedStore")))};let R=0;const Ue=()=>{R+1250<new Date().getTime()&&(R=99999999999990,ne(ae,te,b("ScannedLocList")))},Ye=async e=>{E=new Date().getTime();let t={...b("dbScannedStore")};t[xe()]=e,u("dbScannedStore",t)},Ze=async e=>{R=new Date().getTime();let t={...b("ScannedLocList")};t[e?.ssg_scan_key]=e,u("ScannedLocList",t)},Je=async()=>{let e=await G(ee,J);et(e)},et=async e=>{let t={};e&&B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key,d=n?.guia;console.log(d);let r=n?.data2update?.currentStatus;t[s]||(t[s]={}),t[s][r]||(t[s][r]=1)}),u("alredyScan",t),tt(),me(B(e)?.length)},ie=async()=>{let e=await G(Ie,Le),t={},a={},n={},s={};return e&&B(e)?.map(d=>{let r=e?.[d];r?.hbls?.map(g=>{a[g?.hbl]||(a[g?.hbl]=r?.ssg_track_key,n[g?.hbl]=r)}),t[r?.ssg_track_key]||(t[r?.ssg_track_key]=r),s[r?.guia]?s[r?.guia]+=1:s[r?.guia]=1}),u("total_guia",s),u("manifestByKeys",t),u("manifestByHbls",a),u("hblsObjDBInd",n),t},tt=async()=>{await oe()},at=async()=>{await oe(),ie()},oe=async()=>{let e=await G(ae,te),t={};return B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key;t[s]?t[s]?.timeStamp<n?.timeStamp&&(t[s]=n):t[s]=n}),u("ScannedLocList",e),u("ScannedLocByKey",t),e};export{ot as S,Je as a,gt as b,lt as c,ct as d,K as f,dt as h,at as l,Ve as o,qe as s,Ye as u};
