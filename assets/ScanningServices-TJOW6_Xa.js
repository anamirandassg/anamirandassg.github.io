const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-BlhfNCeJ.js","assets/index-BF9hvZNs.js","assets/index-B8bAFC38.css","assets/FlexSpace-Di3dxmqH.js","assets/DropDwnSearch-Cx8tHhKI.js","assets/debounces-D0HWmYPa.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-CXxKSsWw.js","assets/html5-qrcode-scanner-D_xrgeUr.js","assets/Toast-C9kBFYJJ.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-C97DTV7w.js","assets/DialogHRM-Dn8EnKLU.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-2PrhD1cO.js","assets/ShowQRPrintLabel-Bwwrxf_3.js","assets/fontkit.es-DCR2sDLo.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-BDyDo5sB.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-BsQerIoe.js","assets/LoadingColorSpinner-CtJNfkpq.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{c as M,l as h,_ as L,a as A,b as le,o as oe,d as ce,i as c,e as l,S as R,au as W,p as B,R as de,aG as ge,aH as V,F as ue,ak as be,h as b,y as z,v as Q,A as pe,t as y,aI as fe,aJ as _e,aK as ye,am as Se,aL as T,aM as X,aN as U,O as D,Z as u,aO as me,aP as ve,aQ as he,aR as Y,aS as ee,aT as H,j as q,ad as Le,W as N,k as Z,m as ke,al as te,q as xe,aw as Ie}from"./index-BF9hvZNs.js";import"./Toast-C9kBFYJJ.js";import{s as $e}from"./App.module-CbHnVtRQ.js";var we=y('<div class="_dsplFlx flxWrp spaceAround centerBx">'),Ce=y('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Be=y('<div class="centerBx100 ">'),De=y('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Oe=y('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class=centerBx100 style=margin-top:20px>'),Ee=y('<div class="_dsplFlx flxWrp spaceAround centerBx"><div class=centerBx><h5 style=margin-left:12px>Iniciando...'),Ae=y("<div class=loader>Loading..."),Fe=y('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Pe,Re]=M(),j=h(()=>L(()=>import("./SVG-BlhfNCeJ.js"),__vite__mapDeps([0,1,2]))),je=h(()=>L(()=>import("./FlexSpace-Di3dxmqH.js"),__vite__mapDeps([3,1,2]))),Ke=h(()=>L(()=>import("./DropDwnSearch-Cx8tHhKI.js"),__vite__mapDeps([4,1,2,5,0,6]))),Ge=h(()=>L(()=>import("./ScanningCamera-CXxKSsWw.js"),__vite__mapDeps([7,1,2,8,5,9,10,11,12,13,14,15,16,17,18,19,20]))),Me=h(()=>L(()=>import("./ScanningManual-BsQerIoe.js"),__vite__mapDeps([21,1,2,12,13,9,10,19,20]))),Te=h(()=>L(()=>import("./LoadingColorSpinner-CtJNfkpq.js"),__vite__mapDeps([22,1,2,23]))),[S,ae]=A(""),[O,se]=A([]);function We(){M({});const[e,a]=A(1),[t,s]=fe(),n=o=>()=>s(()=>a(o));le(()=>{p()}),oe(()=>{}),ce(()=>{Q()&&a(0),_e(),et(),ne(),st()});function d(){return"geolocation"in navigator}function i(o){Se({latitude:o?.coords?.latitude,longitude:o?.coords?.longitude})}function p(){d()?navigator.geolocation.getCurrentPosition(i):showMessage("Geolocation isn't supported by your browser")}const k=()=>ye?.list;return(()=>{var o=Oe(),F=o.firstChild,P=F.nextSibling,m=P.nextSibling;return c(o,l(R,{get when(){return k()?.length},get fallback(){return(()=>{var r=Ee(),g=r.firstChild,f=g.firstChild;return c(g,l(Te,{stroke:"rgb(200 25 60 / 1)",size:32}),f),r})()},get children(){var r=we();return c(r,l(Ke,{get list(){return k()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return S()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:g=>ae(g.id),width:"260px"})),r}}),m),c(m,l(R,{get when(){return S()},get children(){return[(()=>{var r=Ce(),g=r.firstChild,f=g.firstChild,$=f.firstChild,v=g.nextSibling,x=v.firstChild,w=x.firstChild;return W(g,"click",n(0),!0),c($,l(j,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),W(v,"click",n(1),!0),c(w,l(j,{name:"keyboard",size:32,color:"#2b2b2b"})),B(_=>{var I=e()===0,C=e()===1;return I!==_.e&&g.classList.toggle("selected",_.e=I),C!==_.t&&v.classList.toggle("selected",_.t=C),_},{e:void 0,t:void 0}),r})(),(()=>{var r=Be();return c(r,l(de,{get fallback(){return Ae()},get children(){return l(ge,{get children(){return[l(V,{get when(){return e()===0},get children(){return l(Ge,{get status(){return S()},get locat(){return S()}})}}),l(V,{get when(){return e()===1},get children(){return l(Me,{get status(){return S()},get locat(){return S()}})}})]}})}})),B(()=>r.classList.toggle("pending",!!t())),r})()]}}),null),c(m,l(R,{get when(){return O()?.length>0},get children(){return[De(),l(ue,{get each(){return be(O(),"timeStamp",0)},children:(r,g)=>(()=>{var f=Fe(),$=f.firstChild,v=$.firstChild,x=v.nextSibling,w=x.nextSibling,_=$.nextSibling,I=_.firstChild,C=I.nextSibling,ie=C.nextSibling;return c(v,l(j,{get name(){return b("M023009")?.statusListIcons?.[r?.currentStatus]},size:32})),x.style.setProperty("padding","8px"),c(x,()=>r?.idairguide),w.style.setProperty("padding","8px"),c(w,()=>r?.tracking),c(f,l(je,{}),_),c(I,()=>r?.city),c(ie,()=>r?.consigneeInfo?.ybestate),B(()=>z(f,`client_item_box gWXAaj jlytmu manifest  ${Q()?"isMobile":"centerBx"}`)),f})()})]}}),null),B(()=>z(o,$e.App)),o})()}pe(["click"]);const lt=Object.freeze(Object.defineProperty({__proto__:null,default:We,scannedQRs:Pe,setScannedQRs:Re,setStatus:ae,setTaskScan:se,status:S,taskScan:O},Symbol.toStringTag,{value:"Module"}));let Ve=[400,300,400,300,400],K=[300,80,300,80,300,80,300];const[ze,ot]=A(!1),[ct,dt]=M({scan:{}}),Qe=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let t=e.split("/")?.[0];return t.indexOf("230")>=0&&(t="230"+(t.split("230")?.[1]).slice(0,6)),t.indexOf("231")>=0&&(t="231"+(t.split("231")?.[1]).slice(0,5)),{params:{":search0":t},code:1}},gt=async(e,a)=>{let t=Qe(e),s={timeStamp:new Date().getTime(),latitude:H?.latitude,longitude:H?.longitude,statusId:a,userId:q?.profile?.userId,userName:q?.profile?.name};if(ze(),a&&t?.params)return await He(t.params,s);{let n=t?.txt||t?.params?.[":search0"];return navigator.vibrate(K),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},He=async(e,a)=>{let t=null;if(Le()){Ze();let s=b("manifestByHbls")?.[e?.[":search0"]],n=b("manifestByKeys")?.[s];if(console.log(n),!n){let d={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(K),{error:{alert:"error",color:"rgb(200 25 60)",scanData:d}}}t=qe(n,a)}else t=await Ne(e,a);if(console.log(t),t?.code===203||t?.code===303)return navigator.vibrate(Ve),{error:{alert:"warning",color:"#FF6F1D",scanData:t.data}};if(t?.code===200){navigator.vibrate(500);let s={...t.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),se([...O(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:t.data}}}else if(!t||t?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(K),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},qe=(e,a)=>{let t={currentStatus:a?.statusId};e?.isSSG&&N?.roles?.SSG?.isActive;let s=e?.address?.estate||e?.consigneeInfo?.ybestate,n=e?.address?.city||e?.consigneeInfo?.ybcity;if(console.log(e),!N?.roles?.[s]?.isActive)return{code:303,data:{consigneeInfo:{ybcity:"Zona incorrecta ",ybestate:s,bagnumber:e?.bagnumber}}};let d=b("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(d===a.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:s,bagnumber:e?.bagnumber}}};let i=d?.split("_")?.[1],p=a?.statusId?.split("_")?.[1];if(i&&p&&i*1>p*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+d,ybestate:s,bagnumber:e?.bagnumber}}};let k={idairguide:e?.idairguide,city:n,estate:s,consigneeInfo:{ybestate:s,ybcity:n},bagnumber:e?.bagnumber,isSSG:e?.isSSG},o={...a};o.ssg_track_key=e?.ssg_track_key,o.ssg_scan_key=Ie();let F={form:o,itmN:k,params:{airguide:e?.guia},actionKey:815005};Ue(F);let P={...o};Ye(P);let m={...b("ScannedLocByKey")};return m[e?.ssg_track_key]=o,u("ScannedLocByKey",m),{code:200,data:{...k,...t}}},Ne=async(e,a)=>{let t={params:e,form:a},s=Z(802001);return s=Z(802008),t={...t,...s},(await ke(t))?.data};let J=null;const Ze=()=>{J||(J=setInterval(()=>{Xe(),Je()},750))},ut=()=>{E=new Date().getTime()};let E=0;const Je=()=>{E+1250<new Date().getTime()&&(E=99999999999990,te(U,X,b("dbScannedStore")))};let G=0;const Xe=()=>{G+1250<new Date().getTime()&&(G=99999999999990,te(ee,Y,b("ScannedLocList")))},Ue=async e=>{E=new Date().getTime();let a={...b("dbScannedStore")};a[xe()]=e,u("dbScannedStore",a)},Ye=async e=>{G=new Date().getTime();let a={...b("ScannedLocList")};a[e?.ssg_scan_key]=e,u("ScannedLocList",a)},et=async()=>{let e=await T(U,X);tt(e)},tt=async e=>{let a={};e&&D(e)?.map(t=>{let s=e[t],n=s?.ssg_track_key,d=s?.guia;console.log(d);let i=s?.data2update?.currentStatus;a[n]||(a[n]={}),a[n][i]||(a[n][i]=1)}),u("alredyScan",a),at(),me(D(e)?.length)},ne=async()=>{let e=await T(he,ve),a={},t={},s={},n={};return e&&D(e)?.map(d=>{let i=e?.[d];i?.hbls?.map(p=>{t[p?.hbl]||(t[p?.hbl]=i?.ssg_track_key,s[p?.hbl]=i)}),a[i?.ssg_track_key]||(a[i?.ssg_track_key]=i),n[i?.guia]?n[i?.guia]+=1:n[i?.guia]=1}),u("total_guia",n),u("manifestByKeys",a),u("manifestByHbls",t),u("hblsObjDBInd",s),a},at=async()=>{await re()},st=async()=>{await re(),ne()},re=async()=>{let e=await T(ee,Y),a={};return D(e)?.map(t=>{let s=e[t],n=s?.ssg_track_key;a[n]?a[n]?.timeStamp<s?.timeStamp&&(a[n]=s):a[n]=s}),u("ScannedLocList",e),u("ScannedLocByKey",a),e};export{lt as S,et as a,ut as b,ot as c,dt as d,ct as f,gt as h,st as l,ze as o,Ze as s,Ue as u};
