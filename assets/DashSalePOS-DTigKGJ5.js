const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FlexSpace-rPOweVzt.js","assets/index-DH8C3qs7.js","assets/index-DEEWbFNK.css","assets/SVG-CAmOGkx7.js","assets/Util-CKCUAuLU.js","assets/ShowQRProducts-DEQe3sQC.js","assets/ShowQRPrintLabel-xvvlWjOO.js","assets/PDFButton-DzKPI8bv.js","assets/qrcode-DHy8FFhS.js","assets/fontkit.es-xY8_R9eo.js","assets/InitPrintServices-Cu6eu-iZ.js","assets/Toast-BlUV_0we.js","assets/Toast-DLpFKn-Q.css","assets/InputHr-0MQZ44Nz.js","assets/InputHr-M3rJ9grQ.css","assets/LoadingColorSpinner-jqJgTjDq.js","assets/LoadingColorSpinner-DPNLfwBi.css","assets/ButonHrm-B2b1yBfX.js","assets/ButonHrm-BSeWNUGQ.css","assets/ItemOnSalesPos-Ca3uB-lC.js","assets/components-Dw9ByB5J.js"])))=>i.map(i=>d[i]);
import{l as S,_ as w,c as G,a as U,o as tt,k as et,b as H,i as m,d as v,F,S as N,j as at,e as T,s as K,n as L,w as it,h as rt,t as E}from"./index-DH8C3qs7.js";import{G as A,O as P,c as W,f as st,j as lt,i as ct,b as O}from"./Util-CKCUAuLU.js";import"./DialogHRM-CvD8NJGp.js";import"./browser-image-compression-BVJ4p9S0.js";import{OpenToast as D}from"./Toast-BlUV_0we.js";import"./PDFButton-DzKPI8bv.js";import"./qrcode-DHy8FFhS.js";import"./fontkit.es-xY8_R9eo.js";import{I as nt}from"./print_invoice_service-DC47T8lC.js";import{g as X,a as Y}from"./handelImagesServices-CSnRKUqk.js";import{LookupInventory as z}from"./DashInventoryMov-CsxbjqC7.js";import"./DashInventory-D_QxV6Cn.js";import"./InitPrintServices-Cu6eu-iZ.js";import"./App.module-CbHnVtRQ.js";S(()=>w(()=>import("./FlexSpace-rPOweVzt.js"),__vite__mapDeps([0,1,2])));S(()=>w(()=>import("./SVG-CAmOGkx7.js"),__vite__mapDeps([3,1,2,4])));S(()=>w(()=>import("./ShowQRProducts-DEQe3sQC.js"),__vite__mapDeps([5,1,2,6,7,4,8,9,10,11,12])));S(()=>w(()=>import("./InputHr-0MQZ44Nz.js"),__vite__mapDeps([13,1,2,14])));const V=t=>new Promise((s,o)=>{A.get(t,function(c,_){s(_)})});var ot=E('<div style="padding:50px 0"><section class=qsuVSc><section class=bLl6je><section class=dvPdhb>'),dt=E('<section class="h6rxkc ">'),ut=E('<section class=KgyCAd><section class=WirBi><section class=""><section class="EMijzc centerBx"><div class="icon_status centerBx "style="margin:0 4px"></div><div class="icon_status centerBx "style="margin:0 4px">'),mt=E('<section class=rtS8wf><div class=X3QHFf><div class="LhAUHc evth2b"><div class=kDdWge><div class=QCNFEe><p class=jhB0af>Summario de la orden</p></div><div class=qntUl><p class=B7xUP><span data-test-integ-cart-subtotal-label="">Subtotal</span><span data-test-integ-cart-subtotal-value="">$</span></p><p class=B7xUP><span data-test-integ-cart-subtotal-label="">Estimated tax</span><span data-test-integ-cart-subtotal-value="">$</span></p><p class=B7xUP><span data-test-integ-cart-subtotal-label=""class=OGw7rb>Estimated total</span><span data-test-integ-cart-subtotal-value=""class=OGw7rb> $</span></p></div></div><section class=JM2zDb>'),ft=E('<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty:</span><select class=RIw0b aria-label="Product Quantity"></select></section><p class=GehUpe data-test-line-item-price=""><span data-test-integ-cart-current-price="">$</span></p><section class=dEfaq><section class=JpKBkb><button class=yjHiqb jsaction=click:IY6UFe data-line-number=1 data-selected-quantity=1 data-test-remove-btn=1 aria-label="Remove Nest Doorbell (wired, 2nd gen) (Snow) from cart"><span>Remover'),Z=E("<option>"),pt=E('<section class=dEfaq><section><button class="yjHiqb wv2Pxc"jsaction=click:A4e0fe data-line-number=1 data-test-sfl-btn=1 aria-label="Move Nest Doorbell (wired, 2nd gen) (Snow) from cart to save for later cart."><span>Save for later</span></button></section><section class=JpKBkb><button class=yjHiqb jsaction=click:IY6UFe data-line-number=1 data-selected-quantity=1 data-test-remove-btn=1 aria-label="Remove Nest Doorbell (wired, 2nd gen) (Snow) from cart"><span>Remove'),_t=E('<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty:</span><select class=RIw0b aria-label="Product Quantity"></select></section><p class=GehUpe data-test-line-item-price=""><span data-test-integ-cart-current-price="">$');S(()=>w(()=>import("./FlexSpace-rPOweVzt.js"),__vite__mapDeps([0,1,2])));const M=S(()=>w(()=>import("./SVG-CAmOGkx7.js"),__vite__mapDeps([3,1,2,4])));S(()=>w(()=>import("./LoadingColorSpinner-jqJgTjDq.js"),__vite__mapDeps([15,1,2,16])));const ht=S(()=>w(()=>import("./InputHr-0MQZ44Nz.js"),__vite__mapDeps([13,1,2,14]))),bt=S(()=>w(()=>import("./ButonHrm-B2b1yBfX.js"),__vite__mapDeps([17,1,2,3,4,18])));S(()=>w(()=>import("./ItemOnSalesPos-Ca3uB-lC.js"),__vite__mapDeps([19,1,2,4,11,12,20])));const[B,Q]=G({items:{}}),j="348723orh2idsffs";function Vt(){U(0),U(0);const[t,s]=U("");tt(()=>{}),et(()=>{}),H(()=>{o()});const o=async()=>{(await Ct())?.map(c=>{Q("items",c.doc)})};return(()=>{var l=ot(),c=l.firstChild,_=c.firstChild,h=_.firstChild;return m(h,v(N,{get when(){return P(B?.items?.cart)},get children(){return v(F,{get each(){return P(B?.items?.cart)},children:(d,f)=>v(yt,{get itm(){return B?.items?.cart?.[d]}})})}})),m(c,v(gt,{updSearch:s}),null),m(c,v($t,{get item(){return B?.items?.cart}}),null),l})()}const gt=t=>{const[s,o]=U(""),[l,c]=U(1),_=()=>{l()===1&&s().length>8&&h(s())},h=async n=>{let b=L?.profile?.agencyStore?.id,u=`${n}`,i=await J(u),e=P(i)?.[0],g=`${e} ${b}`,p=await z(g),a=0,r=0;i?.[e]&&P(p)?.map(x=>{p[x]?.products?.map(y=>{e===y?.product?.id&&(a+=y?.price*1*y?.qty*1,r+=y?.qty*1)})});let $=1,C=await V(j)||{};C?.cart?.[e]&&($=C?.cart?.[e].qty*1+1);const q=r?a/r:0;if(r&&r-$>=0){let x=C;if(C?.cart||(x.cart={}),C?.cart?.[e])x.cart[e].qty=$;else{let y={product:{id:e,label:i?.[e]?.name,code:i?.[e]?.code},qty:$,price:q,salePrice:i?.[e]?.salePrice};x.cart[e]=y}A.put(x,function(I,k){I||(Q("items",x),o(""),D({text:i?.[e]?.name+" agregado al carrito",timeout:3500,theme:"blue",id:O()}))})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})},[d,{refetch:f}]=at(s,async n=>{if(l()===2&&n.length>4){const b=await J(n);let u=[];return P(b).map(i=>{let e=b[i];u.push(e)}),u}else return[]});return(()=>{var n=ut(),b=n.firstChild,u=b.firstChild,i=u.firstChild,e=i.firstChild,g=e.nextSibling;return m(u,v(N,{get when(){return d()?.length>0},get children(){var p=dt();return m(p,v(F,{get each(){return d()},children:(a,r)=>v(xt,{itm:a})})),p}}),i),m(i,v(ht,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return s()},placeholder:"buscar productos ...",colors:"#2b2b2b",handleClick:o,onEnter:_}),e),e.$$click=()=>c(1),m(e,v(M,{name:"qrcode-scan",size:22,get color(){return l()===1?"#646cff":""}})),g.$$click=()=>c(2),m(g,v(M,{name:"keyboard",size:22,get color(){return l()===2?"#646cff":""}})),n})()},$t=t=>{const s=l=>{let c=0;return P(t?.item)?.map(_=>{let h=t?.item?.[_];c+=h?.qty*1*h?.salePrice}),c},o=async l=>{let c={...t?.item};c.amount=s();let _=await nt(c);window.open(_)};return(()=>{var l=mt(),c=l.firstChild,_=c.firstChild,h=_.firstChild,d=h.firstChild,f=d.nextSibling,n=f.firstChild,b=n.firstChild,u=b.nextSibling;u.firstChild;var i=n.nextSibling,e=i.firstChild,g=e.nextSibling;g.firstChild;var p=i.nextSibling,a=p.firstChild,r=a.nextSibling;r.firstChild;var $=h.nextSibling;return m(u,()=>s().toFixed(2),null),m(g,()=>(s()*.06).toFixed(2),null),m(r,()=>(s()*.06+s()).toFixed(2),null),m($,v(bt,{color:"#646cff",label:"Imprimir",handleClick:o})),l})()},yt=t=>{const[s,o]=G(),l=()=>s?.[t?.itm?.product?.id]?.productImageUrl?X()+Y()+"/"+s?.[t?.itm?.product?.id]?.productImageUrl:null,c=async()=>{let d=t?.itm?.product?.id,f=`${d}`,n=await J(f);n?.[d]?.productImageUrl&&o(d,n?.[d])};H(()=>{c()});let _=Array.from(Array(10).keys());const h=async d=>{let f=L?.profile?.agencyStore?.id,n=t?.itm?.product?.id,b=`${n} ${f}`,u=await z(b),i=0,e=0;P(u)?.map(p=>{u[p]?.products?.map(a=>{n===a?.product?.id&&(i+=a?.price*1*a?.qty*1,e+=a?.qty*1)})});const g=e?i/e:0;if(e&&e-d>=0){let p=await V(j)||{},a=p;if(p?.cart||(a.cart={}),p?.cart?.[n])a.cart[n].qty=d;else{let r={product:{id:n,label:t?.itm?.name,code:t?.itm?.code},qty:d,price:g,salePrice:t?.itm?.salePrice};a.cart[n]=r}A.put(a,function($,C){$||(Q("items",a),t?.cleanTX?.(),D({text:" El carrito fue actualizado",timeout:3500,theme:"blue",id:O()}))})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})};return(()=>{var d=ft(),f=d.firstChild,n=f.firstChild,b=n.firstChild,u=b.firstChild,i=u.firstChild,e=u.nextSibling,g=e.firstChild,p=g.firstChild,a=p.firstChild;a.firstChild;var r=g.nextSibling,$=r.firstChild,C=$.firstChild,q=C.nextSibling,x=$.nextSibling,y=x.firstChild;return y.firstChild,m(a,()=>t?.itm?.product?.label,null),q.addEventListener("change",I=>{h(I?.target?.value)}),m(q,v(F,{each:_,children:(I,k)=>(()=>{var R=Z();return R.value=I*1+1+"",m(R,I*1+1),T(()=>R.selected=I*1+1===t?.itm?.qty*1),R})()})),m(y,()=>(t?.itm?.salePrice*1).toFixed(2),null),T(()=>K(i,"src",l())),d})()},J=async(t,s)=>{let o={params:{businessId:L?.profile?.businessYId}};t&&t.split(" ").map((_,h)=>{_&&(o.params[":search"+h]=_.trim())});let l=W(122001);o={...o,...l},o.params[":search0"];const c=await st(o);return c?.error?{}:c},jt=async t=>{let s=[];t.map(o=>{let l={params:{id:o?.ssg_track_key,idairguide:"all"}},c=W(802002);l={...l,...c},s.push(l)}),lt(s,vt)},vt=async t=>{const o=await ct(t);if(o)return o},Ct=()=>new Promise((t,s)=>{A.allDocs({include_docs:!0,descending:!0},function(o,l){t(l.rows)})}),xt=t=>{const[s,o]=G(),l=()=>s?.prod?.productImageUrl?X()+Y()+"/"+s?.prod?.productImageUrl:null;H(()=>{o("prod",t?.itm)});let c=Array.from(Array(10).keys());const _=async h=>{let d=L?.profile?.agencyStore?.id,f=t?.itm?.product?.id,n=`${f} ${d}`,b=await z(n),u=0,i=0;P(b)?.map(a=>{b[a]?.products?.map(r=>{f===r?.product?.id&&(u+=r?.price*1*r?.qty*1,i+=r?.qty*1)})});let e=1,g=await V(j)||{};g?.cart?.[f]&&(e=g?.cart?.[f].qty+1);const p=i?u/i:0;if(i&&i-e>=0){let a=await V(j)||{},r=a;if(a?.cart||(r.cart={}),a?.cart?.[f])r.cart[f].qty=e;else{let $={product:{id:f,label:t?.itm?.name,code:t?.itm?.code},qty:e,price:p,salePrice:t?.itm?.salePrice};r.cart[f]=$}A.put(r,function(C,q){C||(Q("items",r),t?.cleanTX?.(),D({text:" El carrito fue actualizado",timeout:3500,theme:"blue",id:O()}))})}else D({text:"Sin Existencia",timeout:3500,theme:"red",id:O()})};return(()=>{var h=_t(),d=h.firstChild,f=d.firstChild,n=f.firstChild,b=n.firstChild,u=b.firstChild,i=b.nextSibling,e=i.firstChild,g=e.firstChild,p=g.firstChild;p.firstChild;var a=e.nextSibling,r=a.firstChild,$=r.firstChild,C=$.nextSibling,q=r.nextSibling,x=q.firstChild;return x.firstChild,m(p,()=>t?.itm?.name,null),C.addEventListener("change",y=>{_(y?.target?.value)}),m(C,v(F,{each:c,children:(y,I)=>(()=>{var k=Z();return k.value=y*1+1+"",m(k,y*1+1),T(()=>k.selected=y*1+1===t?.itm?.qty*1),k})()})),m(x,()=>(t?.itm?.salePrice*1).toFixed(2),null),m(a,v(N,{get when(){return it()},get children(){return pt()}}),null),T(()=>K(u,"src",l())),h})()};rt(["click"]);export{J as LookupProducts,B as cartItems,j as cartKey,Vt as default,vt as fetchCSVInve,Ct as loadCarts,jt as loadProduct,Q as setCartItems};
