const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CheckBoxSlide-DsVNJepw.js","assets/index-Bv_yujZ7.js","assets/index-BRlA1Q7g.css","assets/CheckBoxSlide-uVD3DHDO.css","assets/ButonHrm-CxMd0F18.js","assets/SVG-nyC_HnTq.js","assets/Util-DCAGxQXf.js","assets/ButonHrm-BSeWNUGQ.css","assets/LoadingColorSpinner-DL3QAZS3.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{l as j,_ as G,c as ae,a as W,d as ne,i as p,e as g,a8 as x,S as q,F as ie,f as re,j as z,x as le,g as oe,t as I}from"./index-Bv_yujZ7.js";import{g as B,f as E,O as P,q as ce,S as Z,I as V,m as $,e as H,Y as de,a as O,Z as pe,T as ue}from"./Util-DCAGxQXf.js";import"./DialogHRM-CfG04dN4.js";import{c as fe,b as S,i as N,d as k}from"./Scanning-C1DAFpzI.js";import{OpenToast as M}from"./Toast-BSRBk_RB.js";import"./App.module-CbHnVtRQ.js";var ge=I('<div class="_dsplFlx flxWrp spaceAround ">'),me=I('<div class="centerBx bottombx spaceAround flxWrp"style=margin-top:20px><div style=padding:6px></div><div style=padding:6px></div><div style=padding:6px>'),be=I('<div><div><div class="_dsplFlx flxWrp spaceAround "><div class="_dsplFlx bottombx lowbordr"><h5>Subir Pendientes </h5></div></div><div class="_dsplFlx flxWrp spaceAround "style="padding:18px 0px 0"><div class="_dsplFlx bottombx lowbordr"><h5>Descargar Guias </h5></div></div><div class="centerBx bottombx grid2Col"></div></div><div class="_dsplFlx flxWrp spaceAround "style="padding:18px 0px 0"><div class="_dsplFlx bottombx lowbordr"><h5>Descargar Manifiestos </h5></div></div><div class="centerBx bottombx spaceAround"style=margin-top:20px>'),ye=I('<div class="centerBx bottombx "><h5> subiendo al servidor <!> / <!> '),he=I('<div class="centerBx spaceAround"><div class="centerBx bottombx "><h5 class="">'),_e=I('<div class="centerBx bottombx "><h5> descargando guias... ');const ve=j(()=>G(()=>import("./CheckBoxSlide-DsVNJepw.js"),__vite__mapDeps([0,1,2,3]))),C=j(()=>G(()=>import("./ButonHrm-CxMd0F18.js"),__vite__mapDeps([4,1,2,5,6,7]))),K=j(()=>G(()=>import("./LoadingColorSpinner-DL3QAZS3.js"),__vite__mapDeps([8,1,2,9])));function De(a){const[t,i]=ae({}),[c,d]=W(!1),[m,y]=W(0);ne(()=>{S(k),N()});let h=[2503,2504,2505,2506];const w=async e=>{if(y(x()),x()>30){let n=4,r=Array.from(Array(n).keys()),u=Math.ceil(x()/n);const l=r.map(async o=>{let _=u*o,s=u*(o+1)-1;s>x()&&(s=x()),await $(e.slice(_,s),Q)});await Promise.all(l)}else await $(e,Q);S(k),y(0)},F=async e=>{V.allDocs({include_docs:!0,descending:!0},function(n,r){w(r.rows)})},Q=async e=>{let n=await xe(e?.doc);return V.remove(e?.doc,function(u,l){u||(console.log(" successfully removed "),S(k))}),n};let L={};const J=async e=>{let n=await Se("guia",e);L=Object.assign({},L,n)},Y=async()=>{let e=[];if(P(t).map(n=>{t[n]&&e.push(n)}),d(!0),e.length>0){await $(e,J);let n=[],r=[];P(L).map(u=>{let l={...L[u]},o=l.hbls[0]?.hbl;l.id=o,l._id=o;let _=H("hblsObjDBInd");if(!_[o])n.push(l);else{let s={key:1,_id:1,id:1,_rev:1};l._rev=_[o]._rev,de(P(_[o]),l,_[o],s)?.hasChange&&r.push(l)}}),T(n,R),T(r,R),await N(),S(k),M({text:"El modo offline esta listo para escanear",timeout:2500,id:O()})}else M({text:"Debe selecionar una guia",timeout:2500,id:O()});d(!1)},R=async e=>{Z.put(e,function(r,u){r||console.log("Successfully posted")})};let A={};const X=async e=>{let n=await we(e);A=Object.assign({},A,n)},ee=async()=>{let e=[],n=H("ScannedLocList")||{};if(P(t).map(r=>{t[r]&&e.push(r)}),d(!0),e.length>0){await $(e,X);let r=[];P(A).map(u=>{let l={...A[u]},o=l.ssg_scan_key;l.id=o,l._id=o,n[o]||r.push(l)}),T(r,te),S(k),M({text:"se descargo con exito la lista de escaneos",timeout:2500,id:O()})}else M({text:"Debe selecionar una guia",timeout:2500,id:O()});d(!1)},te=async e=>{ue.put(e,function(r,u){r||console.log("Successfully posted")})},se=()=>{pe(),setTimeout(()=>{S(k)},600)};return(()=>{var e=be(),n=e.firstChild,r=n.firstChild,u=r.nextSibling,l=u.nextSibling,o=n.nextSibling,_=o.nextSibling;return e.style.setProperty("max-height","80vh"),e.style.setProperty("overflow","auto"),e.style.setProperty("background","#ffffff"),e.style.setProperty("border-radius","13"),p(n,g(q,{get when(){return x()>0},get children(){return g(q,{get when(){return!m()},get fallback(){return(()=>{var s=ye(),f=s.firstChild,b=f.firstChild,v=b.nextSibling,D=v.nextSibling,U=D.nextSibling;return U.nextSibling,p(s,g(K,{stroke:"rgb(200 25 60 / 1)",size:32}),f),p(f,()=>m()-x(),v),p(f,m,U),s})()},get children(){var s=ge();return p(s,g(C,{icon:"arrow_up_large",color:"#c8193c",label:"Subir pendientes",handleClick:F})),s}})}}),u),p(l,g(ie,{each:h,children:(s,f)=>(()=>{var b=he(),v=b.firstChild,D=v.firstChild;return p(v,g(ve,{get initValue(){return t?.[s]},updChange:()=>i(s,!t?.[s]),color:"var(--background-red-ssg)"}),D),p(D,s),b})()})),p(e,g(q,{get when(){return!c()},get fallback(){return(()=>{var s=_e();return p(s,g(K,{stroke:"rgb(200 25 60 / 1)",size:32}),null),s})()},get children(){var s=me(),f=s.firstChild,b=f.nextSibling,v=b.nextSibling;return p(f,g(C,{icon:"cancel",color:"#4a4a4a",label:"Limpiar",handleClick:se})),p(b,g(C,{icon:"arrow_down_large",color:"#c8193c",label:"Descargar Guias",handleClick:Y})),p(v,g(C,{icon:"arrow_down_large",color:"#c8193c",label:"Descargar locaciones",handleClick:ee})),s}}),o),p(_,g(C,{icon:"arrow_down_large",color:"#c8193c",label:"Descargar",handleClick:ke})),re(s=>{var f=z()?"86vw":"420px",b=z()?"15px 5px":"15px 25px";return f!==s.e&&((s.e=f)!=null?e.style.setProperty("width",f):e.style.removeProperty("width")),b!==s.t&&((s.t=b)!=null?e.style.setProperty("padding",b):e.style.removeProperty("padding")),s},{e:void 0,t:void 0}),e})()}const Oe=a=>{let t=a,i="^[A-Z]{3}[0-9]{4}-[1-9]{5}";const c=new RegExp(i);return t.length===13&&c.test(t)&&(t=t.slice(3,12)),t},xe=async a=>{let t={};a?.params&&(t.params=a?.params),a?.data2update&&(t.data2update=a?.data2update),a?.form&&(t.form=a?.form);let i=B(a?.actionKey);return t={...t,...i},await E(t)},we=async a=>{let t={params:{airguide:a,":search0":"ssg"}},i=B(815002);t={...t,...i};const c=await E(t);return c?.data?.error?{}:c},Se=async(a,t)=>{let i={params:{idairguide:t},fldswQry:["street","agency","idairguide","currentStatus","cidentity","ssg_track_key","bagnumber","tracking","estate","city","zone","guia","consigneeInfo:phoneNumber","consigneeInfo:altPhoneNumber","consigneeInfo:firstName","consigneeInfo:middleName","consigneeInfo:lastName","consigneeInfo:lastName2","consigneeInfo:ybstreet","consigneeInfo:ybstreetNo","consigneeInfo:ybbetwen1","consigneeInfo:ybbetwen2","consigneeInfo:ybreparto","consigneeInfo:ybestate","consigneeInfo:ybcity","deliveryUserId","deliveryTime","isSSG","isLMH","isPaid","hbls","noteTag","nameshipper","billedBy"]};a.split(" ").map((m,y)=>{m&&(i.params[":search"+y]=m.trim())}),i.params[":guia"]=t+"";let c=B(802001);i={...i,...c};const d=await E(i);return d?.data?.error?{}:d},ke=async(a,t)=>{await fe();let i={params:{":search0":" "},fldsjQry:["createDate","linkedUser","status","name","city","province","workgroup","ssg_manifest_key","isPending"]};le()||(i.params.workgroup=oe?.profile?.workgroup?.id+"");let c=B(703001);i={...i,...c};const d=await E(i);if(d?.error)return{};{let m=[];return P(d).map(y=>{let h=d[y];h._id=h?.ssg_manifest_key,ce.put(h,function(F,Q){F||console.log("Successfully posted on manifest list")}),m.push(h)}),m}},T=async(a,t)=>{if(a.length>30){let i=10,c=Array.from(Array(i).keys()),d=Math.ceil(a.length/i);const m=c.map(async y=>{let h=d*y,w=d*(y+1)-1;w>a.length&&(w=a.length),await $(a.slice(h,w),t)});await Promise.all(m)}else await $(a,t);return N(),1},Me=()=>new Promise((a,t)=>{Z.allDocs({include_docs:!0,descending:!0},function(i,c){a(c.rows)})});export{ke as LookupManifets,De as default,Me as loadManifestOffline,Oe as parseTrcking};
