const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-DwHyCtjz.js","assets/index-DjvPVNJT.js","assets/index-BRlA1Q7g.css","assets/Util-BOZFT72w.js","assets/InputHr-B6qd61_Q.js","assets/InputHr-BXFw4d2l.css","assets/ButonHrm-CtjeNzna.js","assets/ButonHrm-BSeWNUGQ.css","assets/DropDwnFetchSearch-w-hOF_Mw.js","assets/debounces-DIwPPKs0.js","assets/DropDwnSearch-DMkLkRPc.css","assets/DropDwnSearch-IIeRO-So.js","assets/PickDate-D4-uM3R4.js","assets/DialogHRM-MtqXYXq9.js","assets/DialogHRM-V9_lZntj.css","assets/FloatInputText-BenKHvrI.js","assets/FloatInputText-BnENulVO.css"])))=>i.map(i=>d[i]);
import{l as _,_ as f,c as M,a as A,d as le,i as o,e as r,q as ae,S as h,F as ne,f as se,j as de,h as ce,t as S,g as N}from"./index-DjvPVNJT.js";import{a as q,O as be,g as pe,f as ue}from"./Util-BOZFT72w.js";import{CloseModal as ve}from"./DialogHRM-MtqXYXq9.js";import{u as ge}from"./debounces-DIwPPKs0.js";import{LookupProducts as he}from"./DashProducts-D8RXfAeM.js";import j from"./FlexSpace-BrQ5cF_F.js";import{LookupInventory as _e}from"./DashInventory-AHREoFkg.js";import{OpenToast as fe}from"./Toast-U1EupqyO.js";import{validStores as H}from"./AddInventory-D3evhFfW.js";import"./App.module-CbHnVtRQ.js";var P=S("<div style=padding:4px>"),me=S('<div style="margin:15px 0"class=" spaceAround centerBx">'),ye=S('<div><div><div class="_dsplFlx flxWrp spaceAround "><div><div class="_dsplFlx bottombx lowbordr"><h5>Salidas o Ventas</h5></div></div><div class="_dsplFlx bottombx "></div></div><div class="_dsplFlx bottombx flxWrp spaceAround txtWrap"><div style=padding:4px></div><div style=padding:4px></div><div style=padding:4px></div><div style=padding:4px></div><div style=padding:4px></div><div class=hseparator></div><div style=padding:4px>'),xe=S('<div class="bottombx centerBx unit tr_bar_20"><h5>Precio:</h5><div class=unitBx><h5>$'),Ce=S('<div class="bottombx centerBx unit"><div class=tr_bar_50><h5></h5></div><div class="bottombx centerBx unit tr_bar_20"><h5>Cantidad:</h5><div class=bag_number><h5></h5></div></div><div class="icon_status centerBx tr_bar_10">');const Se=_(()=>f(()=>import("./SVG-DwHyCtjz.js"),__vite__mapDeps([0,1,2,3])));_(()=>f(()=>import("./InputHr-B6qd61_Q.js"),__vite__mapDeps([4,1,2,5])));const W=_(()=>f(()=>import("./ButonHrm-CtjeNzna.js"),__vite__mapDeps([6,1,2,0,3,7]))),ke=_(()=>f(()=>import("./DropDwnFetchSearch-w-hOF_Mw.js"),__vite__mapDeps([8,1,2,9,0,3,10]))),E=_(()=>f(()=>import("./DropDwnSearch-IIeRO-So.js"),__vite__mapDeps([11,1,2,9,0,3,10]))),$e=_(()=>f(()=>import("./PickDate-D4-uM3R4.js"),__vite__mapDeps([12,1,2,13,14,3]))),C=_(()=>f(()=>import("./FloatInputText-BenKHvrI.js"),__vite__mapDeps([15,1,2,16])));function Le(b){M();const[e,n]=M({invoice:"",description:""}),[F,k]=A(""),[y,I]=A(null),[p,z]=A([]),Q=ge(k,400),c=(i,l)=>{n({[i]:l}),Q(q())},Y=async i=>{if(e?.type==="TRANSFER"&&e?.storeTo){let l={type:e?.type,invoice:e?.invoice,description:e?.description,store:e?.store,toStore:e?.storeTo,hbl:e?.hbl,createDate:e?.createDate||new Date().getTime(),products:p()};await T(l);const s=a=>(a.qty=a.qty*-1,a);let d=p().map(a=>s(a)),u={type:e?.type,invoice:e?.invoice,description:e?.description,store:e?.storeTo,fromStore:e?.store,hbl:e?.hbl,createDate:e?.createDate||new Date().getTime(),products:d};await T(u)}else{let l={type:e?.type,invoice:e?.invoice,description:e?.description,store:e?.store,hbl:e?.hbl,createDate:e?.createDate||new Date().getTime(),products:p()};await T(l)}ve(b?.modalId)};le(()=>{b?.bagnumber&&n({invoice:b?.bagnumber}),b?.hbl&&(n({description:b?.hbl}),n({hbl:b?.hbl}))});const G=async i=>{let l=await he(i),s=[];return Object.keys(l).map(d=>{s.push({id:d,label:l[d]?.name,code:l[d]?.code})}),s},K=async i=>{let l=`${y()?.id} ${e?.store}`,s=await _e(l),d=0,u=0;be(s)?.map(v=>{s[v]?.products?.map(g=>{y()?.id===g?.product?.id&&(d+=g?.price*1*g?.qty*1,u+=g?.qty*1)})});const a=d/u;if(u-e?.qty>=0){let v={product:y(),qty:e?.qty*-1,price:a,salePrice:e?.salePrice};z([...p(),v]),n({qty:0}),n({price:0}),I(null)}else fe({text:"Sin Existencia",timeout:3500,theme:"red",id:q()})},J=async i=>{};return(()=>{var i=ye(),l=i.firstChild,s=l.firstChild,d=s.firstChild,u=d.nextSibling,a=s.nextSibling,v=a.firstChild,g=v.nextSibling,R=g.nextSibling,w=R.nextSibling,L=w.nextSibling,U=L.nextSibling,X=U.nextSibling;return i.style.setProperty("height","clamp(60vh, 70vh, 80vh)"),i.style.setProperty("overflow","auto"),i.style.setProperty("background","#ffffff"),i.style.setProperty("border-radius","13"),i.style.setProperty("padding","10px 19px"),o(u,r(h,{get when(){return ae(()=>!!(e?.invoice&&e?.store&&e?.type))()&&p()?.length>0},get children(){return r(W,{color:"#047db7ff",icon:"save",label:"Salvar",handleClick:Y})}})),a.style.setProperty("padding","16px"),o(a,r($e,{get init(){return e?.createDate},label:"Fecha",updDate:t=>c("createDate",t)}),v),o(v,r(E,{list:[{id:"SALES",label:"VENTAS"},{id:"TRANSFER",label:"TRANSFERENCIAS"}],lbl_empty:"Tipo de Salida",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.type},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:t=>c("type",t.id),width:"260px"})),o(g,r(C,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",validations:{required:!0},index:1,get value(){return e?.invoice||""},placeholder:"Factura",colors:"#2b2b2b",handleClick:t=>c("invoice",t)})),o(R,r(E,{get list(){return H()},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",borderColor:"#b2b2b2",get value(){return e?.store},hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:t=>c("store",t.id),width:"360px"})),o(a,r(h,{get when(){return e?.type==="TRANSFER"},get children(){var t=P();return o(t,r(E,{get list(){return H()},lbl_empty:"Almacen Destino",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",borderColor:"#b2b2b2",get value(){return e?.storeTo},hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:m=>c("storeTo",m.id),width:"360px"})),t}}),w),o(w,r(C,{width:"460px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",index:2,get value(){return e?.description||""},placeholder:"Descripcion",colors:"#2b2b2b",handleClick:t=>c("description",t)})),o(L,r(C,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",index:3,get value(){return e?.hbl||""},placeholder:"Hbl",colors:"#2b2b2b",handleClick:t=>c("hbl",t)})),o(X,r(ke,{callback:G,lbl_empty:"Productos",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",borderColor:"#b2b2b2",get value(){return y()},hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:I,width:"360px"})),o(a,r(h,{get when(){return y()?.id},get children(){return[(()=>{var t=P();return o(t,r(C,{width:"130px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",type:"number",get value(){return e?.qty||""},placeholder:"Cantidad",validations:{required:!0},index:1,colors:"#2b2b2b",handleClick:m=>c("qty",m)})),t})(),r(h,{get when(){return e?.type==="SALES"},get children(){var t=P();return o(t,r(C,{width:"130px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",type:"number",get value(){return e?.salePrice||""},placeholder:"Precio de Venta",colors:"#2b2b2b",handleClick:m=>c("salePrice",m)})),t}}),r(h,{get when(){return e?.type==="SALES"&&e?.salePrice&&e?.qty||e?.type!=="SALES"&&e?.qty},get children(){var t=me();return o(t,r(W,{color:"#041e49ff",icon:"plus",label:"Agregar",handleClick:K})),t}})]}}),null),o(l,r(h,{get when(){return p()},get children(){return r(ne,{get each(){return p()},children:(t,m)=>(()=>{var x=Ce(),O=x.firstChild,Z=O.firstChild,D=O.nextSibling,ee=D.firstChild,te=ee.nextSibling,re=te.firstChild,$=D.nextSibling;return o(Z,()=>t?.product?.label),o(x,r(j,{}),D),o(re,()=>(t?.qty*1).toFixed(2)),o(x,r(j,{}),$),o(x,r(h,{get when(){return t?.salePrice},get children(){var V=xe(),oe=V.firstChild,ie=oe.nextSibling,B=ie.firstChild;return B.firstChild,o(B,()=>(t?.salePrice*1).toFixed(2),null),V}}),$),$.$$click=J,o($,r(Se,{name:"outline_delete",size:24})),x})()})}}),null),se(t=>(t=de()?"96vw":"920px")!=null?i.style.setProperty("width",t):i.style.removeProperty("width")),i})()}const T=async b=>{let e={ssg_inventory_key:q(),createDate:new Date().getTime(),businessId:N?.profile?.businessYId};e={...b,...e};let n={params:{businessId:N?.profile?.businessYId},form:e},F=pe(139003);n={...n,...F};const k=await ue(n);return k?.data?.error?{}:k?.data};ce(["click"]);export{Le as default};
