import{P as L,f as S,r as b}from"./fontkit.es-DEjOtITv.js";import"./qrcode-C5vWJp7P.js";import{i as v,t as s}from"./InitPrintServices-2OOIWYuu.js";import{OpenToast as _}from"./Toast-8yH8rEbJ.js";import{g as B}from"./Util-uEfv1z7O.js";const M=o=>{let i=window?.DATAMatrix;return i?i({msg:o,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1}):null},C=o=>{let n=o.cloneNode(!0).outerHTML,t=new Blob([n],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(t)},D=async(o,i)=>{const n=document.createElement("img");document.body.appendChild(n),n.onload=function(){const t=document.createElement("canvas");t.width=n.clientWidth,t.height=n.clientHeight,t.getContext("2d").drawImage(n,0,0);const w=t.toDataURL("image/png");document.body.removeChild(n),i(w)},n.src=o},j=o=>new Promise(async(i,n)=>{let t=M(o),e=t&&C(t);e&&D(e,async w=>{var d=await I(w,"image/png");let a=URL.createObjectURL(d);i(a)})}),I=async(o,i)=>{let t=await(await fetch(o)).blob();return t=t.slice(0,t.size,i),t},H=o=>{window.navigator.clipboard.writeText(o),_({text:o+"  copiado",timeout:1500,id:B()})};function P(o){let i=new Blob([o],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(i)}const z=(o,i,n)=>{const t=i.widthOfTextAtSize(o,40),e=i.widthOfTextAtSize(o,10);return Math.floor(n/((t-e)/30))},W=async(o,i,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t);let w=265;const d=o.map(async(a,u)=>{const r=t.addPage([426,284]),{height:f}=r.getSize();let c=f-34;const x=await fetch(a?.qr).then(l=>l.arrayBuffer()),h=await t.embedPng(x);r&&h&&r.drawImage(h,{x:10,y:f-220,width:150,height:150});let g=z(s(a?.state),e.roboto_bold,w);g>42&&(g=42,c=c-6);let y=s(a?.bulto).trim();const A=e.Lexend_700?.widthOfTextAtSize(s(y),40);if(n)a?.state&&r.drawText(s(a?.state),{x:5,y:c-6,size:g,font:e.roboto_bold,color:b(0,0,0)}),r.drawText(s(y),{x:18,y:f-270,size:40,font:e.GSansBold,color:b(0,0,0)});else{let l=z(s(a?.name),e.GSansItalic,w);var T=e.GSansItalic?.widthOfTextAtSize(s(a?.name),l);if(T>w&&(l=l-1,T=e.GSansItalic?.widthOfTextAtSize(s(a?.name),l)),l=300/T*21,l=l>25?25:l,r.drawText(s(a?.name),{x:10,y:c-0,size:l,font:e.GSansItalic,color:b(0,0,0)}),a?.state){const R=e.roboto_bold?.widthOfTextAtSize(s(a?.state),g);r.drawText(s(a?.state),{x:420-R,y:c-46,size:g,font:e.roboto_bold,color:b(0,0,0)}),c=c-l}let p=29;const O=e.Lexend_700?.widthOfTextAtSize(s(a?.phoneNumber),p);r.drawText(s(a?.phoneNumber),{x:400-O,y:c-70,size:p,font:e.Lexend_700,color:b(0,0,0)});const U=e.Lexend_700?.widthOfTextAtSize(s(a?.altPhoneNumber),p);r.drawText(s(a?.altPhoneNumber),{x:400-U,y:c-105,size:p,font:e.Lexend_700,color:b(0,0,0)}),r.drawText(s(y),{x:418-A,y:c-205,size:40,font:e.GSansBold,color:b(0,0,0)})}});await Promise.all(d);{const a=await t.save();return P(a)}},Y=async(o,i,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t),w=o.map(async(d,a)=>{let u=2.795;const r=t.addPage([45*u,24*u]),{height:f}=r.getSize(),c=await fetch(d?.mtrx).then(m=>m.arrayBuffer()),x=await t.embedPng(c),h=await fetch(d?.mtrx2).then(m=>m.arrayBuffer()),g=await t.embedPng(h);r&&x&&r.drawImage(x,{x:0,y:f-32,width:30,height:30}),r.drawText(s(d?.lbl),{x:33,y:f-20,size:13,font:e.Lexend_700,color:b(0,0,0)}),r&&g&&r.drawImage(g,{x:0,y:f-66,width:30,height:30}),r.drawText(s(d?.lbl2),{x:33,y:f-56,size:13,font:e.Lexend_700,color:b(0,0,0)})});await Promise.all(w);{const d=await t.save();return P(d)}};export{W as S,H as c,j as g,Y as l};
