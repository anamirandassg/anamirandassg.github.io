import{P as L,f as S,r as b}from"./fontkit.es-CBHpcS9v.js";import"./qrcode-C5vWJp7P.js";import{i as v,t as r}from"./InitPrintServices-DU5yUVJr.js";import{OpenToast as U}from"./Toast-DJDCnWgx.js";import{j as B}from"./index-Da7N5RNO.js";const C=o=>{let i=window.DATAMatrix;return i({msg:o,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1})},D=o=>{let n=o.cloneNode(!0).outerHTML,t=new Blob([n],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(t)},I=async(o,i)=>{const n=document.createElement("img");document.body.appendChild(n),n.onload=function(){const t=document.createElement("canvas");t.width=n.clientWidth,t.height=n.clientHeight,t.getContext("2d").drawImage(n,0,0);const w=t.toDataURL("image/png");document.body.removeChild(n),i(w)},n.src=o},j=o=>new Promise(async(i,n)=>{let t=C(o),e=D(t);I(e,async w=>{var d=await _(w,"image/png");let a=URL.createObjectURL(d);i(a)})}),_=async(o,i)=>{let t=await(await fetch(o)).blob();return t=t.slice(0,t.size,i),t},q=o=>{window.navigator.clipboard.writeText(o),U({text:o+"  copiado",timeout:1500,id:B()})};function P(o){let i=new Blob([o],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(i)}const z=(o,i,n)=>{const t=i.widthOfTextAtSize(o,40),e=i.widthOfTextAtSize(o,10);return Math.floor(n/((t-e)/30))},E=async(o,i,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t);let w=265;const d=o.map(async(a,g)=>{const s=t.addPage([426,284]),{height:x}=s.getSize();let c=x-34;const h=await fetch(a?.qr).then(y=>y.arrayBuffer()),m=await t.embedPng(h);s&&m&&s.drawImage(m,{x:10,y:x-220,width:150,height:150}),a?.tracking?.length<14&&s.drawText(r(a?.tracking),{x:172,y:c-175,size:36,font:e.roboto_bold,color:b(0,0,0)});let f=z(r(a?.state),e.roboto_bold,w);f>42&&(f=42,c=c-6);let l=z(r(a?.name),e.GSansItalic,w);var u=e.GSansItalic?.widthOfTextAtSize(r(a?.name),l);if(u>w&&(l=l-1,u=e.GSansItalic?.widthOfTextAtSize(r(a?.name),l)),l=300/u*21,l=l>25?25:l,s.drawText(r(a?.name),{x:10,y:c-0,size:l,font:e.GSansItalic,color:b(0,0,0)}),a?.state){const y=e.roboto_bold?.widthOfTextAtSize(r(a?.state),f);s.drawText(r(a?.state),{x:420-y,y:c-46,size:f,font:e.roboto_bold,color:b(0,0,0)}),c=c-l}let p=29;const A=e.Lexend_700?.widthOfTextAtSize(r(a?.phoneNumber),p);s.drawText(r(a?.phoneNumber),{x:400-A,y:c-70,size:p,font:e.Lexend_700,color:b(0,0,0)});const O=e.Lexend_700?.widthOfTextAtSize(r(a?.altPhoneNumber),p);s.drawText(r(a?.altPhoneNumber),{x:400-O,y:c-105,size:p,font:e.Lexend_700,color:b(0,0,0)});let T=r(a?.bulto).trim();const R=e.Lexend_700?.widthOfTextAtSize(r(T),40);s.drawText(r(T),{x:418-R,y:c-205,size:40,font:e.GSansBold,color:b(0,0,0)})});await Promise.all(d);{const a=await t.save();return P(a)}},Q=async(o,i,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t),w=o.map(async(d,a)=>{const g=t.addPage([142,71]),{height:s}=g.getSize();if(d?.qr){const h=await fetch(d?.qr).then(f=>f.arrayBuffer()),m=await t.embedPng(h);m&&g.drawImage(m,{x:45,y:s-65,width:96,height:15})}const x=await fetch(d?.mtrx).then(h=>h.arrayBuffer()),c=await t.embedPng(x);g&&c&&g.drawImage(c,{x:0,y:s-65,width:60,height:60}),g.drawText(r(d?.lbl),{x:60,y:s-37,size:13,font:e.Lexend_700,color:b(0,0,0)})});await Promise.all(w);{const d=await t.save();return P(d)}};export{E as S,q as c,j as g,Q as l};
