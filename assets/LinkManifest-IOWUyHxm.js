const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-C7wCiJkP.js","assets/index-_Au11fjV.js","assets/index-D4QuRvi-.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-UYuD5oX9.js","assets/debounces-DRmn-3nm.js","assets/SVG-gl2VBkJF.js","assets/index-Ci0zXM0r.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-EBG3H7Qk.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-BbdcA4tX.js","assets/Util-dbxHFpkD.js","assets/DialogHRM-CrEu5ACj.js","assets/DialogHRM-V9_lZntj.css","assets/globalSignal-B8iPyfuq.js","assets/manifestList-CSHEgbpJ.js","assets/fontkit.es-DEjOtITv.js","assets/InitPrintServices-BI_Od3nu.js"])))=>i.map(i=>d[i]);
import{l as P,_ as E,c as B,a as ge,u as _e,C as be,o as he,h as fe,m as pe,b as me,i as o,d as g,f as oe,e as ve,t as C,z as X,S as j,D as ye,q as xe,F as ke,E as we,s as Se}from"./index-_Au11fjV.js";import{w as $e,p as Ae,m as Ce}from"./manifestList-CSHEgbpJ.js";import{f as z,O as w,h as De,g as ce,p as Le}from"./Util-dbxHFpkD.js";import{u as Oe}from"./debounces-DRmn-3nm.js";import{i as Z}from"./globalSignal-B8iPyfuq.js";import{P as Me,f as Be,r as k}from"./fontkit.es-DEjOtITv.js";import{i as Pe,t as m,b as Ee}from"./InitPrintServices-BI_Od3nu.js";import"./index-Ci0zXM0r.js";const ze=(s,l,e)=>{const a=l.widthOfTextAtSize(s,40),n=l.widthOfTextAtSize(s,10);return Math.floor(e/((a-n)/30))},Te=async(s,l,e)=>{const a=await Me.create();a.registerFontkit(Be);const n=await Pe(a);let h=265,u=30,S=Math.ceil(s.length/u);Array.from(Array(S).keys()).map($=>{let V=s.slice($*u,($+1)*u);const p=a.addPage(),{height:D}=p.getSize();let T=D-74;V.map((b,I)=>{let c=T;I%2&&p?.drawRectangle({x:10,y:c-15,width:580,height:24,color:k(.7,.7,.7)});let K=ze(m(b?.state),n.roboto_bold,h),G=0;K>42&&(K=42,c=c-6);let q=b?.bagnumber;const H=n.Lexend_700.widthOfTextAtSize(m(q),5);p.drawText(m(q),{x:575-H,y:c-3,size:5,font:n.Lexend_700,color:k(0,0,0)});let F=b?.consigneeInfo?.ybcity+" | "+b?.consigneeInfo?.ybestate;const Q=n.Lexend_700.widthOfTextAtSize(m(F),7);b?.cidentity&&p.drawText(m(b?.cidentity),{x:25,y:c+3,size:7,font:n.Lexend_700,color:k(0,0,0)}),b?.consigneeInfo?.ybestate&&p.drawText(m(F),{x:575-Q,y:c+3,size:7,font:n.Lexend_700,color:k(0,0,0)});let t="";b?.hbls.map((i,_)=>{t+=(_>0?"  |  ":"")+i?.hbl}),p.drawText(m(t),{x:45,y:c-3,size:5,font:n.Lexend_700,color:k(0,0,0)}),G+=b?.pricePP*b?.totalWeight,T=c-18}),p.drawText("Guia: "+m(e?.guia),{x:17,y:D-22,size:12,font:n.Lexend_700,color:k(0,0,0)}),p.drawText("Fecha: "+m(e?.date),{x:19,y:D-35,size:10,font:n.Lexend_700,color:k(0,0,0)})});{const $=await a.save();return Ee($)}};var Ie=C("<h5>"),qe=C("<div style=padding:4px>"),Fe=C('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div><div class="icon align_itm"></div></div><div><div class="icon align_itm">'),Ne=C('<div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5><h4></h4><h4></h4></div></div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Re=C("<div> <!>."),We=C("<div> ");const je=P(()=>E(()=>import("./LoadingColorSpinner-C7wCiJkP.js"),__vite__mapDeps([0,1,2,3]))),de=P(()=>E(()=>import("./DropDwnSearch-UYuD5oX9.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),Ye=P(()=>E(()=>import("./InputHr-EBG3H7Qk.js"),__vite__mapDeps([9,1,2,10]))),ee=P(()=>E(()=>import("./SVG-gl2VBkJF.js"),__vite__mapDeps([6,1,2,7]))),Ve=P(()=>E(()=>import("./ItemOnManifestList-BbdcA4tX.js"),__vite__mapDeps([11,1,2,12,7,5,13,14,15,16,17,18]))),[M,Y]=B({list:{}}),[at,nt]=ge("");function lt(){const[s,l]=_e(),[e,a]=B({search:""}),[n,h]=B(),[u,S]=B(),$=be(),[V,p]=B(),[D,T]=ge(""),b=Oe(T,400),I=(t,i)=>{a({[t]:i}),b(ce())};he(()=>{Y("list",void 0)}),fe(()=>{}),pe(async()=>{let t=[];[46,40,41,42,50,52,54,56].map(d=>{let v=$e?.[d];X?.roles?.[v?.id]?.isActive&&t.push(v)}),p("list",t);let _=[];if(Ae.map(d=>{let f=d.label;X?.roles?.[f]?.isActive&&_.push(d)}),p("prov",_),s?.mId){let d={id:s?.mId},f=await Qe(d);a("province",f?.province),a("city",f?.city),a("manifestObj",f),S("linked",f?.linkedBags)}});const[c,{refetch:K}]=me(D,async t=>{let i=e?.manifest?.id,_=e?.province,d=_&&e?.city,f=e?.warehouse?.id,v=[];if(i){const x=await Ke(e.search,i,_,d,f);h("bags",x),w(x).map(N=>{let R=x[N],A=R.currentStatus;X?.roles?.[A]?.isActive&&A.split("_")?.[1]>=33&&v.push(R)})}return v}),G=(t,i)=>{a({[t]:i}),b(ce()),Y("list",void 0),setTimeout(()=>{Y("list",{})},670)},q=()=>{let t={},i=0;w(M?.list)?.length!==c()?.length?(i=1,c().map(_=>{let d=_.ssg_track_key;t[d]=i})):c().map(_=>{let d=_.ssg_track_key;t[d]=void 0}),Y("list",t)},H=async()=>{let t={...u?.linked};w(M?.list).map(i=>{t?.[i]||(t[i]={idairguide:n?.bags?.[i]?.idairguide})}),S("linked",t),await Ge({ssg_manifest_key:s?.mId},{linkedBags:t}),$("/manifest",{replace:!0})},F=()=>{let t=[];w(M?.list).map(i=>{n?.bags?.[i]&&t.push(n?.bags?.[i])}),Q(t)},Q=async t=>{let i=await Te(t,!0,{guia:t[0]?.idairnumber,date:Le()});window.open(i)};return(()=>{var t=Ne(),i=t.firstChild,_=i.firstChild,d=_.firstChild,f=d.nextSibling,v=f.nextSibling,x=i.nextSibling,N=x.firstChild,R=N.nextSibling,A=x.nextSibling;return o(d,()=>e?.manifestObj?.ssg_manifest_key),o(f,()=>e?.manifestObj?.name),o(_,g(j,{get when(){return e?.manifestObj?.city},get children(){return["|",(()=>{var r=Ie();return o(r,()=>e?.manifestObj?.city),r})()]}}),v),o(v,()=>e?.manifestObj?.province),o(N,g(de,{list:Ce,lbl_empty:"Guia",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>G("manifest",r),width:"260px"})),o(R,g(de,{get list(){return V?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>I("warehouse",r),width:"260px"})),o(x,g(j,{get when(){return e?.manifest?.id},get children(){var r=qe();return o(r,g(Ye,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return e?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:y=>I("search",y)})),r}}),null),o(A,g(j,{get when(){return ye(()=>!!e?.manifest?.id)()&&c().length>0},get children(){var r=Fe(),y=r.firstChild,W=y.firstChild,L=y.nextSibling,U=L.firstChild,te=U.firstChild,re=te.nextSibling;re.nextSibling;var ue=L.nextSibling,J=ue.nextSibling,ie=J.firstChild,se=J.nextSibling,ae=se.firstChild;return r.style.setProperty("margin","18px 0"),W.$$click=q,o(W,g(ee,{get name(){return w(M?.list)?.length<c()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),o(U,()=>w(M?.list)?.length,te),o(U,()=>c()?.length,re),ie.$$click=H,o(ie,g(ee,{name:"link",color:"var(--background-red-ssg)"})),ae.$$click=F,o(ae,g(ee,{name:"printer",color:"var(--background-red-ssg)"})),oe(O=>{var ne=` ${Z()?"tr_bar_15":"tr_bar_05"} tr_bar  align_itm centerBx"`,le=` ${Z()?"tr_bar_10":"tr_bar_05"} tr_bar  align_itm centerBx"`;return ne!==O.e&&(J.className=O.e=ne),le!==O.t&&(se.className=O.t=le),O},{e:void 0,t:void 0}),r}}),null),o(A,g(we,{fallback:r=>(()=>{var y=Re(),W=y.firstChild,L=W.nextSibling;return L.nextSibling,o(y,()=>r.toString(),L),y})(),get children(){return g(xe,{get fallback(){return(()=>{var r=We();return r.firstChild,o(r,g(je,{stroke:"rgb(200 25 60 / 1)",size:62}),null),r})()},get children(){return g(j,{get when(){return c()},get children(){return g(ke,{get each(){return c()},children:r=>g(Ve,{item:r,get isAlready(){return u?.linked?.[r.ssg_track_key]}})})}})}})}}),null),oe(r=>Se(A,` ${Z(),"width:86vw;"} margin: 0 auto;`,r)),t})()}const Ke=async(s,l,e,a,n)=>{let h={params:{idairguide:l,":store":n},query:"getScanLogisticYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5 AND currentStatus = :store AND estate = :estate AND city = :city"};if(s&&s.split(" ").map((u,S)=>{u&&(h.params[":search"+S]=u.trim())}),e&&(h.params[":estate"]=e),a&&(h.params[":city"]=a),console.log(h),l&&n){const u=await z(h);return console.log(u),u?.error?{}:u}else return{}},Ge=async(s,l)=>{const a=await z({params:s,query:"updateManifestYabaExpress",data2update:l}),n=w(l?.linkedBags).map(async(h,u)=>{await He({ssg_track_key:h,idairguide:l?.linkedBags?.[h]?.idairguide},{currentManifestKey:s?.ssg_manifest_key})});return await Promise.all(n),a},He=async(s,l)=>await z({params:s,query:"updateLogisticYabaExpress",data2update:l}),Qe=async s=>await z({params:s,query:"getManifestOrderByKeyID"}),ot=async s=>{let l=[];s.map(e=>{let a={params:{id:e?.ssg_track_key,idairguide:e?.idairguide},query:"getLogisticOrderByKeyID"};l.push(a)}),De(l,Ue)},Ue=async s=>{const e=await z(s);if(e)return e};ve(["click"]);export{lt as default,Ue as fetchCSVInve,ot as loadManifest,at as manifestObs,M as selectedManifest,nt as setManifestObs,Y as setSelectedManifest,Ge as updLinkedBags};
