import{P as v,f as O,r as d}from"./fontkit.es-BMtOEA4d.js";import{q as V}from"./qrcode-DHy8FFhS.js";import{i as I,t as n}from"./InitPrintServices-8TC3R4m4.js";import{OpenToast as X}from"./Toast-BHMrqVn0.js";import{v as tt,k as A,O as B}from"./index-B0vjCw4c.js";const et=s=>{let c=window?.DATAMatrix;return c?c({msg:s,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1}):null},at=s=>{let w=s.cloneNode(!0).outerHTML,e=new Blob([w],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(e)},ot=async(s,c)=>{const w=document.createElement("img");document.body.appendChild(w),w.onload=function(){const e=document.createElement("canvas");e.width=w.clientWidth,e.height=w.clientHeight,e.getContext("2d").drawImage(w,0,0);const g=e.toDataURL("image/png");document.body.removeChild(w),c(g)},w.src=s},wt=s=>new Promise(async(c,w)=>{let e=et(s),t=e&&at(e);console.log(e),console.log(t),t&&ot(t,async g=>{var h=await nt(g,"image/png");let a=URL.createObjectURL(h);c(a)})}),gt=s=>new V.QRCodeCanvas(s+"").toDataUrl(),nt=async(s,c)=>{let e=await(await fetch(s)).blob();return e=e.slice(0,e.size,c),e},ft=s=>{window.navigator.clipboard.writeText(s),X({text:s+"  copiado",timeout:1500,id:tt()})};function R(s){let c=new Blob([s],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(c)}const D=(s,c,w)=>{const e=c.widthOfTextAtSize(s,40),t=c.widthOfTextAtSize(s,10);return Math.floor(w/((e-t)/30))},bt=async(s,c,w)=>{const e=await v.create();e.registerFontkit(O);const t=await I(e);let g=265;const h=s.map(async(a,u)=>{const o=e.addPage([426,284]),{height:f}=o.getSize();let r=f-34;const z=await fetch(a?.qr).then(i=>i.arrayBuffer()),_=await e.embedPng(z);o&&_&&o.drawImage(_,{x:10,y:f-220,width:150,height:150});let y=D(n(a?.state),t.roboto_bold,g);y>42&&(y=42,r=r-6);let S=n(a?.bulto).trim();const T=t.Lexend_700?.widthOfTextAtSize(n(S),33);if(a?.isSSG){a?.state&&o.drawText(n(a?.state),{x:5,y:r-6,size:y,font:t.roboto_bold,color:d(0,0,0)}),o.drawText(n(S),{x:18,y:f-270,size:40,font:t.GSansBold,color:d(0,0,0)});const i=await fetch(A("SSG-black.png")).then(l=>l.arrayBuffer()),p=await e.embedPng(i);if(o&&p&&o.drawImage(p,{x:210,y:f-232,width:190,height:190}),a?.lbss){const l=t.Lexend_700?.widthOfTextAtSize("LBS: "+n(a?.lbss?.toFixed(2)),32);o.drawText("LBS: "+n(a?.lbss?.toFixed(2)),{x:418-l,y:r-8,size:32,font:t.Lexend_700,color:d(0,0,0)})}}else{let i=D(n(a?.name),t.GSansItalic,g);var m=t.GSansItalic?.widthOfTextAtSize(n(a?.name),i);if(m>g&&(i=i-1,m=t.GSansItalic?.widthOfTextAtSize(n(a?.name),i)),i=300/m*21,i=i>25?25:i*1,o.drawText(n(a?.name),{x:10,y:r-0,size:i,font:t.GSansItalic,color:d(0,0,0)}),a?.state){const F=t.roboto_bold?.widthOfTextAtSize(n(a?.state),y);o.drawText(n(a?.state),{x:420-F,y:r-46,size:y,font:t.roboto_bold,color:d(0,0,0)}),r=r-i}let p=29;const l=t.Lexend_700?.widthOfTextAtSize(n(a?.phoneNumber),p);o.drawText(n(a?.phoneNumber),{x:400-l,y:r-70,size:p,font:t.Lexend_700,color:d(0,0,0)});const C=t.Lexend_700?.widthOfTextAtSize(n(a?.altPhoneNumber),p);if(o.drawText(n(a?.altPhoneNumber),{x:400-C,y:r-105,size:p,font:t.Lexend_700,color:d(0,0,0)}),a?.lbss){const F=t.Lexend_700?.widthOfTextAtSize("LBS: "+n(a?.lbss?.toFixed(2)),32);o.drawText("LBS: "+n(a?.lbss?.toFixed(2)),{x:418-F,y:r-155,size:32,font:t.Lexend_700,color:d(0,0,0)})}o.drawText(n(S),{x:418-T,y:r-160,size:33,font:t.GSansBold,color:d(0,0,0)}),o.drawText(n(a?.street),{x:2,y:r-189,size:12,font:t.GSansBold,color:d(0,0,0)}),o.drawText(n(a?.city),{x:2,y:r-209,size:12,font:t.GSansBold,color:d(0,0,0)})}});await Promise.all(h);{const a=await e.save();return R(a)}},xt=async(s,c,w)=>{const e=await v.create();e.registerFontkit(O);const t=await I(e),g=s.map(async(h,a)=>{const u=e.addPage([142,71]),{height:o}=u.getSize();if(h?.qr){const _=await fetch(h?.qr).then(y=>y.arrayBuffer())&&await e.embedPng(h?.qr);_&&u.drawImage(_,{x:45,y:o-65,width:96,height:15})}const f=await fetch(h?.mtrx).then(z=>z.arrayBuffer()),r=await e.embedPng(f);u&&r&&u.drawImage(r,{x:0,y:o-65,width:60,height:60}),u.drawText(n(h?.lbl),{x:60,y:o-37,size:13,font:t.Lexend_700,color:d(0,0,0)})});await Promise.all(g);{const h=await e.save();return R(h)}},pt=async(s,c,w)=>{const e=await v.create();e.registerFontkit(O);const t=await I(e),g=s.map(async(h,a)=>{let u=2.795;const o=e.addPage([45*u,24*u]),{height:f}=o.getSize(),r=await fetch(h?.mtrx).then(x=>x.arrayBuffer()),z=await e.embedPng(r),_=await fetch(h?.mtrx2).then(x=>x.arrayBuffer()),y=await e.embedPng(_);o&&z&&o.drawImage(z,{x:0,y:f-32,width:30,height:30}),o.drawText(n(h?.lbl),{x:33,y:f-20,size:13,font:t.Lexend_700,color:d(0,0,0)}),o&&y&&o.drawImage(y,{x:0,y:f-66,width:30,height:30}),o.drawText(n(h?.lbl2),{x:33,y:f-56,size:13,font:t.Lexend_700,color:d(0,0,0)})});await Promise.all(g);{const h=await e.save();return R(h)}},ut=async(s,c,w)=>{const e=await v.create();e.registerFontkit(O);const t=await I(e);let g=265;const h=s.map(async(a,u)=>{const o=e.addPage([426,284]),{height:f}=o.getSize();let r=f-34,z=D(n(a?.state),t.roboto_bold,g);z>42&&(z=42,r=r-6);let y=n(a?.bulto).trim();o.drawText("("+a?.currency+") $"+(n(a?.amount)*1).toFixed(2),{x:10,y:f-260,size:45,font:t.Lexend_700,color:d(0,0,0)});let x=D(n(a?.name),t.GSansItalic,g);var S=t.GSansItalic?.widthOfTextAtSize(n(a?.name),x);S>g&&(x=x-1,S=t.GSansItalic?.widthOfTextAtSize(n(a?.name),x)),x=300/S*21,x=x>25?25:x,o.drawText(n(a?.name),{x:10,y:r-0,size:x,font:t.GSansItalic,color:d(0,0,0)});let T=29;if(a?.state){let p="CID: "+a?.state;const l=t.roboto_bold?.widthOfTextAtSize(n(p),T);o.drawText(n(p),{x:410-l,y:r-46,size:T,font:t.roboto_bold,color:d(0,0,0)}),r=r-T}let m=29;const i=t.Lexend_700?.widthOfTextAtSize(n(a?.phoneNumber),m);o.drawText(n(a?.phoneNumber),{x:400-i,y:r-60,size:m,font:t.Lexend_700,color:d(0,0,0)}),o.drawText(n(y),{x:10,y:r-95,size:10,font:t.GSansBold,color:d(0,0,0)}),o.drawText(n(a?.rpto),{x:10,y:r-115,size:12,font:t.Lexend_700,color:d(0,0,0)}),o.drawText(n(a?.city),{x:10,y:r-135,size:15,font:t.roboto_bold,color:d(0,0,0)})});await Promise.all(h);{const a=await e.save();return R(a)}},U=(s,c)=>c?" "+s+" "+c:"",st=s=>`${U("Calle",s?.streetName)}${U("#",s?.streetNo)}${U("E/",s?.betwen)}`,yt=async(s,c,w)=>{const e=await v.create();e.registerFontkit(O);const t=await I(e),g=await fetch(A("icon_cellphone")).then(i=>i.arrayBuffer()),h=await e.embedPng(g),a=await fetch(A("icon_receipt")).then(i=>i.arrayBuffer()),u=await e.embedPng(a),o=await fetch(A("icon_home")).then(i=>i.arrayBuffer()),f=await e.embedPng(o),r=await fetch(A("icon_open_package_file_outline")).then(i=>i.arrayBuffer()),z=await e.embedPng(r),_=await fetch(A("icon_user")).then(i=>i.arrayBuffer()),y=await e.embedPng(_);let x=50,S=0,T={0:[]},m=15;s.map(i=>{let p=15,l=c[i];p+=B(l?.customers).length*(m+4),B(l?.customers).map(C=>{p+=B(l?.customers?.[C]?.bagsNumb).length*(m+1)}),p+=m+2,x+p>940&&(S+=1,T[S]||(x=50,T[S]=[])),x+=p,l.height=p,T[S].push(l)}),B(T).map((i,p)=>{const l=e.addPage(),{height:C,width:F}=l.getSize();let b=C-34;T[i].map(async(L,E)=>{b-L.height,E%2&&l?.drawRectangle({x:5,y:b-(L.height-24),width:585,height:L.height-10,color:d(.895,.895,.895)});const Y=(N,k)=>N?k+N:"";let j=st(L?.address)+Y(L?.rpto,", Rpto ")+" |  "+n(L?.city)+"  |  "+n(L?.estate);l.drawText(""+j.toUpperCase(),{x:24,y:b,size:7,font:t.roboto_bold,color:d(0,0,0)}),f&&l.drawImage(f,{x:10,y:b-3,width:12,height:12}),b=b-m,B(L?.customers).map((N,k)=>{let P=L?.customers[N],M="Recibe:     "+P?.phoneNumber+"       "+N+" | "+P?.name+": ";var q=t.Lexend_700?.widthOfTextAtSize("Recibe: ",8.5),W=t.Lexend_700?.widthOfTextAtSize(M,8.5);l?.drawRectangle({x:24+W,y:b-1,width:560-W,height:.21,border:d(.895,.895,.895)}),l.drawText(""+M,{x:23,y:b,size:8.5,font:t.Lexend_700,color:d(0,0,0)}),h&&l.drawImage(h,{x:q+23,y:b-2.5,width:10,height:10});let H="     "+P?.phoneNumber;var $=t.Lexend_700?.widthOfTextAtSize(H,8.5);y&&l.drawImage(y,{x:q+23+$,y:b-2.5,width:10,height:10}),b=b-(m+2),B(P?.bagsNumb).map(Q=>{let G="HBLS: ";P?.bagsNumb?.[Q]?.hbls.map(J=>{G+=J?.hbl+"; "});let Z=G+"         Bolso: "+P?.bagsNumb?.[Q]?.bagnumber;u&&l.drawImage(u,{x:27,y:b-2,width:9,height:9}),l.drawText(""+Z,{x:39,y:b,size:8,font:t.roboto_bold,color:d(0,0,0)});var K=t.roboto_bold?.widthOfTextAtSize(G+"  ",8);z&&l.drawImage(z,{x:K+39,y:b-2,width:9,height:9}),b=b-m}),b=b-m})})});{const i=await e.save();return R(i)}},mt=async s=>{const c=await v.create();c.registerFontkit(O);const w=await I(c),e=s.map(async(g,h)=>{const a=c.addPage([142,71]),{height:u}=a.getSize();if(g?.qr)try{const o=await fetch(g?.qr).then(r=>r.arrayBuffer()),f=await c.embedPng(o);f&&a.drawImage(f,{x:5,y:u-45,width:35,height:35})}catch(o){console.log(o)}a.drawText(n(g?.lbl),{x:50,y:u-27,size:9,font:w.Lexend_700,color:d(0,0,0)}),a.drawText(n(g?.lbl2),{x:4,y:u-62,size:7,font:w.Lexend_700,color:d(0,0,0)})});await Promise.all(e);const t=await c.save();return R(t)};export{ut as C,yt as P,bt as S,gt as a,nt as b,ft as c,mt as d,xt as e,wt as g,pt as l};
