const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-oly4o2jj.js","assets/index-Dc7YZiIm.js","assets/index-BRlA1Q7g.css","assets/Util-BYKUtUWx.js","assets/FlexSpace-DKFbJ5EV.js","assets/DropDwnSearch-BscVucwa.js","assets/debounces-CVw3Smgq.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-DIUysY5Z.js","assets/html5-qrcode-scanner-Cz8tGmrU.js","assets/Toast-Bj2qIk-8.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-CO2_jlmM.js","assets/DialogHRM-BYRPM6Pg.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-C4n2DDMM.js","assets/ShowQRPrintLabel-QV5HSli8.js","assets/fontkit.es-ChJNFk3u.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-oS5Dp5Wa.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-Dwpk5_t4.js","assets/LoadingColorSpinner-DThg_HEM.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import"./Toast-Bj2qIk-8.js";import{c as J,l as y,_ as S,a as A,b as oe,o as ce,d as de,i as o,e as l,P as M,f as w,z as ge,Q as ue,R as G,S as T,F as be,m as V,j as W,h as fe,t as v,T as pe,U as _e,O as ye,V as Se,W as Q,g as z,J as ve,A as H}from"./index-Dc7YZiIm.js";import{F as me,e as g,J as F,K as U,L as X,O as B,u as d,M as he,N as ke,P as Z,Q as Y,g as N,f as Le,G as ee,a as xe,R as De}from"./Util-BYKUtUWx.js";import{s as Ie}from"./App.module-CbHnVtRQ.js";var we=v('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Be=v('<div class="centerBx100 ">'),$e=v('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Ce=v('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Ee=v("<div class=loader>Loading..."),Oe=v('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Pe,Ae]=J(),E=y(()=>S(()=>import("./SVG-oly4o2jj.js"),__vite__mapDeps([0,1,2,3]))),Fe=y(()=>S(()=>import("./FlexSpace-DKFbJ5EV.js"),__vite__mapDeps([4,1,2]))),Re=y(()=>S(()=>import("./DropDwnSearch-BscVucwa.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),je=y(()=>S(()=>import("./ScanningCamera-DIUysY5Z.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),Ke=y(()=>S(()=>import("./ScanningManual-Dwpk5_t4.js"),__vite__mapDeps([22,1,2,3,13,14,10,11,20,21])));y(()=>S(()=>import("./LoadingColorSpinner-DThg_HEM.js"),__vite__mapDeps([23,1,2,24])));const[f,te]=A(""),[$,ae]=A([]);function Me(){J({});const[e,t]=A(1),[a,n]=pe(),s=c=>()=>n(()=>t(c));oe(()=>{L()}),ce(()=>{}),de(()=>{W()&&t(0),Ue(),ne(),loadOfflineDB()});function r(){return"geolocation"in navigator}function b(c){ye({latitude:c?.coords?.latitude,longitude:c?.coords?.longitude})}function L(){r()?navigator.geolocation.getCurrentPosition(b):showMessage("Geolocation isn't supported by your browser")}const R=()=>_e?.list?.filter(c=>c.id);return(()=>{var c=Ce(),re=c.firstChild,ie=re.nextSibling,j=ie.nextSibling,K=j.nextSibling;return o(j,l(Re,{get list(){return R()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return f()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:i=>te(i.id),width:"260px"})),o(K,l(T,{get when(){return f()},get children(){return[(()=>{var i=we(),m=i.firstChild,p=m.firstChild,x=p.firstChild,_=m.nextSibling,h=_.firstChild,D=h.firstChild;return M(m,"click",s(0),!0),o(x,l(E,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),M(_,"click",s(1),!0),o(D,l(E,{name:"keyboard",size:32,color:"#2b2b2b"})),w(u=>{var k=e()===0,I=e()===1;return k!==u.e&&m.classList.toggle("selected",u.e=k),I!==u.t&&_.classList.toggle("selected",u.t=I),u},{e:void 0,t:void 0}),i})(),(()=>{var i=Be();return o(i,l(ge,{get fallback(){return Ee()},get children(){return l(ue,{get children(){return[l(G,{get when(){return e()===0},get children(){return l(je,{get status(){return f()},get locat(){return f()}})}}),l(G,{get when(){return e()===1},get children(){return l(Ke,{get status(){return f()},get locat(){return f()}})}})]}})}})),w(()=>i.classList.toggle("pending",!!a())),i})()]}}),null),o(K,l(T,{get when(){return $()?.length>0},get children(){return[$e(),l(be,{get each(){return me($(),"timeStamp",0)},children:(i,m)=>(()=>{var p=Oe(),x=p.firstChild,_=x.firstChild,h=_.nextSibling,D=h.nextSibling,u=x.nextSibling,k=u.firstChild,I=k.nextSibling,le=I.nextSibling;return o(_,l(E,{get name(){return g("M023009")?.statusListIcons?.[i?.currentStatus]},size:32})),h.style.setProperty("padding","8px"),o(h,()=>i?.idairguide),D.style.setProperty("padding","8px"),o(D,()=>i?.tracking),o(p,l(Fe,{}),u),o(k,()=>i?.city),o(le,()=>i?.consigneeInfo?.ybestate),w(()=>V(p,`client_item_box gWXAaj jlytmu manifest  ${W()?"isMobile":"centerBx"}`)),p})()})]}}),null),w(()=>V(c,Ie.App)),c})()}fe(["click"]);const nt=Object.freeze(Object.defineProperty({__proto__:null,default:Me,scannedQRs:Pe,setScannedQRs:Ae,setStatus:te,setTaskScan:ae,status:f,taskScan:$},Symbol.toStringTag,{value:"Module"}));let Ge=[400,300,400,300,400],O=[300,80,300,80,300,80,300];const Te=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let a=e.split("/")?.[0];return a.indexOf("230")>=0&&(a="230"+(a.split("230")?.[1]).slice(0,6)),a.indexOf("231")>=0&&(a="231"+(a.split("231")?.[1]).slice(0,5)),{params:{":search0":a},code:1}},st=async(e,t)=>{let a=Te(e),n={timeStamp:new Date().getTime(),latitude:Q?.latitude,longitude:Q?.longitude,statusId:t,userId:z?.profile?.userId,userName:z?.profile?.name};if(t&&a?.params)return await Ve(a.params,n);{let s=a?.txt||a?.params?.[":search0"];return navigator.vibrate(O),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:s}}}}}},Ve=async(e,t)=>{let a=null;if(ve()){ze();let n=g("manifestByHbls")?.[e?.[":search0"]],s=g("manifestByKeys")?.[n];if(!s){let r={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(O),{error:{alert:"error",color:"rgb(200 25 60)",scanData:r}}}a=We(s,t)}else a=await Qe(e,t);if(a?.code===203||a?.code===303)return navigator.vibrate(Ge),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let n={...a.data};return n.tracking=e?.[":search0"],n.timeStamp=new Date().getTime(),ae([...$(),n]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let n={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(O),{error:{alert:"error",color:"rgb(200 25 60)",scanData:n}}}},We=(e,t)=>{let a={currentStatus:t?.statusId};if(e?.isSSG&&H?.roles?.SSG?.isActive,!H?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};if(g("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let n={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},s={...t};s.ssg_track_key=e?.ssg_track_key,s.ssg_scan_key=De();let r={form:s,itmN:n,params:{airguide:e?.guia},actionKey:815005};qe(r);let b={...s};Je(b);let L={...g("ScannedLocByKey")};return L[e?.ssg_track_key]=s,d("ScannedLocByKey",L),{code:200,data:{...n,...a}}},Qe=async(e,t)=>{let a={params:e,form:t},n=N(802001);return n=N(802008),a={...a,...n},(await Le(a))?.data};let q=null;const ze=()=>{q||(q=setInterval(()=>{Ne(),He()},750))},rt=()=>{C=new Date().getTime()};let C=0;const He=()=>{C+1250<new Date().getTime()&&(C=99999999999990,ee(X,U,g("dbScannedStore")))};let P=0;const Ne=()=>{P+1250<new Date().getTime()&&(P=99999999999990,ee(Y,Z,g("ScannedLocList")))},qe=async e=>{C=new Date().getTime();let t={...g("dbScannedStore")};t[xe()]=e,d("dbScannedStore",t)},Je=async e=>{P=new Date().getTime();let t={...g("ScannedLocList")};t[e?.ssg_scan_key]=e,d("ScannedLocList",t)},Ue=async()=>{let e=await F(X,U);Xe(e)},Xe=async e=>{let t={};e&&B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key,r=n?.data2update?.currentStatus;t[s]||(t[s]={}),t[s][r]||(t[s][r]=1)}),d("alredyScan",t),Ze(),Se(B(e)?.length)},ne=async()=>{let e=await F(ke,he),t={},a={},n={};return e&&B(e)?.map(s=>{let r=e?.[s];r?.hbls?.map(b=>{a[b?.hbl]||(a[b?.hbl]=r?.ssg_track_key,n[b?.hbl]=r)}),t[r?.ssg_track_key]||(t[r?.ssg_track_key]=r,t[r?.ssg_track_key].key=r?.key)}),d("manifestByKeys",t),d("manifestByHbls",a),d("hblsObjDBInd",n),t},Ze=async()=>{await se()},it=async()=>{await se(),ne()},se=async()=>{let e=await F(Y,Z),t={};return B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key;t[s]?t[s]?.timeStamp<n?.timeStamp&&(t[s]=n):t[s]=n}),d("ScannedLocList",e),d("ScannedLocByKey",t),e};export{nt as S,Ue as a,st as h,ne as i,it as l,ze as s,rt as u};
