import{a as d,c as V,h as X,o as ee,m as te,d as i,S as $,G as se,i as a,f as re,g as N,t as R,j as ne,z as ae}from"./index-DLm-qbVb.js";import"./ButonHrm-Xix89h7D.js";import{b as oe,u as ie,g as w,f as Y}from"./Util-R0w8Fgio.js";import{H as le,a as ce}from"./html5-qrcode-scanner-Cl8XE5pu.js";import{u as ue}from"./debounces-_rTXI1rL.js";import y from"./FlexSpace-D3ljtz2L.js";import{g as O}from"./globalSignal-DG1rgUS8.js";/* empty css                 */import"./SVG-DMQC_3si.js";import"./index-Ci0zXM0r.js";var de=R('<div class=scanWrp><div><div class=" _dsplFlx"><h3 class="errTxt err centerBx "></h3></div><div class=" _dsplFlx"><h3 class="errTxt ybcity centerBx"></h3></div><div class=" _dsplFlx"><h3 class="errTxt centerBx"></h3></div></div><div></div><div id=qr-reader style=width:350px>'),pe=R("<slot name=plans style=margin-top:35px><div>"),ge=R("<div>esta funcion es solo para dispositivos mobiles");function Pe(f){const[I,C]=d([]),[h,p]=V({}),[Z,M]=d(""),[L,z]=d(),[Q,D]=d(),[T,W]=d(""),[B,F]=d(""),[_,G]=d("");X(()=>{}),ee(()=>{z(!1),oe("cameraScanLoc")?.clear()}),te(()=>{setTimeout(()=>{U()},90)});const m=(e,n)=>{W(n),F(e),setTimeout(()=>{F("")},1300)},v=e=>{G(e),setTimeout(()=>{G("")},2e3)},H=(e,n)=>{e!==Q()&&(D(e),setTimeout(()=>{D("")},3e3),J(e))},J=e=>{if(e||(e=Z()),e=e.split("'").join("-"),M(""),_())return;let n={timeStamp:new Date().getTime(),latitude:O?.latitude,longitude:O?.longitude,statusId:f?.status,userId:ne?.profile?.userId},r=e.split("/");e.split("-").length>3&&(r=e.split("-").join);let t=r?.[0],o="^[A-Z]{3}[0-9]{4}-[1-9]{5}";const l=new RegExp(o);let c=t.length===13&&l.test(t),g="^[0-9]{4}-[1-9]{4}";const S=new RegExp(g);let u=t.length===9&&S.test(t),b=r.length>4&&t.length===12,s={idairguide:r?.[0],":search0":r?.[1],":search1":r?.[3]};c&&(s={idairguide:"175-2383"+t.slice(3,7),":search0":t}),u&&(s={idairguide:"175-2383"+t.slice(0,4),":search0":t}),c||b||u?K(s,n):(m("","error"),p({consigneeInfo:{ybestate:"Codigo Incorrecto"}}),v(w()))},K=async(e,n)=>{let r=await ye(e),t=Object.keys(r)?.[0];if(r[t]?.cidentity){let o=r[t]?.statusHistory||[];if(o.push(n),e.ssg_track_key=t,p(""),p(r[t]),v(w()),m("","success"),!ae?.roles?.[r[t]?.consigneeInfo?.ybestate]?.isActive)m("","warning"),p({consigneeInfo:{ybestate:"Zona incorrecta"}}),v(w());else if(r[t]?.currentStatus!==n.statusId){let l={statusHistory:o,currentStatus:n.statusId};await fe(e,l),C([...I(),newEl])}else m("","warning"),p({consigneeInfo:{ybcity:"Fue escaneado",ybestate:r[t]?.consigneeInfo?.ybestate}}),v(w())}else m("","error"),p({consigneeInfo:{ybestate:"Error con manifiesto"}}),v(w())},U=()=>{z(!0);let e={fps:10,qrbox:{width:350,height:200},supportedScanTypes:[le.SCAN_TYPE_CAMERA],showTorchButtonIfSupported:!0,showZoomSliderIfSupported:!0,verbose:!0},n=new ce("qr-reader",e);n.render(H),ie("cameraScanLoc",n)};return ue(H,400),i($,{when:!0,get fallback(){return ge()},get children(){return i($,{get when(){return L()},get children(){var e=pe(),n=e.firstChild;return e._$owner=se(),a(e,i($,{get when(){return L()},style:"margin-top: 35px",get children(){var r=de(),t=r.firstChild,o=t.firstChild,l=o.firstChild,c=o.nextSibling,g=c.firstChild,S=c.nextSibling,u=S.firstChild,b=t.nextSibling;return a(o,i(y,{}),l),a(l,B),a(o,i(y,{}),null),a(c,i(y,{}),g),a(g,()=>h?.consigneeInfo?.ybcity),a(c,i(y,{}),null),a(S,i(y,{}),u),a(u,()=>h?.consigneeInfo?.ybestate),a(S,i(y,{}),null),re(s=>{var x=`scanOverlayFront ${T()}`,P=_()?"block":"none",E=300/B()?.length*1.73+"px",k=300/h?.consigneeInfo?.ybcity?.length*1.13+"px",q=300/h?.consigneeInfo?.ybestate?.length*1.23+"px",j=`scanOverlay  ${T()} `,A=_()?"block":"none";return x!==s.e&&N(t,s.e=x),P!==s.t&&((s.t=P)!=null?t.style.setProperty("display",P):t.style.removeProperty("display")),E!==s.a&&((s.a=E)!=null?l.style.setProperty("font-size",E):l.style.removeProperty("font-size")),k!==s.o&&((s.o=k)!=null?g.style.setProperty("font-size",k):g.style.removeProperty("font-size")),q!==s.i&&((s.i=q)!=null?u.style.setProperty("font-size",q):u.style.removeProperty("font-size")),j!==s.n&&N(b,s.n=j),A!==s.s&&((s.s=A)!=null?b.style.setProperty("display",A):b.style.removeProperty("display")),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),r}}),n),e}})}})}const ye=async f=>await Y({params:f,query:"getScanLogisticYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2"}),fe=async(f,I)=>await Y({params:f,query:"updateLogisticYabaExpress",data2update:I});export{Pe as default};
