import{OpenToast as o}from"./Toast-ChLiEhC1.js";import{k as _,r as b,f as H,n as L,t as P}from"./index-Clup2ogB.js";import{g as h,i as q}from"./globalSignal-74eRzxm3.js";import{g as l,b as d,f as p,a as N}from"./Util-uEfv1z7O.js";let m="No se encontro ningun registro o el codigo es incorrecto",O=[400,300,400,300,400],c=[300,80,300,80,300,80,300];const D=t=>{t=t.split("'").join("-");let r=t.split("/");t.split("-").length>3&&(r=t.split("-").join);let e=r?.[0];e.indexOf("2300")===0&&(e="2300"+(e.split("2300")?.[1]).slice(0,5));let a="^[A-Z]{3}[0-9]{4}-[1-9]{5}";const s=new RegExp(a);let i=e.length===13&&s.test(e),g="^[0-9]{4}-[1-9]{4}";const u=new RegExp(g);let y=e.length===9&&u.test(e),S=r.length>4&&e.length===12,f="^Y24[0-9]{6}";const w=new RegExp(f);let x=e.length===9&&w.test(e),I="^SS24[0-9]{6}";const k=new RegExp(I);let C=e.length===10&&k.test(e),E="^[0-9]";const A=new RegExp(E);let R=e.length>6&&e.length<11&&A.test(e);if(i||S||y){let n={idairguide:r?.[0],":search0":r?.[1],":search1":r?.[3]};return i&&(n={idairguide:"175-2383"+e.slice(3,7),":search0":e}),y&&(n={idairguide:"175-2383"+e.slice(0,4),":search0":e}),{params:n,code:1}}else if(R||x||C)return{txt:e,code:1}},T=async(t,r)=>{let e=D(t),a={timeStamp:new Date().getTime(),latitude:h?.latitude,longitude:h?.longitude,statusId:r,userId:_?.profile?.userId};return e?.params?await Q(e.params,a):e?.txt?await Y(e.txt,a):(navigator.vibrate(c),{error:{alert:"error",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto"}}}})},Q=async(t,r)=>{let e=await B(t),a=Object.keys(e)?.[0];if(e[a]?.cidentity){let s=v(e[a],r);return navigator.vibrate(500),s}o({text:m,timeout:2500,theme:"red",id:l()}),navigator.vibrate(c)},Y=async(t,r)=>{let e=await F(t);if(e?.cidentity){let a=await v(e,r);return navigator.vibrate(500),a}o({text:m,timeout:2500,theme:"red",id:l()}),navigator.vibrate(c)},v=async(t,r)=>{let e=t?.statusHistory||[];e.push(r);let a=!1;if(t?.isSSG&&b?.roles?.SSG?.isActive&&(a=!0),b?.roles?.[t?.consigneeInfo?.ybestate]?.isActive)if(t?.currentStatus!==r.statusId){let s={statusHistory:e,currentStatus:r.statusId},i={ssg_track_key:t.ssg_track_key,idairguide:t.idairguide},g=await j(i,s),u={tracking:t?.tracking,idairguide:t.idairguide,city:t?.consigneeInfo?.ybcity,estate:t.estate};return{data:{...g,...u,isSSG:a}}}else{a||o({text:"FUE ESCANEADO EN "+t?.consigneeInfo?.ybestate,timeout:3500,theme:"orange",id:l()});let s={consigneeInfo:{ybcity:"Fue escaneado",ybestate:t?.consigneeInfo?.ybestate}};return navigator.vibrate(O),{error:{alert:"warning",scanData:s,isSSG:a}}}else{let s={consigneeInfo:{ybestate:"Zona incorrecta"}};return o({text:"ZONA INCORRECTA",timeout:3500,theme:"orange",id:l()}),navigator.vibrate(c),{error:{alert:"warning",scanData:s}}}},j=async(t,r)=>{let e={params:t,data2update:r},a=d(809004);return e={...e,...a},await p(e)},B=async t=>{let r={params:t,fldsQry:["idairguide","currentStatus","ssg_track_key","statusHistory","tracking","estate","city","cidentity","consigneeInfo:ybestate","consigneeInfo:ybcity"]},e=d(802001);return r={...r,...e},await p(r)},F=async t=>{let r={params:{id:t}},e=d(803001);return r={...r,...e},await p(r)};var Z=P('<div><div class="_dsplFlx flxWrp spaceAround "><img ref alt=ssg>');function z(){return(()=>{var t=Z(),r=t.firstChild,e=r.firstChild;return t.style.setProperty("max-height","80vh"),t.style.setProperty("overflow","auto"),t.style.setProperty("background","#fff"),t.style.setProperty("border-radius","13"),r.style.setProperty("padding","16px"),H(a=>{var s=q()?"96vw":"420px",i=N("SSG.webp");return s!==a.e&&((a.e=s)!=null?t.style.setProperty("width",s):t.style.removeProperty("width")),i!==a.t&&L(e,"src",a.t=i),a},{e:void 0,t:void 0}),t})()}export{z as S,T as h};
