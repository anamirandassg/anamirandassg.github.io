const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-C3WI3KHa.js","assets/index-CNUk02wX.js","assets/index-B8bAFC38.css","assets/Util-CfNBEKzJ.js","assets/FlexSpace-DqsnDapP.js","assets/DropDwnSearch-DN6pHemE.js","assets/debounces-Oe_cYys3.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-D-2CFJAY.js","assets/html5-qrcode-scanner-Cw5j2azE.js","assets/Toast-BagKC026.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-BMLRt-Pa.js","assets/DialogHRM-CCkYNqX4.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-Co64fxcR.js","assets/ShowQRPrintLabel-B7-gl4A5.js","assets/fontkit.es-MWxJo8uD.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-C-73XkvZ.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-Ce7_C8V7.js","assets/LoadingColorSpinner-BhZpf4cT.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{c as M,l as v,_ as k,a as F,b as le,o as oe,d as ce,i as c,e as l,S as j,Q as W,f as B,z as de,U as ge,V,F as ue,k as z,h as Q,m as be,t as y,W as pe,O as fe,X as _e,Y as H,g as q,J as ye,A as N}from"./index-CNUk02wX.js";import"./Toast-BagKC026.js";import{E as Se,j as b,S as T,T as Y,U as J,O as D,u,V as me,W as he,X as Z,Y as ee,g as X,b as ve,F as te,c as ke,K as Le}from"./Util-CfNBEKzJ.js";import{s as xe}from"./App.module-CbHnVtRQ.js";var $e=y('<div class="_dsplFlx flxWrp spaceAround centerBx">'),we=y('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Ce=y('<div class="centerBx100 ">'),Ie=y('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Be=y('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class=centerBx100 style=margin-top:20px>'),De=y('<div class="_dsplFlx flxWrp spaceAround centerBx"><div class=centerBx><h5 style=margin-left:12px>Iniciando...'),Ee=y("<div class=loader>Loading..."),Oe=y('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Fe,Ae]=M(),K=v(()=>k(()=>import("./SVG-C3WI3KHa.js"),__vite__mapDeps([0,1,2,3]))),Pe=v(()=>k(()=>import("./FlexSpace-DqsnDapP.js"),__vite__mapDeps([4,1,2]))),je=v(()=>k(()=>import("./DropDwnSearch-DN6pHemE.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),Ke=v(()=>k(()=>import("./ScanningCamera-D-2CFJAY.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),Re=v(()=>k(()=>import("./ScanningManual-Ce7_C8V7.js"),__vite__mapDeps([22,1,2,3,13,14,10,11,20,21]))),Ge=v(()=>k(()=>import("./LoadingColorSpinner-BhZpf4cT.js"),__vite__mapDeps([23,1,2,24]))),[S,ae]=F(""),[E,se]=F([]);function Me(){M({});const[e,t]=F(1),[a,s]=pe(),n=o=>()=>s(()=>t(o));le(()=>{p()}),oe(()=>{}),ce(()=>{Q()&&t(0),Je(),ne(),tt()});function d(){return"geolocation"in navigator}function i(o){fe({latitude:o?.coords?.latitude,longitude:o?.coords?.longitude})}function p(){d()?navigator.geolocation.getCurrentPosition(i):showMessage("Geolocation isn't supported by your browser")}const L=()=>b("scaninglocation");return(()=>{var o=Be(),A=o.firstChild,P=A.nextSibling,m=P.nextSibling;return c(o,l(j,{get when(){return L()?.length},get fallback(){return(()=>{var r=De(),g=r.firstChild,f=g.firstChild;return c(g,l(Ge,{stroke:"rgb(200 25 60 / 1)",size:32}),f),r})()},get children(){var r=$e();return c(r,l(je,{get list(){return L()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return S()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:g=>ae(g.id),width:"260px"})),r}}),m),c(m,l(j,{get when(){return S()},get children(){return[(()=>{var r=we(),g=r.firstChild,f=g.firstChild,w=f.firstChild,h=g.nextSibling,x=h.firstChild,C=x.firstChild;return W(g,"click",n(0),!0),c(w,l(K,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),W(h,"click",n(1),!0),c(C,l(K,{name:"keyboard",size:32,color:"#2b2b2b"})),B(_=>{var $=e()===0,I=e()===1;return $!==_.e&&g.classList.toggle("selected",_.e=$),I!==_.t&&h.classList.toggle("selected",_.t=I),_},{e:void 0,t:void 0}),r})(),(()=>{var r=Ce();return c(r,l(de,{get fallback(){return Ee()},get children(){return l(ge,{get children(){return[l(V,{get when(){return e()===0},get children(){return l(Ke,{get status(){return S()},get locat(){return S()}})}}),l(V,{get when(){return e()===1},get children(){return l(Re,{get status(){return S()},get locat(){return S()}})}})]}})}})),B(()=>r.classList.toggle("pending",!!a())),r})()]}}),null),c(m,l(j,{get when(){return E()?.length>0},get children(){return[Ie(),l(ue,{get each(){return Se(E(),"timeStamp",0)},children:(r,g)=>(()=>{var f=Oe(),w=f.firstChild,h=w.firstChild,x=h.nextSibling,C=x.nextSibling,_=w.nextSibling,$=_.firstChild,I=$.nextSibling,ie=I.nextSibling;return c(h,l(K,{get name(){return b("M023009")?.statusListIcons?.[r?.currentStatus]},size:32})),x.style.setProperty("padding","8px"),c(x,()=>r?.idairguide),C.style.setProperty("padding","8px"),c(C,()=>r?.tracking),c(f,l(Pe,{}),_),c($,()=>r?.city),c(ie,()=>r?.consigneeInfo?.ybestate),B(()=>z(f,`client_item_box gWXAaj jlytmu manifest  ${Q()?"isMobile":"centerBx"}`)),f})()})]}}),null),B(()=>z(o,xe.App)),o})()}be(["click"]);const it=Object.freeze(Object.defineProperty({__proto__:null,default:Me,scannedQRs:Fe,setScannedQRs:Ae,setStatus:ae,setTaskScan:se,status:S,taskScan:E},Symbol.toStringTag,{value:"Module"}));let Te=[400,300,400,300,400],R=[300,80,300,80,300,80,300];const[We,lt]=F(!1),[ot,ct]=M({scan:{}}),Ve=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let a=e.split("/")?.[0];return a.indexOf("230")>=0&&(a="230"+(a.split("230")?.[1]).slice(0,6)),a.indexOf("231")>=0&&(a="231"+(a.split("231")?.[1]).slice(0,5)),{params:{":search0":a},code:1}},dt=async(e,t)=>{let a=Ve(e),s={timeStamp:new Date().getTime(),latitude:H?.latitude,longitude:H?.longitude,statusId:t,userId:q?.profile?.userId,userName:q?.profile?.name};if(We(),t&&a?.params)return await ze(a.params,s);{let n=a?.txt||a?.params?.[":search0"];return navigator.vibrate(R),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},ze=async(e,t)=>{let a=null;if(ye()){qe();let s=b("manifestByHbls")?.[e?.[":search0"]],n=b("manifestByKeys")?.[s];if(!n){let d={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(R),{error:{alert:"error",color:"rgb(200 25 60)",scanData:d}}}a=Qe(n,t)}else a=await He(e,t);if(a?.code===203||a?.code===303)return navigator.vibrate(Te),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let s={...a.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),se([...E(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(R),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},Qe=(e,t)=>{let a={currentStatus:t?.statusId};e?.isSSG&&N?.roles?.SSG?.isActive;let s=e?.address?.estate||e?.consigneeInfo?.ybestate,n=e?.address?.city||e?.consigneeInfo?.ybcity;if(!N?.roles?.[s]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};let d=b("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(d===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:s,bagnumber:e?.bagnumber}}};let i=d?.split("_")?.[1],p=t?.statusId?.split("_")?.[1];if(i&&p&&i*1>p*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+d,ybestate:s,bagnumber:e?.bagnumber}}};let L={idairguide:e?.idairguide,city:n,estate:s,consigneeInfo:{ybestate:s,ybcity:n},bagnumber:e?.bagnumber,isSSG:e?.isSSG},o={...t};o.ssg_track_key=e?.ssg_track_key,o.ssg_scan_key=Le();let A={form:o,itmN:L,params:{airguide:e?.guia},actionKey:815005};Ue(A);let P={...o};Ye(P);let m={...b("ScannedLocByKey")};return m[e?.ssg_track_key]=o,u("ScannedLocByKey",m),{code:200,data:{...L,...a}}},He=async(e,t)=>{let a={params:e,form:t},s=X(802001);return s=X(802008),a={...a,...s},(await ve(a))?.data};let U=null;const qe=()=>{U||(U=setInterval(()=>{Xe(),Ne()},750))},gt=()=>{O=new Date().getTime()};let O=0;const Ne=()=>{O+1250<new Date().getTime()&&(O=99999999999990,te(J,Y,b("dbScannedStore")))};let G=0;const Xe=()=>{G+1250<new Date().getTime()&&(G=99999999999990,te(ee,Z,b("ScannedLocList")))},Ue=async e=>{O=new Date().getTime();let t={...b("dbScannedStore")};t[ke()]=e,u("dbScannedStore",t)},Ye=async e=>{G=new Date().getTime();let t={...b("ScannedLocList")};t[e?.ssg_scan_key]=e,u("ScannedLocList",t)},Je=async()=>{let e=await T(J,Y);Ze(e)},Ze=async e=>{let t={};e&&D(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key,d=s?.guia;console.log(d);let i=s?.data2update?.currentStatus;t[n]||(t[n]={}),t[n][i]||(t[n][i]=1)}),u("alredyScan",t),et(),_e(D(e)?.length)},ne=async()=>{let e=await T(he,me),t={},a={},s={},n={};return e&&D(e)?.map(d=>{let i=e?.[d];i?.hbls?.map(p=>{a[p?.hbl]||(a[p?.hbl]=i?.ssg_track_key,s[p?.hbl]=i)}),t[i?.ssg_track_key]||(t[i?.ssg_track_key]=i),n[i?.guia]?n[i?.guia]+=1:n[i?.guia]=1}),u("total_guia",n),u("manifestByKeys",t),u("manifestByHbls",a),u("hblsObjDBInd",s),t},et=async()=>{await re()},tt=async()=>{await re(),ne()},re=async()=>{let e=await T(ee,Z),t={};return D(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key;t[n]?t[n]?.timeStamp<s?.timeStamp&&(t[n]=s):t[n]=s}),u("ScannedLocList",e),u("ScannedLocByKey",t),e};export{it as S,Je as a,gt as b,lt as c,ct as d,ot as f,dt as h,tt as l,We as o,qe as s,Ue as u};
