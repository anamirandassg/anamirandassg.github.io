const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-lBBaGVw4.js","assets/index-Dqo_j541.js","assets/index-IeDM_K18.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-Bgqfdodd.js","assets/debounces-ClZ-2WVf.js","assets/SVG-CzxGeISJ.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-qQqQY3oI.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-DKbVb1aH.js","assets/DialogHRM-DoyCFp-E.js","assets/DialogHRM-V9_lZntj.css","assets/fontkit.es-BgZByb7N.js","assets/InitPrintServices-B25V_wn1.js"])))=>i.map(i=>d[i]);
import{l as I,_ as z,c as E,a as de,u as ue,p as _e,k as be,q as he,b as fe,i as o,d,f as le,o as V,V as pe,e as me,t as A,W as ve,K as U,X as ye,S as Y,Y as xe,Z as ke,O as $,h as X,y as we,F as Se,$ as $e,s as Ae,j as oe,a0 as Ce}from"./index-Dqo_j541.js";import{u as De}from"./debounces-ClZ-2WVf.js";import{P as Oe,f as Le,r as x}from"./fontkit.es-BgZByb7N.js";import{i as Me,t as v,b as Be}from"./InitPrintServices-B25V_wn1.js";const Pe=(s,c,e)=>{const n=c.widthOfTextAtSize(s,40),a=c.widthOfTextAtSize(s,10);return Math.floor(e/((n-a)/30))},Ee=async(s,c,e)=>{const n=await Oe.create();n.registerFontkit(Le);const a=await Me(n);let k=265,f=30,w=Math.ceil(s.length/f);Array.from(Array(w).keys()).map(S=>{let T=s.slice(S*f,(S+1)*f);const b=n.addPage(),{height:C}=b.getSize();let D=C-74;T.map((_,h)=>{let p=D;h%2&&b?.drawRectangle({x:10,y:p-15,width:580,height:24,color:x(.7,.7,.7)});let F=Pe(v(_?.state),a.roboto_bold,k),K=0;F>42&&(F=42,p=p-6);let N=_?.bagnumber;const H=a.Lexend_700.widthOfTextAtSize(v(N),5);b.drawText(v(N),{x:575-H,y:p-3,size:5,font:a.Lexend_700,color:x(0,0,0)});let W=_?.consigneeInfo?.ybcity+" | "+_?.consigneeInfo?.ybestate;const t=a.Lexend_700.widthOfTextAtSize(v(W),7);_?.cidentity&&b.drawText(v(_?.cidentity),{x:25,y:p+3,size:7,font:a.Lexend_700,color:x(0,0,0)}),_?.consigneeInfo?.ybestate&&b.drawText(v(W),{x:575-t,y:p+3,size:7,font:a.Lexend_700,color:x(0,0,0)});let r="";_?.hbls.map((g,l)=>{r+=(l>0?"  |  ":"")+g?.hbl}),b.drawText(v(r),{x:45,y:p-3,size:5,font:a.Lexend_700,color:x(0,0,0)}),K+=_?.pricePP*_?.totalWeight,D=p-18}),b.drawText("Guia: "+v(e?.guia),{x:17,y:C-22,size:12,font:a.Lexend_700,color:x(0,0,0)}),b.drawText("Fecha: "+v(e?.date),{x:19,y:C-35,size:10,font:a.Lexend_700,color:x(0,0,0)})});{const S=await n.save();return Be(S)}};var Ie=A("<h5>"),ze=A("<div style=padding:4px>"),Te=A('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div><div class="icon align_itm"></div></div><div><div class="icon align_itm">'),Fe=A('<div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5><h4></h4><h4></h4></div></div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Ne=A("<div> <!>."),We=A("<div> ");const je=I(()=>z(()=>import("./LoadingColorSpinner-lBBaGVw4.js"),__vite__mapDeps([0,1,2,3]))),ce=I(()=>z(()=>import("./DropDwnSearch-Bgqfdodd.js"),__vite__mapDeps([4,1,2,5,6,7]))),Re=I(()=>z(()=>import("./InputHr-qQqQY3oI.js"),__vite__mapDeps([8,1,2,9]))),Z=I(()=>z(()=>import("./SVG-CzxGeISJ.js"),__vite__mapDeps([6,1,2]))),qe=I(()=>z(()=>import("./ItemOnManifestList-DKbVb1aH.js"),__vite__mapDeps([10,1,2,5,11,12,13,14]))),[P,J]=E({list:{}}),[Ze,Je]=de("");function et(){const[s,c]=ue(),[e,n]=E({search:""}),[a,k]=E(),[f,w]=E(),[S,T]=E(),[b,C]=de(""),D=De(C,400),_=(t,r)=>{n({[t]:r}),D(oe())};_e(()=>{J("list",void 0)}),be(()=>{}),he(async()=>{let t=[];[33,46,40,41,42,50,52,54,56].map(l=>{let m=ve?.[l];U?.roles?.[m?.id]?.isActive&&t.push(m)}),T("list",t);let g=[];if(ye.map(l=>{let u=l.label;U?.roles?.[u]?.isActive&&g.push(l)}),T("prov",g),s?.mId){let l={id:s?.mId};console.log(l);let u=await Ke(l);console.log(s?.mId),console.log(u),n("province",u?.province),n("city",u?.city),n("manifestObj",u),w("linked",u?.linkedBags)}});const[h,{refetch:p}]=fe(b,async t=>{let r=e?.manifest?.id,g=e?.province,l=g&&e?.city,u=[];if(r){const m=await Ye(e.search,r,g,l);k("bags",m),$(m).map(O=>{let L=m[O],j=L.currentStatus;U?.roles?.[j]?.isActive&&j.split("_")?.[1]>=33&&u.push(L)})}return u}),F=(t,r)=>{n({[t]:r}),D(oe()),J("list",void 0)},K=()=>{let t={},r=0;$(P?.list)?.length!==h()?.length?(r=1,h().map(g=>{let l=g.ssg_track_key;t[l]=r})):h().map(g=>{let l=g.ssg_track_key;t[l]=void 0}),J("list",t)},N=async()=>{let t=f?.linked||{};$(P?.list).map(r=>{t?.[r]||(t[r]={idairguide:a?.bags?.[r]?.idairguide})}),w("linked",t),await Ve({ssg_manifest_key:s?.mId},{linkedBags:t})},H=()=>{let t=[];$(P?.list).map(r=>{a?.bags?.[r]&&t.push(a?.bags?.[r])}),W(t)},W=async t=>{let r=await Ee(t,!0,{guia:t[0]?.idairnumber,date:Ce()});window.open(r)};return(()=>{var t=Fe(),r=t.firstChild,g=r.firstChild,l=g.firstChild,u=l.nextSibling,m=u.nextSibling,O=r.nextSibling,L=O.firstChild,j=L.nextSibling,R=O.nextSibling;return o(l,()=>e?.manifestObj?.ssg_manifest_key),o(u,()=>e?.manifestObj?.name),o(g,d(Y,{get when(){return e?.manifestObj?.city},get children(){return["|",(()=>{var i=Ie();return o(i,()=>e?.manifestObj?.city),i})()]}}),m),o(m,()=>e?.manifestObj?.province),o(L,d(ce,{list:xe,lbl_empty:"Manifiesto",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:i=>F("manifest",i),width:"260px"})),o(j,d(ce,{get list(){return S?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:i=>_("warehouse",i),width:"260px"})),o(O,d(Y,{get when(){return e?.manifest?.id},get children(){var i=ze();return o(i,d(Re,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return e?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:y=>_("search",y)})),i}}),null),o(R,d(Y,{get when(){return ke(()=>!!e?.manifest?.id)()&&h().length>0},get children(){var i=Te(),y=i.firstChild,q=y.firstChild,M=y.nextSibling,G=M.firstChild,ee=G.firstChild,te=ee.nextSibling;te.nextSibling;var ge=M.nextSibling,Q=ge.nextSibling,re=Q.firstChild,ie=Q.nextSibling,se=ie.firstChild;return i.style.setProperty("margin","18px 0"),q.$$click=K,o(q,d(Z,{get name(){return $(P?.list)?.length<h()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),o(G,()=>$(P?.list)?.length,ee),o(G,()=>h()?.length,te),re.$$click=N,o(re,d(Z,{name:"link",color:"var(--background-red-ssg)"})),se.$$click=H,o(se,d(Z,{name:"printer",color:"var(--background-red-ssg)"})),le(B=>{var ae=` ${X()?"tr_bar_15":"tr_bar_05"} tr_bar  align_itm centerBx"`,ne=` ${X()?"tr_bar_10":"tr_bar_05"} tr_bar  align_itm centerBx"`;return ae!==B.e&&(Q.className=B.e=ae),ne!==B.t&&(ie.className=B.t=ne),B},{e:void 0,t:void 0}),i}}),null),o(R,d($e,{fallback:i=>(()=>{var y=Ne(),q=y.firstChild,M=q.nextSibling;return M.nextSibling,o(y,()=>i.toString(),M),y})(),get children(){return d(we,{get fallback(){return(()=>{var i=We();return i.firstChild,o(i,d(je,{stroke:"rgb(200 25 60 / 1)",size:62}),null),i})()},get children(){return d(Y,{get when(){return h()},get children(){return d(Se,{get each(){return h()},children:i=>d(qe,{item:i,get isAlready(){return f?.linked?.[i.ssg_track_key]}})})}})}})}}),null),le(i=>Ae(R,` ${X(),"width:86vw;"} margin: 0 auto;`,i)),t})()}const Ye=async(s,c,e,n)=>{let a={params:{idairguide:c},query:"getScanLogisticYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5 AND currentStatus = :status AND estate = :estate AND city = :city"};s&&s.split(" ").map((f,w)=>{f&&(a.params[":search"+w]=f.trim())}),e&&(a.params[":estate"]=e),n&&(a.params[":city"]=n),console.log(a);const k=await V(a);return k?.error?{}:k},Ve=async(s,c)=>await V({params:s,query:"updateManifestYabaExpress",data2update:c}),Ke=async s=>{let c={params:s,query:"getManifestOrderByKeyID"};console.log(c);const e=await V(c);return console.log(e),e},tt=async s=>{let c=[];s.map(e=>{let n={params:{id:e?.ssg_track_key,idairguide:e?.idairguide},query:"getLogisticOrderByKeyID"};c.push(n)}),pe(c,He)},He=async s=>{const e=await V(s);if(e)return e};me(["click"]);export{et as default,He as fetchCSVInve,tt as loadManifest,Ze as manifestObs,P as selectedManifest,Je as setManifestObs,J as setSelectedManifest,Ve as updLinkedBags};
