const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CheckBoxSlide-BotaVPeE.js","assets/index-MWcyRJ7Y.js","assets/index-BmzAZVve.css","assets/CheckBoxSlide-uVD3DHDO.css","assets/ButonHrm-DYarANhh.js","assets/SVG-0DyuRqFt.js","assets/ButonHrm-BSeWNUGQ.css","assets/DropDwnSearch-P3esQWD3.js","assets/debounces-CWPhYdOE.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-D7ln_m0W.js","assets/html5-qrcode-scanner-NRvKr1su.js","assets/Toast-kUDxtYWW.js","assets/Toast-DLpFKn-Q.css","assets/ShowScanAlert-DphFs66Q.js","assets/ShowQRPrintLabel-DV-3ePBv.js","assets/PDFButton-D6iUlA_X.js","assets/qrcode-C5vWJp7P.js","assets/fontkit.es-DjiWixPQ.js","assets/InitPrintServices-DDjs88_M.js","assets/DialogHRM-CX4AZT-W.js","assets/DialogHRM-V9_lZntj.css","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-CJKYlpVJ.js","assets/FlexSpace-D2xE4IT5.js","assets/LoadingColorSpinner-CAQbMN22.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{l as m,_ as h,c as U,i as l,d as r,F as ce,e as D,g as T,t as b,O as de,ab as K,n as J,M as ue,o as F,K as Y,ac as z,p as H,q as X,Q as j,ad as ge,aa as ke,N as Se,a as L,k as xe,r as we,s as Ie,S as P,ae as ee,H as $e,af as Ce,ag as te,a9 as Pe,f as ne,h as Le,ah as Be,j as se,X as Ee}from"./index-MWcyRJ7Y.js";import{s as Oe}from"./App.module-CbHnVtRQ.js";import{OpenToast as De}from"./Toast-kUDxtYWW.js";import{CloseModal as ae,OpenModal as Me}from"./DialogHRM-CX4AZT-W.js";var Ae=b('<div><div><div class="_dsplFlx flxWrp spaceAround "><div class="_dsplFlx bottombx lowbordr"><h5>Descargar Guias </h5></div></div><div class="centerBx bottombx spaceAround"style=margin-top:20px>|'),Fe=b('<div class="centerBx bottombx "><h5 class="">');const je=m(()=>h(()=>import("./CheckBoxSlide-BotaVPeE.js"),__vite__mapDeps([0,1,2,3]))),re=m(()=>h(()=>import("./ButonHrm-DYarANhh.js"),__vite__mapDeps([4,1,2,5,6])));function Re(e){const[s,t]=U({}),n=()=>{ae(e?.modalId)},a=()=>{ae(e?.modalId),e?.confirm(de(s))};let p=[42,43,44,45];return(()=>{var d=Ae(),v=d.firstChild,B=v.firstChild,C=B.nextSibling,W=C.firstChild;return d.style.setProperty("max-height","80vh"),d.style.setProperty("overflow","auto"),d.style.setProperty("background","#ffffff"),d.style.setProperty("border-radius","13"),d.style.setProperty("padding","50px 25px"),l(v,r(ce,{each:p,children:(_,Z)=>(()=>{var E=Fe(),R=E.firstChild;return l(E,r(je,{get initValue(){return s?.[_]},updChange:()=>t(_,!s?.[_]),color:"var(--background-red-ssg)"}),R),l(R,_),E})()}),C),l(C,r(re,{icon:"cancel",color:"#7d7d7d",label:"Cancelar",handleClick:n}),W),l(C,r(re,{icon:"success",color:"#c8193c",label:"Confirmar",handleClick:a}),null),D(_=>(_=T()?"86vw":"420px")!=null?d.style.setProperty("width",_):d.style.removeProperty("width")),d})()}let Ge=[400,300,400,300,400],fe=[300,80,300,80,300,80,300];const Ne=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let t=e.split("/")?.[0];return t.indexOf("230")>=0&&(t="230"+(t.split("230")?.[1]).slice(0,6)),t.indexOf("231")>=0&&(t="231"+(t.split("231")?.[1]).slice(0,5)),{params:{idairguide:"all",":search0":t},code:1}},bt=async(e,s)=>{let t=Ne(e),n={timeStamp:new Date().getTime(),latitude:K?.latitude,longitude:K?.longitude,statusId:s,userId:J?.profile?.userId,userName:J?.profile?.name};if(t?.params)return await Ve(t.params,n);{let a=t?.txt||t?.params?.search0;return navigator.vibrate(fe),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:a}}}}}},Ve=async(e,s)=>{let t=null;if(ue()){let n=F("manifestByHbls")?.[e?.[":search0"]],a=F("manifestByKeys")?.[n];t=ze(a,s)}else t=(await He(e,s))?.data;if(t?.code===203||t?.code===303)return navigator.vibrate(Ge),{error:{alert:"warning",color:"#FF6F1D",scanData:t.data}};if(t?.code===200){navigator.vibrate(500);let n={...t.data};return n.tracking=e?.[":search0"],n.timeStamp=new Date().getTime(),pe([...Q(),n]),{error:{alert:"success",color:"#0f5223ff",scanData:t.data}}}else if(!t||t?.error){let n={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(fe),{error:{alert:"error",color:"rgb(200 25 60)",scanData:n}}}},ze=(e,s)=>{let t=e?.statusHistory||[];t.push(s);let n={statusHistory:t,currentStatus:s?.statusId};if(e?.isSSG&&Y?.roles?.SSG?.isActive,!Y?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};if(F("alredyScan")?.[s.statusId]?.[e?.ssg_track_key])return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};if(e?.currentStatus===s.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let a={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},p={data2update:n,itmN:a,ssg_track_key:e?.ssg_track_key};return z.post(p,function(v,B){v||console.log("Successfully posted")}),M(A),{code:200,data:{...a,...n}}},He=async(e,s)=>{let t={params:e,form:s},n=H(802001);return n=H(802008),t={...t,...n},await X(t)},M=async e=>{z.allDocs({include_docs:!0,descending:!0},function(s,t){e(t.rows)})},A=e=>{let s={};e?.map(t=>{let n=t?.doc?.ssg_track_key,a=t?.doc?.data2update?.currentStatus;s[a]||(s[a]={}),s[a][n]||(s[a][n]=1)}),j("alredyScan",s),_e(e?.length)},ie=async()=>{let e=await Qe(),s={},t={};return e.map(n=>{n?.doc?.hbls?.map(a=>{t[a?.hbl]||(t[a?.hbl]=n?.doc?.ssg_track_key)}),s[n?.doc?.ssg_track_key]||(s[n?.doc?.ssg_track_key]=n?.doc,s[n?.doc?.ssg_track_key].key=n?.key)}),j("manifestByKeys",s),j("manifestByHbls",t),s},Qe=()=>new Promise((e,s)=>{ge.allDocs({include_docs:!0,descending:!0},function(t,n){e(n.rows)})}),pt=async()=>{let e=await We(),s={};e?.map(t=>{let n=t?.doc?.params?.ssg_manifest_key;s[n]||(s[n]=t?.doc)}),j("alinkM",s)},We=()=>new Promise((e,s)=>{ke.allDocs({include_docs:!0,descending:!0},function(t,n){e(n.rows)})}),_t=async()=>{let e=await qe(),s={};e?.map(t=>{let n=t?.doc?.ssg_manifest_key;s[n]||(s[n]=t?.doc)}),j("manifestList",s)},qe=()=>new Promise((e,s)=>{Se.allDocs({include_docs:!0,descending:!0},function(t,n){e(n.rows)})});var Te=b('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Ke=b('<div class="centerBx100 ">'),Ue=b('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Xe=b('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Ze=b('<div class="centerBx bottombx "><h5> descargando guias... '),Je=b('<div class="centerBx bottombx "><h5> subiendo al servidor <!> / <!> '),Ye=b("<div class=loader>Loading..."),et=b('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[tt,nt]=U(),st=m(()=>h(()=>import("./DropDwnSearch-P3esQWD3.js"),__vite__mapDeps([7,1,2,8,5,9]))),at=m(()=>h(()=>import("./ScanningCamera-D7ln_m0W.js"),__vite__mapDeps([10,1,2,11,8,12,13,14,15,16,17,18,19,20,21,22,23]))),rt=m(()=>h(()=>import("./ScanningManual-CJKYlpVJ.js"),__vite__mapDeps([24,1,2,12,13,14,15,16,17,18,19,20,21,22,23]))),q=m(()=>h(()=>import("./SVG-0DyuRqFt.js"),__vite__mapDeps([5,1,2]))),it=m(()=>h(()=>import("./FlexSpace-D2xE4IT5.js"),__vite__mapDeps([25,1,2]))),le=m(()=>h(()=>import("./LoadingColorSpinner-CAQbMN22.js"),__vite__mapDeps([26,1,2,27]))),oe=m(()=>h(()=>import("./ButonHrm-DYarANhh.js"),__vite__mapDeps([4,1,2,5,6]))),[$,be]=L(""),[Q,pe]=L([]),[V,_e]=L(0);function lt(){U({});const[e,s]=L(1),[t,n]=Be(),a=c=>()=>n(()=>s(c)),[p,d]=L(!1),[v,B]=L(0);xe(()=>{E()}),we(()=>{}),Ie(()=>{T()&&s(0),M(A),ie()});const C=async c=>{d(!0);let o={};const u=c.map(async y=>{let g=await ot("guia",y);o=Object.assign({},o,g)});await Promise.all(u),de(o).map(y=>{let g={...o[y]};g.id=g.ssg_track_key,F("manifestByKeys")[g?.ssg_track_key]||W(o[y])}),await ie(),M(A),De({text:"El modo offline esta listo para escanear",timeout:2500,id:se()}),d(!1)},W=async c=>{ge.post(c,function(u,y){u||console.log("Successfully posted")})};function _(){return"geolocation"in navigator}function Z(c){Ee({latitude:c?.coords?.latitude,longitude:c?.coords?.longitude})}function E(){_()?navigator.geolocation.getCurrentPosition(Z):showMessage("Geolocation isn't supported by your browser")}const R=()=>K?.list?.filter(c=>c.id),ye=async c=>{B(V());const o=c.map(async u=>{await ct({ssg_track_key:u?.doc?.ssg_track_key,idairguide:"all"},u?.doc?.data2update),z.remove(u?.doc,function(g,i){g||(console.log("dbScanned successfully removed "),M(A))})});await Promise.all(o),M(A),B(0)},me=async c=>{z.allDocs({include_docs:!0,descending:!0},function(o,u){ye(u.rows)})},he=c=>{let o={},u=se();o.id=u,o.props={minHeight:"1vh",overlay:!0,height:"93vh",zIndex:450},o.content=r(Re,{confirm:C,modalId:u}),Me(o)};return(()=>{var c=Xe(),o=c.firstChild;o.firstChild;var u=o.nextSibling,y=u.nextSibling,g=y.nextSibling;return l(o,r(P,{get when(){return ue()},get children(){return r(P,{get when(){return!p()},get fallback(){return(()=>{var i=Ze();return l(i,r(le,{stroke:"rgb(200 25 60 / 1)",size:32}),null),i})()},get children(){return r(oe,{color:"rgb(200 25 60 / 1)",label:"preparar datos fuera de linea",handleClick:he})}})}}),null),l(o,r(P,{get when(){return V()>0},get children(){return r(P,{get when(){return!v()},get fallback(){return(()=>{var i=Je(),f=i.firstChild,k=f.firstChild,I=k.nextSibling,S=I.nextSibling,x=S.nextSibling;return x.nextSibling,l(i,r(le,{stroke:"rgb(200 25 60 / 1)",size:32}),f),l(f,()=>v()-V(),I),l(f,v,x),i})()},get children(){return r(oe,{color:"rgb(200 25 60 / 1)",label:"Subir pendientes",handleClick:me})}})}}),null),l(y,r(st,{get list(){return R()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return $()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:i=>be(i.id),width:"260px"})),l(g,r(P,{get when(){return $()},get children(){return[(()=>{var i=Te(),f=i.firstChild,k=f.firstChild,I=k.firstChild,S=f.nextSibling,x=S.firstChild,G=x.firstChild;return ee(f,"click",a(0),!0),l(I,r(q,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),ee(S,"click",a(1),!0),l(G,r(q,{name:"keyboard",size:32,color:"#2b2b2b"})),D(w=>{var O=e()===0,N=e()===1;return O!==w.e&&f.classList.toggle("selected",w.e=O),N!==w.t&&S.classList.toggle("selected",w.t=N),w},{e:void 0,t:void 0}),i})(),(()=>{var i=Ke();return l(i,r($e,{get fallback(){return Ye()},get children(){return r(Ce,{get children(){return[r(te,{get when(){return e()===0},get children(){return r(at,{get status(){return $()},get locat(){return $()}})}}),r(te,{get when(){return e()===1},get children(){return r(rt,{get status(){return $()},get locat(){return $()}})}})]}})}})),D(()=>i.classList.toggle("pending",!!t())),i})()]}}),null),l(g,r(P,{get when(){return Q()?.length>0},get children(){return[Ue(),r(ce,{get each(){return Pe(Q(),"timeStamp",0)},children:(i,f)=>(()=>{var k=et(),I=k.firstChild,S=I.firstChild,x=S.nextSibling,G=x.nextSibling,w=I.nextSibling,O=w.firstChild,N=O.nextSibling,ve=N.nextSibling;return l(S,r(q,{get name(){return F("M023009")?.statusListIcons?.[i?.currentStatus]},size:32})),x.style.setProperty("padding","8px"),l(x,()=>i?.idairguide),G.style.setProperty("padding","8px"),l(G,()=>i?.tracking),l(k,r(it,{}),w),l(O,()=>i?.city),l(ve,()=>i?.consigneeInfo?.ybestate),D(()=>ne(k,`client_item_box gWXAaj jlytmu manifest  ${T()?"isMobile":"centerBx"}`)),k})()})]}}),null),D(()=>ne(c,Oe.App)),c})()}const ot=async(e,s)=>{let t={params:{idairguide:"all"},fldswQry:["street","agency","idairguide","currentStatus","cidentity","ssg_track_key","bagnumber","tracking","estate","city","zone","guia","consigneeInfo:phoneNumber","consigneeInfo:altPhoneNumber","consigneeInfo:firstName","consigneeInfo:middleName","consigneeInfo:lastName","consigneeInfo:lastName2","consigneeInfo:ybstreet","consigneeInfo:ybstreetNo","consigneeInfo:ybbetwen1","consigneeInfo:ybbetwen2","consigneeInfo:ybreparto","consigneeInfo:ybestate","consigneeInfo:ybcity","deliveryUserId","deliveryTime","isSSG","isLMH","isPaid","hbls","noteTag","nameshipper","billedBy"]};e.split(" ").map((p,d)=>{p&&(t.params[":search"+d]=p.trim())}),t.params[":guia"]=s+"";let n=H(802001);t={...t,...n};const a=await X(t);return a?.data?.error?{}:a},ct=async(e,s)=>{let t={params:e,data2update:s},n=H(809004);return t={...t,...n},await X(t)};Le(["click"]);const yt=Object.freeze(Object.defineProperty({__proto__:null,default:lt,pendingOffline:V,scannedQRs:tt,setPendingOffline:_e,setScannedQRs:nt,setStatus:be,setTaskScan:pe,status:$,taskScan:Q},Symbol.toStringTag,{value:"Module"}));export{yt as S,pt as a,A as b,bt as c,_t as h,ie as i,M as l};
