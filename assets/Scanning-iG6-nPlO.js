const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-CJrcVamg.js","assets/index-CHpRMMcL.js","assets/index-lCkr9jrN.css","assets/FlexSpace-D8CPn30t.js","assets/DropDwnSearch-b-ybe5oC.js","assets/debounces-DY3aBeyT.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-BtXPw60L.js","assets/html5-qrcode-scanner-C_mgMdRk.js","assets/Toast-DYKCeSqJ.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-RRTPM59R.js","assets/DialogHRM-B26Xh0E8.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-C8UTdRyo.js","assets/ShowQRPrintLabel-BLxqdd2Q.js","assets/PDFButton-C77ST4HX.js","assets/qrcode-DHy8FFhS.js","assets/fontkit.es-CBL7hhp4.js","assets/InitPrintServices-CfDhfV0j.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-BSL0EUYu.js","assets/LoadingColorSpinner-DNqbN189.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{Q as b,N as se,am as Q,an as P,n as F,M as ne,o as m,K as A,ad as z,p as j,q as re,ao as H,ap as ie,ac as le,c as K,l as f,_ as p,a as E,k as oe,r as ce,s as de,i as l,d as i,ah as R,e as L,H as ue,aq as ge,ar as G,S as V,F as be,ab as fe,f as W,g as q,h as pe,t as _,as as _e,at as ye,ae as he}from"./index-CHpRMMcL.js";import{s as ve}from"./App.module-CbHnVtRQ.js";import"./Toast-DYKCeSqJ.js";let me=[400,300,400,300,400],N=[300,80,300,80,300,80,300];const Se=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let t=e.split("/")?.[0];return t.indexOf("230")>=0&&(t="230"+(t.split("230")?.[1]).slice(0,6)),t.indexOf("231")>=0&&(t="231"+(t.split("231")?.[1]).slice(0,5)),{params:{idairguide:"all",":search0":t},code:1}},Ke=async(e,a)=>{let t=Se(e),s={timeStamp:new Date().getTime(),latitude:P?.latitude,longitude:P?.longitude,statusId:a,userId:F?.profile?.userId,userName:F?.profile?.name};if(a&&t?.params)return await ke(t.params,s);{let n=t?.txt||t?.params?.[":search0"];return navigator.vibrate(N),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},ke=async(e,a)=>{let t=null;if(ne()){let s=m("manifestByHbls")?.[e?.[":search0"]],n=m("manifestByKeys")?.[s];t=xe(n,a)}else t=(await we(e,a))?.data;if(t?.code===203||t?.code===303)return navigator.vibrate(me),{error:{alert:"warning",color:"#FF6F1D",scanData:t.data}};if(t?.code===200){navigator.vibrate(500);let s={...t.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),Y([...$(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:t.data}}}else if(!t||t?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(N),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},xe=(e,a)=>{let t=e?.statusHistory||[];t.push(a);let s={statusHistory:t,currentStatus:a?.statusId};if(e?.isSSG&&A?.roles?.SSG?.isActive,!A?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};if(m("alredyScan")?.[a.statusId]?.[e?.ssg_track_key])return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};if(e?.currentStatus===a.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let n={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},S={data2update:s,itmN:n,ssg_track_key:e?.ssg_track_key,params:{ssg_track_key:e?.ssg_track_key,idairguide:"all"},actionKey:809004};return console.log(a),console.log(s),z.post(S,function(C,M){C||console.log("successfully posted on queue")}),Ie(e?.ssg_track_key,a.statusId),{code:200,data:{...n,...s}}},we=async(e,a)=>{let t={params:e,form:a},s=j(802001);return s=j(802008),t={...t,...s},await re(t)},T=async e=>{z.allDocs({include_docs:!0,descending:!0},function(a,t){e(t.rows)})},X=e=>{let a={};e?.map(t=>{let s=t?.doc?.ssg_track_key,n=t?.doc?.data2update?.currentStatus;a[n]||(a[n]={}),a[n][s]||(a[n][s]=1)}),b("alredyScan",a),H(e?.length)},Ie=(e,a)=>{let t=m("alredyScan")||{};t[a]||(t[a]={}),t[a][e]||(t[a][e]=1),b("alredyScan",t),H(ie()+1)},Z=async()=>{let e=await Le(),a={},t={};return e.map(s=>{s?.doc?.hbls?.map(n=>{t[n?.hbl]||(t[n?.hbl]=s?.doc?.ssg_track_key)}),a[s?.doc?.ssg_track_key]||(a[s?.doc?.ssg_track_key]=s?.doc,a[s?.doc?.ssg_track_key].key=s?.key)}),b("manifestByKeys",a),b("manifestByHbls",t),a},Le=()=>new Promise((e,a)=>{Q.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),$e=async()=>{let e=await Ce(),a={};e?.map(t=>{let s=t?.doc?.params?.ssg_manifest_key;a[s]||(a[s]=t?.doc)}),b("alinkM",a)},Ce=()=>new Promise((e,a)=>{le.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Be=async()=>{let e=await J(),a={};return e?.map(t=>{let s=t?.doc?.ssg_manifest_key;a[s]=t?.doc}),b("manifestList",a),a},J=()=>new Promise((e,a)=>{se.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Ne=async()=>((await J())?.map(a=>{Q.remove(a?.doc,function(s,n){})}),1),Te=async()=>{await Be(),await $e(),T(X),Z()};var Ee=_('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Me=_('<div class="centerBx100 ">'),De=_('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Oe=_('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Pe=_("<div class=loader>Loading..."),Fe=_('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Ae,je]=K(),B=f(()=>p(()=>import("./SVG-CJrcVamg.js"),__vite__mapDeps([0,1,2]))),Re=f(()=>p(()=>import("./FlexSpace-D8CPn30t.js"),__vite__mapDeps([3,1,2]))),Ge=f(()=>p(()=>import("./DropDwnSearch-b-ybe5oC.js"),__vite__mapDeps([4,1,2,5,0,6]))),Ve=f(()=>p(()=>import("./ScanningCamera-BtXPw60L.js"),__vite__mapDeps([7,1,2,8,5,9,10,11,12,13,14,15,16,17,18,19,20,21]))),We=f(()=>p(()=>import("./ScanningManual-BSL0EUYu.js"),__vite__mapDeps([22,1,2,12,13,20,21,9,10])));f(()=>p(()=>import("./LoadingColorSpinner-DNqbN189.js"),__vite__mapDeps([23,1,2,24])));const[d,U]=E(""),[$,Y]=E([]);function qe(){K({});const[e,a]=E(1),[t,s]=_e(),n=o=>()=>s(()=>a(o));oe(()=>{C()}),ce(()=>{}),de(()=>{q()&&a(0),T(X),Z()});function S(){return"geolocation"in navigator}function k(o){he({latitude:o?.coords?.latitude,longitude:o?.coords?.longitude})}function C(){S()?navigator.geolocation.getCurrentPosition(k):showMessage("Geolocation isn't supported by your browser")}const M=()=>ye?.list?.filter(o=>o.id);return(()=>{var o=Oe(),ee=o.firstChild,te=ee.nextSibling,D=te.nextSibling,O=D.nextSibling;return l(D,i(Ge,{get list(){return M()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return d()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:r=>U(r.id),width:"260px"})),l(O,i(V,{get when(){return d()},get children(){return[(()=>{var r=Ee(),y=r.firstChild,u=y.firstChild,x=u.firstChild,g=y.nextSibling,h=g.firstChild,w=h.firstChild;return R(y,"click",n(0),!0),l(x,i(B,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),R(g,"click",n(1),!0),l(w,i(B,{name:"keyboard",size:32,color:"#2b2b2b"})),L(c=>{var v=e()===0,I=e()===1;return v!==c.e&&y.classList.toggle("selected",c.e=v),I!==c.t&&g.classList.toggle("selected",c.t=I),c},{e:void 0,t:void 0}),r})(),(()=>{var r=Me();return l(r,i(ue,{get fallback(){return Pe()},get children(){return i(ge,{get children(){return[i(G,{get when(){return e()===0},get children(){return i(Ve,{get status(){return d()},get locat(){return d()}})}}),i(G,{get when(){return e()===1},get children(){return i(We,{get status(){return d()},get locat(){return d()}})}})]}})}})),L(()=>r.classList.toggle("pending",!!t())),r})()]}}),null),l(O,i(V,{get when(){return $()?.length>0},get children(){return[De(),i(be,{get each(){return fe($(),"timeStamp",0)},children:(r,y)=>(()=>{var u=Fe(),x=u.firstChild,g=x.firstChild,h=g.nextSibling,w=h.nextSibling,c=x.nextSibling,v=c.firstChild,I=v.nextSibling,ae=I.nextSibling;return l(g,i(B,{get name(){return m("M023009")?.statusListIcons?.[r?.currentStatus]},size:32})),h.style.setProperty("padding","8px"),l(h,()=>r?.idairguide),w.style.setProperty("padding","8px"),l(w,()=>r?.tracking),l(u,i(Re,{}),c),l(v,()=>r?.city),l(ae,()=>r?.consigneeInfo?.ybestate),L(()=>W(u,`client_item_box gWXAaj jlytmu manifest  ${q()?"isMobile":"centerBx"}`)),u})()})]}}),null),L(()=>W(o,ve.App)),o})()}pe(["click"]);const Xe=Object.freeze(Object.defineProperty({__proto__:null,default:qe,scannedQRs:Ae,setScannedQRs:je,setStatus:U,setTaskScan:Y,status:d,taskScan:$},Symbol.toStringTag,{value:"Module"}));export{Xe as S,Ke as a,T as b,Ne as c,X as d,Be as h,Z as i,Te as l};
