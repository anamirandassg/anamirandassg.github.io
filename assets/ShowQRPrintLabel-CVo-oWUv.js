import{P as L,f as S,r as b}from"./fontkit.es-DEjOtITv.js";import"./qrcode-C5vWJp7P.js";import{i as v,t as i}from"./InitPrintServices-BI_Od3nu.js";import{OpenToast as R}from"./Toast-C-ZHc6Nk.js";import{g as _}from"./Util-dbxHFpkD.js";const M=o=>{let s=window.DATAMatrix;return s({msg:o,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1})},B=o=>{let n=o.cloneNode(!0).outerHTML,t=new Blob([n],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(t)},C=async(o,s)=>{const n=document.createElement("img");document.body.appendChild(n),n.onload=function(){const t=document.createElement("canvas");t.width=n.clientWidth,t.height=n.clientHeight,t.getContext("2d").drawImage(n,0,0);const w=t.toDataURL("image/png");document.body.removeChild(n),s(w)},n.src=o},E=o=>new Promise(async(s,n)=>{let t=M(o),e=B(t);C(e,async w=>{var d=await D(w,"image/png");let a=URL.createObjectURL(d);s(a)})}),D=async(o,s)=>{let t=await(await fetch(o)).blob();return t=t.slice(0,t.size,s),t},j=o=>{window.navigator.clipboard.writeText(o),R({text:o+"  copiado",timeout:1500,id:_()})};function P(o){let s=new Blob([o],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(s)}const z=(o,s,n)=>{const t=s.widthOfTextAtSize(o,40),e=s.widthOfTextAtSize(o,10);return Math.floor(n/((t-e)/30))},q=async(o,s,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t);let w=265;const d=o.map(async(a,p)=>{const r=t.addPage([426,284]),{height:g}=r.getSize();let l=g-34;const h=await fetch(a?.qr).then(y=>y.arrayBuffer()),x=await t.embedPng(h);r&&x&&r.drawImage(x,{x:10,y:g-220,width:150,height:150}),a?.tracking?.length<14&&r.drawText(i(a?.tracking),{x:172,y:l-175,size:36,font:e.roboto_bold,color:b(0,0,0)});let f=z(i(a?.state),e.roboto_bold,w);f>42&&(f=42,l=l-6);let c=z(i(a?.name),e.GSansItalic,w);var u=e.GSansItalic?.widthOfTextAtSize(i(a?.name),c);if(u>w&&(c=c-1,u=e.GSansItalic?.widthOfTextAtSize(i(a?.name),c)),c=300/u*21,c=c>25?25:c,r.drawText(i(a?.name),{x:10,y:l-0,size:c,font:e.GSansItalic,color:b(0,0,0)}),a?.state){const y=e.roboto_bold?.widthOfTextAtSize(i(a?.state),f);r.drawText(i(a?.state),{x:420-y,y:l-46,size:f,font:e.roboto_bold,color:b(0,0,0)}),l=l-c}let m=29;const A=e.Lexend_700?.widthOfTextAtSize(i(a?.phoneNumber),m);r.drawText(i(a?.phoneNumber),{x:400-A,y:l-70,size:m,font:e.Lexend_700,color:b(0,0,0)});const O=e.Lexend_700?.widthOfTextAtSize(i(a?.altPhoneNumber),m);r.drawText(i(a?.altPhoneNumber),{x:400-O,y:l-105,size:m,font:e.Lexend_700,color:b(0,0,0)});let T=i(a?.bulto).trim();const U=e.Lexend_700?.widthOfTextAtSize(i(T),40);r.drawText(i(T),{x:418-U,y:l-205,size:40,font:e.GSansBold,color:b(0,0,0)})});await Promise.all(d);{const a=await t.save();return P(a)}},H=async(o,s,n)=>{const t=await L.create();t.registerFontkit(S);const e=await v(t),w=o.map(async(d,a)=>{let p=2.795;const r=t.addPage([45*p,24*p]),{height:g}=r.getSize(),l=await fetch(d?.mtrx).then(c=>c.arrayBuffer()),h=await t.embedPng(l),x=await fetch(d?.mtrx2).then(c=>c.arrayBuffer()),f=await t.embedPng(x);r&&h&&r.drawImage(h,{x:0,y:g-32,width:30,height:30}),r.drawText(i(d?.lbl),{x:33,y:g-20,size:13,font:e.Lexend_700,color:b(0,0,0)}),r&&f&&r.drawImage(f,{x:0,y:g-66,width:30,height:30}),r.drawText(i(d?.lbl2),{x:33,y:g-56,size:13,font:e.Lexend_700,color:b(0,0,0)})});await Promise.all(w);{const d=await t.save();return P(d)}};export{q as S,j as c,E as g,H as l};
