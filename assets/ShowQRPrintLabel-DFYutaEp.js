import{P as v,f as O,r as d}from"./fontkit.es-yAesCE8D.js";import{q as $}from"./qrcode-DHy8FFhS.js";import{i as C,t as a}from"./InitPrintServices-tbDVtYPt.js";import{OpenToast as Z}from"./Toast-BLqoE13e.js";import{a as K,e as A,O as B}from"./Util-CJwQ4eI5.js";const J=s=>{let i=window?.DATAMatrix;return i?i({msg:s,dim:256,rct:0,pad:2,pal:["#000000","#ffffff"],vrb:1}):null},V=s=>{let h=s.cloneNode(!0).outerHTML,o=new Blob([h],{type:"image/svg+xml;charset=utf-8"});return(window.URL||window.webkitURL||window).createObjectURL(o)},X=async(s,i)=>{const h=document.createElement("img");document.body.appendChild(h),h.onload=function(){const o=document.createElement("canvas");o.width=h.clientWidth,o.height=h.clientHeight,o.getContext("2d").drawImage(h,0,0);const f=o.toDataURL("image/png");document.body.removeChild(h),i(f)},h.src=s},ct=s=>new Promise(async(i,h)=>{let o=J(s),t=o&&V(o);t&&X(t,async f=>{var p=await tt(f,"image/png");let e=URL.createObjectURL(p);i(e)})}),dt=s=>new $.QRCodeCanvas(s+"").toDataUrl(),tt=async(s,i)=>{let o=await(await fetch(s)).blob();return o=o.slice(0,o.size,i),o},lt=s=>{window.navigator.clipboard.writeText(s),Z({text:s+"  copiado",timeout:1500,id:K()})};function N(s){let i=new Blob([s],{type:"application/pdf"});return(window.URL||window.webkitURL).createObjectURL(i)}const I=(s,i,h)=>{const o=i.widthOfTextAtSize(s,40),t=i.widthOfTextAtSize(s,10);return Math.floor(h/((o-t)/30))},ht=async(s,i,h)=>{const o=await v.create();o.registerFontkit(O);const t=await C(o);let f=265;const p=s.map(async(e,m)=>{const n=o.addPage([426,284]),{height:g}=n.getSize();let r=g-34;const S=await fetch(e?.qr).then(l=>l.arrayBuffer()),L=await o.embedPng(S);n&&L&&n.drawImage(L,{x:10,y:g-220,width:150,height:150});let u=I(a(e?.state),t.roboto_bold,f);u>42&&(u=42,r=r-6);let y=a(e?.bulto).trim();const _=t.Lexend_700?.widthOfTextAtSize(a(y),33);if(e?.isSSG){e?.state&&n.drawText(a(e?.state),{x:5,y:r-6,size:u,font:t.roboto_bold,color:d(0,0,0)}),n.drawText(a(y),{x:18,y:g-270,size:40,font:t.GSansBold,color:d(0,0,0)});const l=await fetch(A("SSG-black.png")).then(z=>z.arrayBuffer()),c=await o.embedPng(l);if(n&&c&&n.drawImage(c,{x:210,y:g-232,width:190,height:190}),e?.lbss){const z=t.Lexend_700?.widthOfTextAtSize("LBS: "+a(e?.lbss?.toFixed(2)),32);n.drawText("LBS: "+a(e?.lbss?.toFixed(2)),{x:418-z,y:r-8,size:32,font:t.Lexend_700,color:d(0,0,0)})}}else{let l=I(a(e?.name),t.GSansItalic,f);var w=t.GSansItalic?.widthOfTextAtSize(a(e?.name),l);if(w>f&&(l=l-1,w=t.GSansItalic?.widthOfTextAtSize(a(e?.name),l)),l=300/w*21,l=l>25?25:l*1,n.drawText(a(e?.name),{x:10,y:r-0,size:l,font:t.GSansItalic,color:d(0,0,0)}),e?.state){const b=t.roboto_bold?.widthOfTextAtSize(a(e?.state),u);n.drawText(a(e?.state),{x:420-b,y:r-46,size:u,font:t.roboto_bold,color:d(0,0,0)}),r=r-l}let c=29;const z=t.Lexend_700?.widthOfTextAtSize(a(e?.phoneNumber),c);n.drawText(a(e?.phoneNumber),{x:400-z,y:r-70,size:c,font:t.Lexend_700,color:d(0,0,0)});const G=t.Lexend_700?.widthOfTextAtSize(a(e?.altPhoneNumber),c);if(n.drawText(a(e?.altPhoneNumber),{x:400-G,y:r-105,size:c,font:t.Lexend_700,color:d(0,0,0)}),e?.lbss){const b=t.Lexend_700?.widthOfTextAtSize("LBS: "+a(e?.lbss?.toFixed(2)),32);n.drawText("LBS: "+a(e?.lbss?.toFixed(2)),{x:418-b,y:r-155,size:32,font:t.Lexend_700,color:d(0,0,0)})}n.drawText(a(y),{x:418-_,y:r-160,size:33,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.street),{x:2,y:r-189,size:12,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.city),{x:2,y:r-209,size:12,font:t.GSansBold,color:d(0,0,0)})}});await Promise.all(p);{const e=await o.save();return N(e)}},wt=async(s,i,h)=>{const o=await v.create();o.registerFontkit(O);const t=await C(o),f=s.map(async(p,e)=>{let m=2.795;const n=o.addPage([45*m,24*m]),{height:g}=n.getSize(),r=await fetch(p?.mtrx).then(x=>x.arrayBuffer()),S=await o.embedPng(r),L=await fetch(p?.mtrx2).then(x=>x.arrayBuffer()),u=await o.embedPng(L);n&&S&&n.drawImage(S,{x:0,y:g-32,width:30,height:30}),n.drawText(a(p?.lbl),{x:33,y:g-20,size:13,font:t.Lexend_700,color:d(0,0,0)}),n&&u&&n.drawImage(u,{x:0,y:g-66,width:30,height:30}),n.drawText(a(p?.lbl2),{x:33,y:g-56,size:13,font:t.Lexend_700,color:d(0,0,0)})});await Promise.all(f);{const p=await o.save();return N(p)}},bt=async(s,i,h)=>{const o=await v.create();o.registerFontkit(O);const t=await C(o);let f=265;const p=s.map(async(e,m)=>{const n=o.addPage([426,284]),{height:g}=n.getSize();let r=g-34,S=I(a(e?.state),t.roboto_bold,f);S>42&&(S=42,r=r-6);let u=a(e?.bulto).trim();n.drawText("("+e?.currency+") $"+(a(e?.amount)*1).toFixed(2),{x:10,y:g-260,size:45,font:t.Lexend_700,color:d(0,0,0)});let x=I(a(e?.name),t.GSansItalic,f);var y=t.GSansItalic?.widthOfTextAtSize(a(e?.name),x);y>f&&(x=x-1,y=t.GSansItalic?.widthOfTextAtSize(a(e?.name),x)),x=300/y*21,x=x>25?25:x,n.drawText(a(e?.name),{x:10,y:r-0,size:x,font:t.GSansItalic,color:d(0,0,0)});let _=29;if(e?.state){let c="CID: "+e?.state;const z=t.roboto_bold?.widthOfTextAtSize(a(c),_);n.drawText(a(c),{x:410-z,y:r-46,size:_,font:t.roboto_bold,color:d(0,0,0)}),r=r-_}let w=29;const l=t.Lexend_700?.widthOfTextAtSize(a(e?.phoneNumber),w);n.drawText(a(e?.phoneNumber),{x:400-l,y:r-60,size:w,font:t.Lexend_700,color:d(0,0,0)}),n.drawText(a(u),{x:10,y:r-95,size:10,font:t.GSansBold,color:d(0,0,0)}),n.drawText(a(e?.rpto),{x:10,y:r-115,size:12,font:t.Lexend_700,color:d(0,0,0)}),n.drawText(a(e?.city),{x:10,y:r-135,size:15,font:t.roboto_bold,color:d(0,0,0)})});await Promise.all(p);{const e=await o.save();return N(e)}},F=(s,i)=>i?" "+s+" "+i:"",et=s=>`${F("Calle",s?.streetName)}${F("#",s?.streetNo)}${F("E/",s?.betwen)}`,ft=async(s,i,h)=>{const o=await v.create();o.registerFontkit(O);const t=await C(o),f=await fetch(A("icon_cellphone")).then(w=>w.arrayBuffer()),p=await o.embedPng(f),e=await fetch(A("icon_receipt")).then(w=>w.arrayBuffer()),m=await o.embedPng(e),n=await fetch(A("icon_home")).then(w=>w.arrayBuffer()),g=await o.embedPng(n),r=await fetch(A("icon_open_package_file_outline")).then(w=>w.arrayBuffer()),S=await o.embedPng(r),L=await fetch(A("icon_user")).then(w=>w.arrayBuffer()),u=await o.embedPng(L);let x=50,y=0,_={0:[]};s.map(w=>{let l=12,c=i[w];l+=B(c?.customers).length*14,B(c?.customers).map(z=>{l+=B(c?.customers?.[z]?.bagsNumb).length*13}),l+=13,x+l>870&&(y+=1,_[y]||(x=50,_[y]=[])),x+=l,c.height=l,_[y].push(c)}),B(_).map((w,l)=>{const c=o.addPage(),{height:z,width:G}=c.getSize();let b=z-34;_[w].map(async(T,M)=>{b-T.height,M%2&&c?.drawRectangle({x:5,y:b-T.height+15,width:585,height:T.height,color:d(.895,.895,.895)});let W=et(T?.address)+", Rpto "+a(T?.address?.rpto)+" |  "+a(T?.city)+"  |  "+a(T?.estate);c.drawText(""+W.toUpperCase(),{x:24,y:b,size:7,font:t.roboto_bold,color:d(0,0,0)}),g&&c.drawImage(g,{x:10,y:b-3,width:12,height:12}),b=b-12,B(T?.customers).map(D=>{let P=T?.customers[D],q="Recibe:     "+P?.phoneNumber+"       "+D+" | "+P?.name+":  ___________________";var U=t.Lexend_700?.widthOfTextAtSize("Recibe: ",8.5);c.drawText(""+q,{x:23,y:b,size:8.5,font:t.Lexend_700,color:d(0,0,0)}),p&&c.drawImage(p,{x:U+23,y:b-3,width:10,height:10});let E="     "+P?.phoneNumber;var Q=t.Lexend_700?.widthOfTextAtSize(E,8.5);u&&c.drawImage(u,{x:U+23+Q,y:b-3,width:10,height:10}),b=b-14,B(P?.bagsNumb).map(k=>{let R="HBLS: ";P?.bagsNumb?.[k]?.hbls.map(Y=>{R+=Y?.hbl+"; "});let j=R+"         Bolso: "+P?.bagsNumb?.[k]?.bagnumber;m&&c.drawImage(m,{x:27,y:b-2,width:9,height:9}),c.drawText(""+j,{x:39,y:b,size:8,font:t.roboto_bold,color:d(0,0,0)});var H=t.roboto_bold?.widthOfTextAtSize(R+"  ",8);S&&c.drawImage(S,{x:H+39,y:b-2,width:9,height:9}),b=b-13})}),b=b-13})});{const w=await o.save();return N(w)}},gt=async s=>{const i=await v.create();i.registerFontkit(O);const h=await C(i),o=s.map(async(f,p)=>{const e=i.addPage([142,71]),{height:m}=e.getSize();if(f?.qr)try{const n=await fetch(f?.qr).then(r=>r.arrayBuffer()),g=await i.embedPng(n);g&&e.drawImage(g,{x:5,y:m-45,width:35,height:35})}catch(n){console.log(n)}e.drawText(a(f?.lbl),{x:50,y:m-27,size:9,font:h.Lexend_700,color:d(0,0,0)}),e.drawText(a(f?.lbl2),{x:4,y:m-62,size:7,font:h.Lexend_700,color:d(0,0,0)})});await Promise.all(o);const t=await i.save();return N(t)};export{bt as C,ft as P,ht as S,dt as a,tt as b,lt as c,gt as d,ct as g,wt as l};
