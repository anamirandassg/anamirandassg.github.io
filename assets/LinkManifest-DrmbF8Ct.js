const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-B6jiXU73.js","assets/index-DLm-qbVb.js","assets/index-DGSEMnLR.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-B6X7A5rV.js","assets/debounces-_rTXI1rL.js","assets/SVG-DMQC_3si.js","assets/index-Ci0zXM0r.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-CzkegoSq.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-D18rooUI.js","assets/Util-R0w8Fgio.js","assets/DialogHRM-D2-DGr3N.js","assets/DialogHRM-V9_lZntj.css","assets/globalSignal-DG1rgUS8.js","assets/manifestList-CSHEgbpJ.js","assets/fontkit.es-DEjOtITv.js","assets/InitPrintServices-CHWoTnax.js"])))=>i.map(i=>d[i]);
import{l as P,_ as E,c as B,a as ge,u as _e,C as be,o as he,h as pe,m as fe,b as me,i as l,d as g,f as oe,e as ve,t as $,z as X,S as j,D as ye,q as xe,F as ke,E as we,s as Se}from"./index-DLm-qbVb.js";import{w as $e,p as Ae,m as Ce}from"./manifestList-CSHEgbpJ.js";import{f as z,O as k,h as De,g as ce,p as Le}from"./Util-R0w8Fgio.js";import{u as Oe}from"./debounces-_rTXI1rL.js";import{i as Z}from"./globalSignal-DG1rgUS8.js";import{P as Me,f as Be,r as x}from"./fontkit.es-DEjOtITv.js";import{i as Pe,t as v,b as Ee}from"./InitPrintServices-CHWoTnax.js";import"./index-Ci0zXM0r.js";const ze=(a,o,e)=>{const n=o.widthOfTextAtSize(a,40),s=o.widthOfTextAtSize(a,10);return Math.floor(e/((n-s)/30))},Te=async(a,o,e)=>{const n=await Me.create();n.registerFontkit(Be);const s=await Pe(n);let f=265,p=30,w=Math.ceil(a.length/p);Array.from(Array(w).keys()).map(S=>{let V=a.slice(S*p,(S+1)*p);const h=n.addPage(),{height:A}=h.getSize();let T=A-74;V.map((_,I)=>{let c=T;I%2&&h?.drawRectangle({x:10,y:c-15,width:580,height:24,color:x(.7,.7,.7)});let K=ze(v(_?.state),s.roboto_bold,f),G=0;K>42&&(K=42,c=c-6);let q=_?.bagnumber;const H=s.Lexend_700.widthOfTextAtSize(v(q),5);h.drawText(v(q),{x:575-H,y:c-3,size:5,font:s.Lexend_700,color:x(0,0,0)});let F=_?.consigneeInfo?.ybcity+" | "+_?.consigneeInfo?.ybestate;const Q=s.Lexend_700.widthOfTextAtSize(v(F),7);_?.cidentity&&h.drawText(v(_?.cidentity),{x:25,y:c+3,size:7,font:s.Lexend_700,color:x(0,0,0)}),_?.consigneeInfo?.ybestate&&h.drawText(v(F),{x:575-Q,y:c+3,size:7,font:s.Lexend_700,color:x(0,0,0)});let t="";_?.hbls.map((r,u)=>{t+=(u>0?"  |  ":"")+r?.hbl}),h.drawText(v(t),{x:45,y:c-3,size:5,font:s.Lexend_700,color:x(0,0,0)}),G+=_?.pricePP*_?.totalWeight,T=c-18}),h.drawText("Guia: "+v(e?.guia),{x:17,y:A-22,size:12,font:s.Lexend_700,color:x(0,0,0)}),h.drawText("Fecha: "+v(e?.date),{x:19,y:A-35,size:10,font:s.Lexend_700,color:x(0,0,0)})});{const S=await n.save();return Ee(S)}};var Ie=$("<h5>"),qe=$("<div style=padding:4px>"),Fe=$('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div><div class="icon align_itm"></div></div><div><div class="icon align_itm">'),Ne=$('<div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h5></h5><h4></h4><h4></h4></div></div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Re=$("<div> <!>."),We=$("<div> ");const je=P(()=>E(()=>import("./LoadingColorSpinner-B6jiXU73.js"),__vite__mapDeps([0,1,2,3]))),de=P(()=>E(()=>import("./DropDwnSearch-B6X7A5rV.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),Ye=P(()=>E(()=>import("./InputHr-CzkegoSq.js"),__vite__mapDeps([9,1,2,10]))),ee=P(()=>E(()=>import("./SVG-DMQC_3si.js"),__vite__mapDeps([6,1,2,7]))),Ve=P(()=>E(()=>import("./ItemOnManifestList-D18rooUI.js"),__vite__mapDeps([11,1,2,12,7,5,13,14,15,16,17,18]))),[M,Y]=B({list:{}}),[st,nt]=ge("");function lt(){const[a,o]=_e(),[e,n]=B({search:""}),[s,f]=B(),[p,w]=B(),S=be(),[V,h]=B(),[A,T]=ge(""),_=Oe(T,400),I=(t,r)=>{n({[t]:r}),_(ce())};he(()=>{Y("list",void 0)}),pe(()=>{}),fe(async()=>{let t=[];[33,46,40,41,42,50,52,54,56].map(d=>{let m=$e?.[d];X?.roles?.[m?.id]?.isActive&&t.push(m)}),h("list",t);let u=[];if(Ae.map(d=>{let b=d.label;X?.roles?.[b]?.isActive&&u.push(d)}),h("prov",u),a?.mId){let d={id:a?.mId},b=await Qe(d);n("province",b?.province),n("city",b?.city),n("manifestObj",b),w("linked",b?.linkedBags)}});const[c,{refetch:K}]=me(A,async t=>{let r=e?.manifest?.id,u=e?.province,d=u&&e?.city,b=[];if(r){const m=await Ke(e.search,r,u,d);f("bags",m),k(m).map(C=>{let D=m[C],N=D.currentStatus;X?.roles?.[N]?.isActive&&N.split("_")?.[1]>=33&&b.push(D)})}return b}),G=(t,r)=>{n({[t]:r}),_(ce()),Y("list",void 0),setTimeout(()=>{Y("list",{})},670)},q=()=>{let t={},r=0;k(M?.list)?.length!==c()?.length?(r=1,c().map(u=>{let d=u.ssg_track_key;t[d]=r})):c().map(u=>{let d=u.ssg_track_key;t[d]=void 0}),Y("list",t)},H=async()=>{let t={...p?.linked};k(M?.list).map(r=>{t?.[r]||(t[r]={idairguide:s?.bags?.[r]?.idairguide})}),w("linked",t),await Ge({ssg_manifest_key:a?.mId},{linkedBags:t}),S("/manifest",{replace:!0})},F=()=>{let t=[];k(M?.list).map(r=>{s?.bags?.[r]&&t.push(s?.bags?.[r])}),Q(t)},Q=async t=>{let r=await Te(t,!0,{guia:t[0]?.idairnumber,date:Le()});window.open(r)};return(()=>{var t=Ne(),r=t.firstChild,u=r.firstChild,d=u.firstChild,b=d.nextSibling,m=b.nextSibling,C=r.nextSibling,D=C.firstChild,N=D.nextSibling,R=C.nextSibling;return l(d,()=>e?.manifestObj?.ssg_manifest_key),l(b,()=>e?.manifestObj?.name),l(u,g(j,{get when(){return e?.manifestObj?.city},get children(){return["|",(()=>{var i=Ie();return l(i,()=>e?.manifestObj?.city),i})()]}}),m),l(m,()=>e?.manifestObj?.province),l(D,g(de,{list:Ce,lbl_empty:"Guia",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:i=>G("manifest",i),width:"260px"})),l(N,g(de,{get list(){return V?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:i=>I("warehouse",i),width:"260px"})),l(C,g(j,{get when(){return e?.manifest?.id},get children(){var i=qe();return l(i,g(Ye,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return e?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:y=>I("search",y)})),i}}),null),l(R,g(j,{get when(){return ye(()=>!!e?.manifest?.id)()&&c().length>0},get children(){var i=Fe(),y=i.firstChild,W=y.firstChild,L=y.nextSibling,U=L.firstChild,te=U.firstChild,re=te.nextSibling;re.nextSibling;var ue=L.nextSibling,J=ue.nextSibling,ie=J.firstChild,ae=J.nextSibling,se=ae.firstChild;return i.style.setProperty("margin","18px 0"),W.$$click=q,l(W,g(ee,{get name(){return k(M?.list)?.length<c()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),l(U,()=>k(M?.list)?.length,te),l(U,()=>c()?.length,re),ie.$$click=H,l(ie,g(ee,{name:"link",color:"var(--background-red-ssg)"})),se.$$click=F,l(se,g(ee,{name:"printer",color:"var(--background-red-ssg)"})),oe(O=>{var ne=` ${Z()?"tr_bar_15":"tr_bar_05"} tr_bar  align_itm centerBx"`,le=` ${Z()?"tr_bar_10":"tr_bar_05"} tr_bar  align_itm centerBx"`;return ne!==O.e&&(J.className=O.e=ne),le!==O.t&&(ae.className=O.t=le),O},{e:void 0,t:void 0}),i}}),null),l(R,g(we,{fallback:i=>(()=>{var y=Re(),W=y.firstChild,L=W.nextSibling;return L.nextSibling,l(y,()=>i.toString(),L),y})(),get children(){return g(xe,{get fallback(){return(()=>{var i=We();return i.firstChild,l(i,g(je,{stroke:"rgb(200 25 60 / 1)",size:62}),null),i})()},get children(){return g(j,{get when(){return c()},get children(){return g(ke,{get each(){return c()},children:i=>g(Ve,{item:i,get isAlready(){return p?.linked?.[i.ssg_track_key]}})})}})}})}}),null),oe(i=>Se(R,` ${Z(),"width:86vw;"} margin: 0 auto;`,i)),t})()}const Ke=async(a,o,e,n)=>{let s={params:{idairguide:o},query:"getScanLogisticYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5 AND currentStatus = :status AND estate = :estate AND city = :city"};a&&a.split(" ").map((p,w)=>{p&&(s.params[":search"+w]=p.trim())}),e&&(s.params[":estate"]=e),n&&(s.params[":city"]=n);const f=await z(s);return f?.error?{}:f},Ge=async(a,o)=>{const n=await z({params:a,query:"updateManifestYabaExpress",data2update:o}),s=k(o?.linkedBags).map(async(f,p)=>{await He({ssg_track_key:f,idairguide:o?.linkedBags?.[f]?.idairguide},{currentManifestKey:a?.ssg_manifest_key})});return await Promise.all(s),n},He=async(a,o)=>await z({params:a,query:"updateLogisticYabaExpress",data2update:o}),Qe=async a=>await z({params:a,query:"getManifestOrderByKeyID"}),ot=async a=>{let o=[];a.map(e=>{let n={params:{id:e?.ssg_track_key,idairguide:e?.idairguide},query:"getLogisticOrderByKeyID"};o.push(n)}),De(o,Ue)},Ue=async a=>{const e=await z(a);if(e)return e};ve(["click"]);export{lt as default,Ue as fetchCSVInve,ot as loadManifest,st as manifestObs,M as selectedManifest,nt as setManifestObs,Y as setSelectedManifest,Ge as updLinkedBags};
