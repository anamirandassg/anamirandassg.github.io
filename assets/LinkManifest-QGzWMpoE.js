const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-31rekYeJ.js","assets/index-B0l8WTNe.js","assets/index-C8O1wSFC.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-B2uh9hSi.js","assets/debounces-P1AazJ4v.js","assets/SVG-B_Pm6hj5.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-BTu0l7U3.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-B0P9GvpT.js","assets/DialogHRM-Bl4bJf-w.js","assets/DialogHRM-V9_lZntj.css","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/fontkit.es-D-v5Kvuq.js","assets/InitPrintServices-DuxNkdeY.js","assets/DashManifest-BdHR7Nib.js"])))=>i.map(i=>d[i]);
import{l as M,_ as O,c as L,a as Z,u as re,p as ae,k as se,q as ie,b as ne,i as p,d as c,f as le,o as j,Y as oe,e as ce,t as P,aa as de,P as W,ab as ue,a6 as ge,S as Y,a5 as pe,O as $,y as be,F as he,G as _e,h as me,g as fe,s as ve,j as J,a0 as ye}from"./index-B0l8WTNe.js";import{s as xe}from"./App.module-CbHnVtRQ.js";import{u as ke}from"./debounces-P1AazJ4v.js";import{P as we,f as Se,r as w}from"./fontkit.es-D-v5Kvuq.js";import{i as $e,t as y,b as Ae}from"./InitPrintServices-DuxNkdeY.js";import{LookupManifets as De}from"./DashManifest-BdHR7Nib.js";import"./DialogHRM-Bl4bJf-w.js";const Ce=(s,d,a)=>{const l=d.widthOfTextAtSize(s,40),i=d.widthOfTextAtSize(s,10);return Math.floor(a/((l-i)/30))},Le=async(s,d,a)=>{const l=await we.create();l.registerFontkit(Se);const i=await $e(l);let _=265,x=30,I=Math.ceil(s.length/x);Array.from(Array(I).keys()).map(S=>{let E=s.slice(S*x,(S+1)*x);const b=l.addPage(),{height:A}=b.getSize();let D=A-74;E.map((u,h)=>{let m=D;h%2&&b?.drawRectangle({x:10,y:m-15,width:580,height:24,color:w(.7,.7,.7)});let z=Ce(y(u?.state),i.roboto_bold,_),N=0;z>42&&(z=42,m=m-6);let B=u?.bagnumber;const R=i.Lexend_700.widthOfTextAtSize(y(B),5);b.drawText(y(B),{x:575-R,y:m-3,size:5,font:i.Lexend_700,color:w(0,0,0)});let T=u?.consigneeInfo?.ybcity+" | "+u?.consigneeInfo?.ybestate;const t=i.Lexend_700.widthOfTextAtSize(y(T),7);u?.cidentity&&b.drawText(y(u?.cidentity),{x:25,y:m+3,size:7,font:i.Lexend_700,color:w(0,0,0)}),u?.consigneeInfo?.ybestate&&b.drawText(y(T),{x:575-t,y:m+3,size:7,font:i.Lexend_700,color:w(0,0,0)});let r="";u?.hbls.map((o,n)=>{r+=(n>0?"  |  ":"")+o?.hbl}),b.drawText(y(r),{x:45,y:m-3,size:5,font:i.Lexend_700,color:w(0,0,0)}),N+=u?.pricePP*u?.totalWeight,D=m-18}),b.drawText("Guia: "+y(a?.guia),{x:17,y:A-22,size:12,font:i.Lexend_700,color:w(0,0,0)}),b.drawText("Fecha: "+y(a?.date),{x:19,y:A-35,size:10,font:i.Lexend_700,color:w(0,0,0)})});{const S=await l.save();return Ae(S)}};var Me=P("<div style=padding:4px>"),Oe=P('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div class="tr_bar tr_bar_05 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_05 align_itm centerBx"><div class="icon align_itm">'),Pe=P('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Ie=P("<div> <!>."),Ee=P("<div> ");const ze=M(()=>O(()=>import("./LoadingColorSpinner-31rekYeJ.js"),__vite__mapDeps([0,1,2,3]))),X=M(()=>O(()=>import("./DropDwnSearch-B2uh9hSi.js"),__vite__mapDeps([4,1,2,5,6,7]))),Be=M(()=>O(()=>import("./InputHr-BTu0l7U3.js"),__vite__mapDeps([8,1,2,9]))),q=M(()=>O(()=>import("./SVG-B_Pm6hj5.js"),__vite__mapDeps([6,1,2]))),Te=M(()=>O(()=>import("./ItemOnManifestList-B0P9GvpT.js"),__vite__mapDeps([10,1,2,5,11,12,13,14,15,16,17]))),[C,V]=L({list:{}}),[Ke,Qe]=Z("");function Ue(){const[s,d]=re(),[a,l]=L({search:""}),[i,_]=L(),[x,I]=L(),[S,E]=L(),[b,A]=Z(""),D=ke(A,400),u=(t,r)=>{l({[t]:r}),D(J())};ae(()=>{V("list",void 0)}),se(()=>{}),ie(async()=>{let t=[];[33,46,40,41,42,50,52,54,56].map(n=>{let e=de?.[n];W?.roles?.[e?.id]?.isActive&&t.push(e)}),E("list",t);let o=[];if(ue.map(n=>{let f=n.label;W?.roles?.[f]?.isActive&&o.push(n)}),E("prov",o),s?.mId){let n=await De(s?.mId);l("province",n?.[s?.mId]?.province),l("city",n?.[s?.mId]?.city),l("city",n?.[s?.mId]?.city),I("linked",n?.[s?.mId]?.linkedBags)}});const[h,{refetch:m}]=ne(b,async t=>{let r=a?.manifest?.id,o=a?.province,n=o&&a?.city,f=[];const e=await Fe(a.search,r,o,n);return _("bags",e),$(e).map(g=>{let v=e[g],k=v.currentStatus;W?.roles?.[k]?.isActive&&k.split("_")?.[1]>=33&&f.push(v)}),f}),z=(t,r)=>{l({[t]:r}),D(J()),V("list",void 0)},N=()=>{let t={},r=0;$(C?.list)?.length!==h()?.length?(r=1,h().map(o=>{let n=o.ssg_track_key;t[n]=r})):h().map(o=>{let n=o.ssg_track_key;t[n]=void 0}),V("list",t)},B=async()=>{let t=x?.linked||{};$(C?.list).map(r=>{t?.[r]||(t[r]={idairguide:i?.bags?.[r]?.idairguide})}),I("linked",t),await Ne({ssg_manifest_key:s?.mId},{linkedBags:t})},R=()=>{let t=[];$(C?.list).map(r=>{i?.bags?.[r]&&t.push(i?.bags?.[r])}),T(t)},T=async t=>{let r=await Le(t,!0,{guia:t[0]?.idairnumber,date:ye()});window.open(r)};return(()=>{var t=Pe(),r=t.firstChild,o=r.firstChild,n=o.nextSibling,f=r.nextSibling;return p(o,c(X,{list:ge,lbl_empty:"Manifiesto",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return a?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:e=>z("manifest",e),width:"260px"})),p(n,c(X,{get list(){return S?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return a?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:e=>u("warehouse",e),width:"260px"})),p(r,c(Y,{get when(){return a?.manifest?.id},get children(){var e=Me();return p(e,c(Be,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return a?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:g=>u("search",g)})),e}}),null),p(f,c(Y,{get when(){return pe(()=>!!a?.manifest?.id)()&&h().length>0},get children(){var e=Oe(),g=e.firstChild,v=g.firstChild,k=g.nextSibling,F=k.firstChild,G=F.firstChild,H=G.nextSibling;H.nextSibling;var ee=k.nextSibling,K=ee.nextSibling,Q=K.firstChild,te=K.nextSibling,U=te.firstChild;return e.style.setProperty("margin","18px 0"),v.$$click=N,p(v,c(q,{get name(){return $(C?.list)?.length<h()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),p(F,()=>$(C?.list)?.length,G),p(F,()=>h()?.length,H),Q.$$click=B,p(Q,c(q,{name:"link",color:"var(--background-red-ssg)"})),U.$$click=R,p(U,c(q,{name:"printer",color:"var(--background-red-ssg)"})),e}}),null),p(f,c(_e,{fallback:e=>(()=>{var g=Ie(),v=g.firstChild,k=v.nextSibling;return k.nextSibling,p(g,()=>e.toString(),k),g})(),get children(){return c(be,{get fallback(){return(()=>{var e=Ee();return e.firstChild,p(e,c(ze,{stroke:"rgb(200 25 60 / 1)",size:62}),null),e})()},get children(){return c(Y,{get when(){return h()},get children(){return c(he,{get each(){return h()},children:e=>c(Te,{item:e,get isAlready(){return x?.linked?.[e.ssg_track_key]}})})}})}})}}),null),le(e=>{var g=xe.App,v=` ${me()?"":"width:94vw;"} margin: 0 auto;`;return g!==e.e&&fe(t,e.e=g),e.t=ve(f,v,e.t),e},{e:void 0,t:void 0}),t})()}const Fe=async(s,d,a,l)=>{let i={params:{idairguide:d},query:"getScanLogisticYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5 AND currentStatus = :status AND estate = :estate AND city = :city"};if(s&&s.split(" ").map((_,x)=>{_&&(i.params[":search"+x]=_.trim())}),a&&(i.params[":estate"]=a),l&&(i.params[":city"]=l),console.log(i),d&&Object.keys(i.params).length>=2){const _=await j(i);return _?.error?{}:_}return{}},Ne=async(s,d)=>await j({params:s,query:"updateManifestYabaExpress",data2update:d}),Je=async s=>{let d=[];s.map(a=>{let l={params:{id:a?.ssg_track_key,idairguide:a?.idairguide},query:"getLogisticOrderByKeyID"};d.push(l)}),oe(d,Re)},Re=async s=>{const a=await j(s);if(a)return a};ce(["click","mousemove","mouseout"]);export{Ue as default,Re as fetchCSVInve,Je as loadManifest,Ke as manifestObs,C as selectedManifest,Qe as setManifestObs,V as setSelectedManifest,Ne as updLinkedBags};
