const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-C-3eDiKf.js","assets/index-C7oM_mOn.js","assets/index-BRlA1Q7g.css","assets/Util-B-FWhTQW.js","assets/FlexSpace-DGRW1pMq.js","assets/DropDwnSearch-UFDcv-ly.js","assets/debounces-BumeuoSD.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-DawRi6UY.js","assets/html5-qrcode-scanner-CJxOR5k8.js","assets/Toast-BLB8QB9E.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-BaKlxCMx.js","assets/DialogHRM-ZtVsyUqE.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-CsWTCPeT.js","assets/ShowQRPrintLabel-MKCyo4QR.js","assets/fontkit.es-Dye5NabB.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-ByvuCY7T.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-Cklo08ID.js","assets/LoadingColorSpinner-BmbRs2O8.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{X as R,g as G,B as re,A as K,Y as ie,c as H,l as p,_ as y,a as M,b as le,o as oe,d as ce,i as c,e as o,Q as V,f as $,z as de,U as ue,V as W,S as q,F as ge,m as Q,j as z,h as be,t as m,W as _e,Z as fe,O as pe}from"./index-C7oM_mOn.js";import{s as ye}from"./App.module-CbHnVtRQ.js";import{u as d,q as me,S as N,e as k,O as he,I as T,T as U,g as E,f as X,U as ve,H as Se,G as ke}from"./Util-B-FWhTQW.js";import"./Toast-BLB8QB9E.js";let we=[400,300,400,300,400],Z=[300,80,300,80,300,80,300];const Le=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let t=e.split("/")?.[0];return t.indexOf("230")>=0&&(t="230"+(t.split("230")?.[1]).slice(0,6)),t.indexOf("231")>=0&&(t="231"+(t.split("231")?.[1]).slice(0,5)),{params:{":search0":t},code:1}},Ye=async(e,a)=>{let t=Le(e),s={timeStamp:new Date().getTime(),latitude:R?.latitude,longitude:R?.longitude,statusId:a,userId:G?.profile?.userId,userName:G?.profile?.name};if(a&&t?.params)return await xe(t.params,s);{let n=t?.txt||t?.params?.[":search0"];return navigator.vibrate(Z),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},xe=async(e,a)=>{let t=null;if(re()){let s=k("manifestByHbls")?.[e?.[":search0"]],n=k("manifestByKeys")?.[s];t=Ie(n,a)}else{let s=await $e(e),n=he(s)?.[0];s?.[n]?.guia&&(t=(await Be({":search0":n,idairguide:s?.[n]?.guia},a))?.data)}if(t?.code===203||t?.code===303)return navigator.vibrate(we),{error:{alert:"warning",color:"#FF6F1D",scanData:t.data}};if(t?.code===200){navigator.vibrate(500);let s={...t.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),se([...C(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:t.data}}}else if(!t||t?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(Z),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},Ie=(e,a)=>{let t={currentStatus:a?.statusId};if(e?.isSSG&&K?.roles?.SSG?.isActive,!K?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};if(k("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId===a.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let s={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},n={...a};n.ssg_track_key=e?.ssg_track_key,n.ssg_scan_key=ve();let r={form:n,itmN:s,params:{airguide:e?.guia},actionKey:815005};T.post(r,function(i,O){i||console.log("successfully posted on queue")});let g={...n};g.id=g.ssg_scan_key,g._id=g.ssg_scan_key,U.put(g,function(i,O){i||console.log("Successfully posted")});let w={...k("ScannedLocByKey")};return w[e?.ssg_track_key]=n,d("ScannedLocByKey",w),P(j),{code:200,data:{...s,...t}}},Be=async(e,a)=>{let t={params:e,form:a},s=E(802001);return s=E(802008),t={...t,...s},await X(t)},$e=async(e,a)=>{let t={params:e},s=E(265002);return t={...t,...s},await X(t)},P=async e=>{T.allDocs({include_docs:!0,descending:!0},function(a,t){e(t.rows)})},j=e=>{let a={};e?.map(t=>{let s=t?.doc?.ssg_track_key,n=t?.doc?.data2update?.currentStatus;a[s]||(a[s]={}),a[s][n]||(a[s][n]=1)}),d("alredyScan",a),Me(),ie(e?.length)},Y=async()=>{let e=await Ce(),a={},t={},s={};return e.map(n=>{n?.doc?.hbls?.map(r=>{t[r?.hbl]||(t[r?.hbl]=n?.doc?.ssg_track_key,s[r?.hbl]=n?.doc)}),a[n?.doc?.ssg_track_key]||(a[n?.doc?.ssg_track_key]=n?.doc,a[n?.doc?.ssg_track_key].key=n?.key)}),d("manifestByKeys",a),d("manifestByHbls",t),d("hblsObjDBInd",s),a},Ce=()=>new Promise((e,a)=>{N.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Oe=async()=>{let e=await De(),a={};e?.map(t=>{let s=t?.doc?.params?.ssg_manifest_key;a[s]||(a[s]=t?.doc)}),d("alinkM",a)},De=()=>new Promise((e,a)=>{Se.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Ee=async()=>{let e=await J(),a={};return e?.map(t=>{let s=t?.doc?.ssg_manifest_key;a[s]=t?.doc}),d("manifestList",a),a},J=()=>new Promise((e,a)=>{me.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),Je=async()=>((await J())?.map(a=>{N.remove(a?.doc,function(s,n){})}),1),Me=async()=>{await ee()},et=async()=>{await Ee(),await ee(),await Oe(),P(j),Y()},Pe=()=>new Promise((e,a)=>{U.allDocs({include_docs:!0,descending:!0},function(t,s){e(s.rows)})}),ee=async()=>{let e=await Pe(),a={},t={};return e?.map(s=>{let n=s?.doc?.ssg_scan_key,r=s?.doc?.ssg_track_key;a[n]=s?.doc,t[r]?t[r]?.timeStamp<s?.doc?.timeStamp&&(t[r]=s?.doc):t[r]=s?.doc}),d("ScannedLocList",a),d("ScannedLocByKey",t),a};var je=m('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Ae=m('<div class="centerBx100 ">'),Fe=m('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Re=m('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Ge=m("<div class=loader>Loading..."),Ke=m('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Ve,We]=H(),D=p(()=>y(()=>import("./SVG-C-3eDiKf.js"),__vite__mapDeps([0,1,2,3]))),qe=p(()=>y(()=>import("./FlexSpace-DGRW1pMq.js"),__vite__mapDeps([4,1,2]))),Qe=p(()=>y(()=>import("./DropDwnSearch-UFDcv-ly.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),ze=p(()=>y(()=>import("./ScanningCamera-DawRi6UY.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),He=p(()=>y(()=>import("./ScanningManual-Cklo08ID.js"),__vite__mapDeps([22,1,2,3,13,14,20,21,10,11])));p(()=>y(()=>import("./LoadingColorSpinner-BmbRs2O8.js"),__vite__mapDeps([23,1,2,24])));const[b,te]=M(""),[C,se]=M([]);function Ne(){H({});const[e,a]=M(1),[t,s]=_e(),n=i=>()=>s(()=>a(i));le(()=>{w()}),oe(()=>{}),ce(()=>{z()&&a(0),P(j),Y()});function r(){return"geolocation"in navigator}function g(i){pe({latitude:i?.coords?.latitude,longitude:i?.coords?.longitude})}function w(){r()?navigator.geolocation.getCurrentPosition(g):showMessage("Geolocation isn't supported by your browser")}const L=()=>fe?.list?.filter(i=>i.id);return(()=>{var i=Re(),O=i.firstChild,ae=O.nextSibling,A=ae.nextSibling,F=A.nextSibling;return c(A,o(Qe,{get list(){return L()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return b()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:l=>te(l.id),width:"260px"})),c(F,o(q,{get when(){return b()},get children(){return[(()=>{var l=je(),h=l.firstChild,_=h.firstChild,x=_.firstChild,f=h.nextSibling,v=f.firstChild,I=v.firstChild;return V(h,"click",n(0),!0),c(x,o(D,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),V(f,"click",n(1),!0),c(I,o(D,{name:"keyboard",size:32,color:"#2b2b2b"})),$(u=>{var S=e()===0,B=e()===1;return S!==u.e&&h.classList.toggle("selected",u.e=S),B!==u.t&&f.classList.toggle("selected",u.t=B),u},{e:void 0,t:void 0}),l})(),(()=>{var l=Ae();return c(l,o(de,{get fallback(){return Ge()},get children(){return o(ue,{get children(){return[o(W,{get when(){return e()===0},get children(){return o(ze,{get status(){return b()},get locat(){return b()}})}}),o(W,{get when(){return e()===1},get children(){return o(He,{get status(){return b()},get locat(){return b()}})}})]}})}})),$(()=>l.classList.toggle("pending",!!t())),l})()]}}),null),c(F,o(q,{get when(){return C()?.length>0},get children(){return[Fe(),o(ge,{get each(){return ke(C(),"timeStamp",0)},children:(l,h)=>(()=>{var _=Ke(),x=_.firstChild,f=x.firstChild,v=f.nextSibling,I=v.nextSibling,u=x.nextSibling,S=u.firstChild,B=S.nextSibling,ne=B.nextSibling;return c(f,o(D,{get name(){return k("M023009")?.statusListIcons?.[l?.currentStatus]},size:32})),v.style.setProperty("padding","8px"),c(v,()=>l?.idairguide),I.style.setProperty("padding","8px"),c(I,()=>l?.tracking),c(_,o(qe,{}),u),c(S,()=>l?.city),c(ne,()=>l?.consigneeInfo?.ybestate),$(()=>Q(_,`client_item_box gWXAaj jlytmu manifest  ${z()?"isMobile":"centerBx"}`)),_})()})]}}),null),$(()=>Q(i,ye.App)),i})()}be(["click"]);const tt=Object.freeze(Object.defineProperty({__proto__:null,default:Ne,scannedQRs:Ve,setScannedQRs:We,setStatus:te,setTaskScan:se,status:b,taskScan:C},Symbol.toStringTag,{value:"Module"}));export{tt as S,Ye as a,P as b,Je as c,j as d,Ee as h,Y as i,et as l};
