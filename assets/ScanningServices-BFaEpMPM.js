const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-BorztQR9.js","assets/index-DDy9UJu5.js","assets/index-D_ebk4lx.css","assets/Util-DtU7H3gG.js","assets/FlexSpace-oakX2pYv.js","assets/DropDwnSearch-Bj9ALTm7.js","assets/debounces-W8iLFydM.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-Bj7GUrwQ.js","assets/html5-qrcode-scanner-BOjvwlZz.js","assets/Toast-fgXXMRMX.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-oi3kq8FL.js","assets/DialogHRM-B6a3SgKN.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-BFjtLQ0c.js","assets/ShowQRPrintLabel-C82OTeWF.js","assets/fontkit.es-B14bDeoZ.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-DIbjXe9Q.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-DjHpg_U1.js","assets/LoadingColorSpinner-CqOoNWeg.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import{c as V,l as m,_ as S,a as F,b as ce,o as de,d as ge,i as d,e as o,Q as z,f as $,z as ue,U as be,V as Q,S as N,F as pe,m as H,j as q,h as fe,t as h,W as _e,X as ye,O as me,Y as Se,Z as X,g as K,J as he,A as U}from"./index-DDy9UJu5.js";import"./Toast-fgXXMRMX.js";import{E as ve,e as u,S as W,T as J,U as ee,O as E,u as g,V as Le,W as ke,X as te,Y as ae,g as Y,f as xe,F as se,a as Ie,K as we}from"./Util-DtU7H3gG.js";import{s as De}from"./App.module-CbHnVtRQ.js";var Ce=h('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Be=h('<div class="centerBx100 ">'),$e=h('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),Ee=h('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Oe=h("<div class=loader>Loading..."),Ae=h('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Fe,Pe]=V(),M=m(()=>S(()=>import("./SVG-BorztQR9.js"),__vite__mapDeps([0,1,2,3]))),je=m(()=>S(()=>import("./FlexSpace-oakX2pYv.js"),__vite__mapDeps([4,1,2]))),Ke=m(()=>S(()=>import("./DropDwnSearch-Bj9ALTm7.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),Me=m(()=>S(()=>import("./ScanningCamera-Bj7GUrwQ.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),Re=m(()=>S(()=>import("./ScanningManual-DjHpg_U1.js"),__vite__mapDeps([22,1,2,3,13,14,10,11,20,21])));m(()=>S(()=>import("./LoadingColorSpinner-CqOoNWeg.js"),__vite__mapDeps([23,1,2,24])));const[f,ne]=F(""),[O,re]=F([]);function Te(){V({});const[e,t]=F(1),[a,s]=_e(),n=i=>()=>s(()=>t(i));ce(()=>{b()}),de(()=>{}),ge(()=>{q()&&t(0),Je(),ie(),at()});function c(){return"geolocation"in navigator}function r(i){me({latitude:i?.coords?.latitude,longitude:i?.coords?.longitude})}function b(){c()?navigator.geolocation.getCurrentPosition(r):showMessage("Geolocation isn't supported by your browser")}const I=()=>ye?.list?.filter(i=>i.id);return(()=>{var i=Ee(),P=i.firstChild,j=P.nextSibling,v=j.nextSibling,w=v.nextSibling;return d(v,o(Ke,{get list(){return I()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return f()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:l=>ne(l.id),width:"260px"})),d(w,o(N,{get when(){return f()},get children(){return[(()=>{var l=Ce(),L=l.firstChild,_=L.firstChild,D=_.firstChild,y=L.nextSibling,k=y.firstChild,C=k.firstChild;return z(L,"click",n(0),!0),d(D,o(M,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),z(y,"click",n(1),!0),d(C,o(M,{name:"keyboard",size:32,color:"#2b2b2b"})),$(p=>{var x=e()===0,B=e()===1;return x!==p.e&&L.classList.toggle("selected",p.e=x),B!==p.t&&y.classList.toggle("selected",p.t=B),p},{e:void 0,t:void 0}),l})(),(()=>{var l=Be();return d(l,o(ue,{get fallback(){return Oe()},get children(){return o(be,{get children(){return[o(Q,{get when(){return e()===0},get children(){return o(Me,{get status(){return f()},get locat(){return f()}})}}),o(Q,{get when(){return e()===1},get children(){return o(Re,{get status(){return f()},get locat(){return f()}})}})]}})}})),$(()=>l.classList.toggle("pending",!!a())),l})()]}}),null),d(w,o(N,{get when(){return O()?.length>0},get children(){return[$e(),o(pe,{get each(){return ve(O(),"timeStamp",0)},children:(l,L)=>(()=>{var _=Ae(),D=_.firstChild,y=D.firstChild,k=y.nextSibling,C=k.nextSibling,p=D.nextSibling,x=p.firstChild,B=x.nextSibling,oe=B.nextSibling;return d(y,o(M,{get name(){return u("M023009")?.statusListIcons?.[l?.currentStatus]},size:32})),k.style.setProperty("padding","8px"),d(k,()=>l?.idairguide),C.style.setProperty("padding","8px"),d(C,()=>l?.tracking),d(_,o(je,{}),p),d(x,()=>l?.city),d(oe,()=>l?.consigneeInfo?.ybestate),$(()=>H(_,`client_item_box gWXAaj jlytmu manifest  ${q()?"isMobile":"centerBx"}`)),_})()})]}}),null),$(()=>H(i,De.App)),i})()}fe(["click"]);const lt=Object.freeze(Object.defineProperty({__proto__:null,default:Te,scannedQRs:Fe,setScannedQRs:Pe,setStatus:ne,setTaskScan:re,status:f,taskScan:O},Symbol.toStringTag,{value:"Module"}));let Ge=[400,300,400,300,400],T=[300,80,300,80,300,80,300];const[Ve,ot]=F(!1),[R,ct]=V({scan:{}}),We=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let a=e.split("/")?.[0];return a.indexOf("230")>=0&&(a="230"+(a.split("230")?.[1]).slice(0,6)),a.indexOf("231")>=0&&(a="231"+(a.split("231")?.[1]).slice(0,5)),{params:{":search0":a},code:1}};function ze(e,t){return Math.floor(Math.random()*(t-e+1))+e}const dt=async(e,t)=>{let a=We(e),s={timeStamp:new Date().getTime(),latitude:X?.latitude,longitude:X?.longitude,statusId:t,userId:K?.profile?.userId,userName:K?.profile?.name};if(Ve()){let n=36e5;s.timeStamp=R?.scan?.timeStamp+n*10+ze(1,n*10),s.userId=R?.scan?.userId,s.userName=R?.scan?.userName,s.userIdAdm=K?.profile?.userId}if(t&&a?.params)return await Qe(a.params,s);{let n=a?.txt||a?.params?.[":search0"];return navigator.vibrate(T),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:n}}}}}},Qe=async(e,t)=>{let a=null;if(he()){qe();let s=u("manifestByHbls")?.[e?.[":search0"]],n=u("manifestByKeys")?.[s];if(!n){let c={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(T),{error:{alert:"error",color:"rgb(200 25 60)",scanData:c}}}a=Ne(n,t)}else a=await He(e,t);if(a?.code===203||a?.code===303)return navigator.vibrate(Ge),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let s={...a.data};return s.tracking=e?.[":search0"],s.timeStamp=new Date().getTime(),re([...O(),s]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let s={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(T),{error:{alert:"error",color:"rgb(200 25 60)",scanData:s}}}},Ne=(e,t)=>{let a={currentStatus:t?.statusId};e?.isSSG&&U?.roles?.SSG?.isActive;let s=e?.address?.estate||e?.consigneeInfo?.ybestate,n=e?.address?.city||e?.consigneeInfo?.ybcity;if(!U?.roles?.[s]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};let c=u("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(c===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:s,bagnumber:e?.bagnumber}}};let r=c?.split("_")?.[1],b=t?.statusId?.split("_")?.[1];if(r&&b&&r*1>b*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+c,ybestate:s,bagnumber:e?.bagnumber}}};let I={idairguide:e?.idairguide,city:n,estate:s,consigneeInfo:{ybestate:s,ybcity:n},bagnumber:e?.bagnumber,isSSG:e?.isSSG},i={...t};i.ssg_track_key=e?.ssg_track_key,i.ssg_scan_key=we();let P={form:i,itmN:I,params:{airguide:e?.guia},actionKey:815005};Ye(P);let j={...i};Ze(j);let v={...u("ScannedLocByKey")};return v[e?.ssg_track_key]=i,g("ScannedLocByKey",v),{code:200,data:{...I,...a}}},He=async(e,t)=>{let a={params:e,form:t},s=Y(802001);return s=Y(802008),a={...a,...s},(await xe(a))?.data};let Z=null;const qe=()=>{Z||(Z=setInterval(()=>{Ue(),Xe()},750))},gt=()=>{A=new Date().getTime()};let A=0;const Xe=()=>{A+1250<new Date().getTime()&&(A=99999999999990,se(ee,J,u("dbScannedStore")))};let G=0;const Ue=()=>{G+1250<new Date().getTime()&&(G=99999999999990,se(ae,te,u("ScannedLocList")))},Ye=async e=>{A=new Date().getTime();let t={...u("dbScannedStore")};t[Ie()]=e,g("dbScannedStore",t)},Ze=async e=>{G=new Date().getTime();let t={...u("ScannedLocList")};t[e?.ssg_scan_key]=e,g("ScannedLocList",t)},Je=async()=>{let e=await W(ee,J);et(e)},et=async e=>{let t={};e&&E(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key,c=s?.guia;console.log(c);let r=s?.data2update?.currentStatus;t[n]||(t[n]={}),t[n][r]||(t[n][r]=1)}),g("alredyScan",t),tt(),Se(E(e)?.length)},ie=async()=>{let e=await W(ke,Le),t={},a={},s={},n={};return e&&E(e)?.map(c=>{let r=e?.[c];r?.hbls?.map(b=>{a[b?.hbl]||(a[b?.hbl]=r?.ssg_track_key,s[b?.hbl]=r)}),t[r?.ssg_track_key]||(t[r?.ssg_track_key]=r),n[r?.guia]?n[r?.guia]+=1:n[r?.guia]=1}),g("total_guia",n),g("manifestByKeys",t),g("manifestByHbls",a),g("hblsObjDBInd",s),t},tt=async()=>{await le()},at=async()=>{await le(),ie()},le=async()=>{let e=await W(ae,te),t={};return E(e)?.map(a=>{let s=e[a],n=s?.ssg_track_key;t[n]?t[n]?.timeStamp<s?.timeStamp&&(t[n]=s):t[n]=s}),g("ScannedLocList",e),g("ScannedLocByKey",t),e};export{lt as S,Je as a,gt as b,ot as c,ct as d,R as f,dt as h,at as l,Ve as o,qe as s,Ye as u};
