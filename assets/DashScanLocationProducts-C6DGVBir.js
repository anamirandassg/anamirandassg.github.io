const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FlexSpace-oDSq8ri8.js","assets/index-CMRsWGOd.js","assets/index-DaYrm968.css","assets/SVG-B6VmFfhN.js","assets/Util-B8-DWw-6.js","assets/LoadingColorSpinner-Fjj_yTjY.js","assets/LoadingColorSpinner-DPNLfwBi.css","assets/InputHr-Cwz8hOft.js","assets/InputHr-BXFw4d2l.css","assets/ButonHrm-Bc6vqX3S.js","assets/ButonHrm-BSeWNUGQ.css"])))=>i.map(i=>d[i]);
import{l as A,_ as F,c as R,a as P,o as mt,b as ft,d as T,i as o,e as h,F as Q,S as J,p as _t,f as V,k as tt,m as ht,g as z,h as bt,t as w}from"./index-CMRsWGOd.js";import{O,g as G,f as et,m as $t,k as gt,i as D,a as N,E as yt,n as Ct}from"./Util-B8-DWw-6.js";import{g as st,a as rt}from"./handelImagesServices-BiGKuZwR.js";import{OpenToast as it}from"./Toast-DW6JLgQU.js";import{validStores as vt}from"./AddInventory-D9TcvxFl.js";import{I as kt}from"./print_invoice_service-Dpnk9a8z.js";import"./browser-image-compression-BVJ4p9S0.js";import"./DialogHRM-xj-zv1AF.js";import"./debounces-CDzb-NWw.js";import"./DashProducts-D56RSzV7.js";import"./App.module-CbHnVtRQ.js";import"./FlexSpace-oDSq8ri8.js";import"./fontkit.es-BHcUmD3g.js";import"./InitPrintServices-BhTuseMZ.js";import"./qrcode-DHy8FFhS.js";var It=w('<div style="padding:50px 0 0 0"><section class=qsuVSc><section class=bLl6je><section class="dvPdhb ">'),xt=w('<section class="h6rxkc ">'),wt=w('<section class="rtS8wf InvE"><div class=X3QHFf><section class=WirBi><section class=""><section class="EMijzc centerBx"><div class="icon_status centerBx "style="margin:0 4px"></div><div class="icon_status centerBx "style="margin:0 4px"></div></section><section class="EMijzc centerBx"><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true class=h5M7vb>Almacen: <select class=RIw0b aria-label=Stores></select></span></section><p class=GehUpe data-test-line-item-price=""> </p><section class=dEfaq><section class=JpKBkb><button class=yjHiqb><span>Imprimir Inventario</span></button></section><section class=JpKBkb><button class=yjHiqb><span>Comparar Inventario'),St=w("<option>"),qt=w('<section class="kGEQJf "><section class="Z722Ge InvE"><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe><section class=Jm2qx><span aria-hidden=true>Qty: <span class=h5M7vb></span></span></section><section class=dEfaq><section class=JpKBkb><button class=yjHiqb><span>Remover'),Et=w('<div class="icon_status centerBx "style="margin:0 4px">'),Ot=w('<span class=" centerBx"><span class=fnT8></span><span><div class="icon_status centerBx "style="margin:0 4px">'),Pt=w('<div class="GehUpe centerBx"data-test-line-item-price="">'),Dt=w("<section class=kGEQJf><section class=Z722Ge><section class=VcJUVb><section class=h7Oog><span class=YdB1ac><img class=bwpkad alt=sf></span><section class=pFJUxe><section class=wDj5sf><span data-line-number=1><span class=XNnpOb href=#> </span></span></section><section class=DHk3Fe>");A(()=>F(()=>import("./FlexSpace-oDSq8ri8.js"),__vite__mapDeps([0,1,2])));const L=A(()=>F(()=>import("./SVG-B6VmFfhN.js"),__vite__mapDeps([3,1,2,4])));A(()=>F(()=>import("./LoadingColorSpinner-Fjj_yTjY.js"),__vite__mapDeps([5,1,2,6])));const ct=A(()=>F(()=>import("./InputHr-Cwz8hOft.js"),__vite__mapDeps([7,1,2,8])));A(()=>F(()=>import("./ButonHrm-Bc6vqX3S.js"),__vite__mapDeps([9,1,2,3,4,10])));const[M,j]=R({items:{}}),q="348723orh2idsffs";function te(){P(0);const[t,i]=P("");mt(()=>{}),ft(()=>{}),T(()=>{e()});const e=async()=>{(await At())?.map(c=>{j("items",c.doc)})};return(()=>{var s=It(),c=s.firstChild,a=c.firstChild,n=a.firstChild;return o(n,h(J,{get when(){return O(M?.items?.products)},get children(){return h(Q,{get each(){return O(M?.items?.products)},children:(p,u)=>h(Ut,{get itm(){return M?.items?.products?.[p]}})})}})),o(c,h(Bt,{updSearch:i}),null),s})()}const Bt=t=>{const[i,e]=P(""),[s,c]=P(1),[a,n]=P("");T(()=>{n(z?.profile?.agencyStore?.id)});const p=()=>{s()===1&&i().length>8&&u(i())},u=async d=>{let m=`${d}`,f=await H(m),r=O(f)?.[0],l=1,_=await U(q)||{};_?.products?.[r]&&(l=_?.products?.[r].qty*1+1);let b=_;if(_?.products||(b.products={},b._id=q),_?.products?.[r])b.products[r].qty=l;else{let g={product:{id:r,label:f?.[r]?.name,code:f?.[r]?.code},qty:l};b.products[r]=g}D.put(b,function(I,v){}),j("items",b),e(""),it({text:f?.[r]?.name+" agregado al inventario",timeout:3500,theme:"blue",id:N()})},[y,{refetch:C}]=_t(i,async d=>{if(s()===2&&d.length>4){const m=await H(d);let f=[];return O(m).map(r=>{let l=m[r];f.push(l)}),f}else return[]}),$=()=>{e(""),c(1)},k=async()=>{let d=`${a()}`,m=await Z(d,d),r=(await U(q)||{})?.products;O(m)?.map(_=>{m[_]?.products?.map(b=>{let g=b?.product?.id;r[g]&&(r[g].stock||(r[g].stock=0),r[g].stock+=b?.qty*1)})});let l=await U(q)||{};l.products=r,j("items",l)},E=async()=>{let d=`${a()}`,m=await Z(d,d),r=(await U(q)||{})?.products,l={};O(r)?.map(I=>{l[I]=r[I]}),O(m)?.map(I=>{m[I]?.products?.map(v=>{let x=v?.product?.id;l[x]?(l[x].stock||(l[x].stock=0),l[x].stock+=v?.qty*1):(l[x]||(l[x]={product:v?.product,stock:v?.qty*1}),l[x].stock+=v?.qty*1)})});let _=yt(l),b={products:_,createDate:new Date().getTime(),store:a()};Ct(`conteo_${N()}.csv`,_);let g=await kt(b);window.open(g)};return(()=>{var d=wt(),m=d.firstChild,f=m.firstChild,r=f.firstChild,l=r.firstChild,_=l.firstChild,b=_.nextSibling,g=l.nextSibling,I=g.firstChild,v=I.firstChild,x=v.nextSibling,K=x.firstChild,lt=K.firstChild,nt=lt.firstChild,X=nt.nextSibling,at=K.nextSibling,ot=at.nextSibling,Y=ot.firstChild,dt=Y.firstChild,ut=Y.nextSibling,pt=ut.firstChild;return o(r,h(J,{get when(){return y()?.length>0},get children(){var S=xt();return o(S,h(Q,{get each(){return y()},children:(W,B)=>h(Ft,{itm:W,clearTx:$})})),S}}),l),o(l,h(ct,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return i()},placeholder:"buscar productos ...",colors:"#2b2b2b",handleClick:e,onEnter:p}),_),_.$$click=()=>c(1),o(_,h(L,{name:"qrcode-scan",size:22,get color(){return s()===1?"#646cff":""}})),b.$$click=()=>c(2),o(b,h(L,{name:"keyboard",size:22,get color(){return s()===2?"#646cff":""}})),X.addEventListener("change",S=>{n(S?.target?.value)}),o(X,h(Q,{get each(){return vt()},children:(S,W)=>(()=>{var B=St();return o(B,()=>S?.label),V(()=>B.selected=a()===S?.id),V(()=>B.value=S?.id),B})()})),dt.$$click=E,pt.$$click=k,d})()},Ut=t=>{const[i,e]=R(),s=()=>i?.[t?.itm?.product?.id]?.productImageUrl?st()+rt()+"/"+i?.[t?.itm?.product?.id]?.productImageUrl:null,c=async()=>{let n=t?.itm?.product?.id,p=`${n}`,u=await H(p);u?.[n]?.productImageUrl&&e(n,u?.[n])};T(()=>{c()});const a=()=>{D.get(q,function(p,u){let y={...u};delete y.products[t?.itm?.product?.id],D.put(y,function($,k){$||j("items","products",t?.itm?.product?.id,void 0)})})};return(()=>{var n=qt(),p=n.firstChild,u=p.firstChild,y=u.firstChild,C=y.firstChild,$=C.firstChild,k=C.nextSibling,E=k.firstChild,d=E.firstChild,m=d.firstChild;m.firstChild;var f=E.nextSibling,r=f.firstChild,l=r.firstChild,_=l.firstChild,b=_.nextSibling,g=r.nextSibling,I=g.firstChild,v=I.firstChild;return o(m,()=>t?.itm?.product?.label,null),o(b,()=>t?.itm?.qty),o(f,h(Vt,{get itm(){return t?.itm}}),g),v.$$click=a,V(()=>tt($,"src",s())),n})()},Vt=t=>{const i=()=>t?.itm?.stock&&t?.itm?.stock-t?.itm?.qty>1?null:1,e=()=>t?.itm?.stock&&t?.itm?.stock===t?.itm?.qty?1:0;return(()=>{var s=Pt();return o(s,h(J,{get when(){return e()},get children(){var c=Et();return o(c,h(L,{name:"check_circle_outline",size:26,color:"#137333ff"})),c}}),null),o(s,h(J,{get when(){return!e()},get children(){var c=Ot(),a=c.firstChild,n=a.nextSibling,p=n.firstChild;return o(a,()=>(t?.itm?.stock?t?.itm?.stock:0)?.toFixed(2)),o(p,h(L,{get name(){return i()?"plus":"minus"},size:18,get color(){return i()?"#137333ff":"#c8193c"}})),o(n,()=>(t?.itm?.stock?t?.itm?.stock-t?.itm?.qty:t?.itm?.qty)?.toFixed(2),null),V(()=>ht(n,`${i()?"mnwi":"koi3M"} fnT8 centerBx`)),c}}),null),s})()},H=async(t,i)=>{let e={params:{businessId:z?.profile?.businessYId}};t&&t.split(" ").map((a,n)=>{a&&(e.params[":search"+n]=a.trim())});let s=G(122001);e={...e,...s},e.params[":search0"];const c=await et(e);return c?.error?{}:c},ee=async t=>{let i=[];t.map(e=>{let s={params:{id:e?.ssg_track_key,idairguide:"all"}},c=G(802002);s={...s,...c},i.push(s)}),$t(i,jt)},jt=async t=>{const e=await gt(t);if(e)return e},At=()=>new Promise((t,i)=>{D.allDocs({include_docs:!0,descending:!0},function(e,s){t(s.rows)})}),Ft=t=>{const[i,e]=R(),[s,c]=P(""),a=()=>i?.prod?.productImageUrl?st()+rt()+"/"+i?.prod?.productImageUrl:null;T(()=>{e("prod",t?.itm)}),Array.from(Array(10).keys());const n=async()=>{let p=s()*1,u=i?.prod?.ssg_product_key,y=p,C=await U(q)||{};C?.products?.[u]&&(y=C?.products?.[u].qty+p);let $=C;if(C?.products||($.products={},$._id=q),C?.products?.[u])$.products[u].qty=y;else{let k={product:{id:u,label:t?.itm?.name,code:t?.itm?.code},qty:y};$.products[u]=k}D.put($,function(E,d){}),j("items",$),t?.clearTx(),it({text:" El inventario fue actualizado",timeout:3500,theme:"blue",id:N()})};return(()=>{var p=Dt(),u=p.firstChild,y=u.firstChild,C=y.firstChild,$=C.firstChild,k=$.firstChild,E=$.nextSibling,d=E.firstChild,m=d.firstChild,f=m.firstChild;f.firstChild;var r=d.nextSibling;return o(f,()=>t?.itm?.name,null),o(r,h(ct,{width:"90px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",type:"number",get value(){return s()},placeholder:"Cantidad",colors:"#2b2b2b",handleClick:c,onEnter:n})),V(()=>tt(k,"src",a())),p})()},U=t=>new Promise((i,e)=>{D.get(t,function(c,a){i(a)})}),Z=async(t,i)=>{let e={params:{businessId:z?.profile?.businessYId,":store":i.trim()}};t&&t.split(" ").map((a,n)=>{a&&(e.params[":search"+n]=a.trim())});let s=G(132001);e={...e,...s},e.params[":search0"];const c=await et(e);return c?.error?{}:c};bt(["click"]);export{Z as LookupInventory,H as LookupProducts,te as default,jt as fetchCSVInve,U as getCartId,M as inventoryItems,q as inventoryKey,At as loadCarts,ee as loadProduct,j as setInventoryItems};
