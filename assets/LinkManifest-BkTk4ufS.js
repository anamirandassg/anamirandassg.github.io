const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoadingColorSpinner-DguuT5wE.js","assets/index-BcPxdzNG.js","assets/index-DGHHyjai.css","assets/LoadingColorSpinner-DPNLfwBi.css","assets/DropDwnSearch-D_W-rrDn.js","assets/debounces-nsG59_FJ.js","assets/SVG-CgaNqNB-.js","assets/index-Ci0zXM0r.js","assets/DropDwnSearch-DMkLkRPc.css","assets/InputHr-CylqAq1X.js","assets/InputHr-M3rJ9grQ.css","assets/ItemOnManifestList-B-eiDZPH.js","assets/Util-uEfv1z7O.js","assets/DialogHRM-CHw8HR8n.js","assets/DialogHRM-V9_lZntj.css","assets/globalSignal-CTzzE19b.js","assets/PDFButton-B_0lS8EG.js","assets/fontkit.es-BKe7DAJ7.js","assets/InitPrintServices-CprHcwF4.js"])))=>i.map(i=>d[i]);
import{l as D,_ as z,c as P,a as ue,u as be,D as fe,o as me,h as pe,m as he,b as ve,i as c,d as g,f as ce,e as ye,t as M,v as X,S as q,j as xe,r as ke,F as we,E as $e,s as Se}from"./index-BcPxdzNG.js";import{b as E,f as T,O as $,e as Ce,a as Z,g as de,p as Me}from"./Util-uEfv1z7O.js";import{u as Ae}from"./debounces-nsG59_FJ.js";import{i as ee}from"./globalSignal-CTzzE19b.js";import{P as Le,r as w}from"./PDFButton-B_0lS8EG.js";import{f as Oe}from"./fontkit.es-BKe7DAJ7.js";import{i as Be,t as x,b as Pe}from"./InitPrintServices-CprHcwF4.js";import"./index-Ci0zXM0r.js";const De=(a,l,e)=>{const i=l.widthOfTextAtSize(a,40),n=l.widthOfTextAtSize(a,10);return Math.floor(e/((i-n)/30))},ze=async(a,l,e)=>{const i=await Le.create();i.registerFontkit(Oe);const n=await Be(i);let f=265,m=30,p=Math.ceil(a.length/m);Array.from(Array(p).keys()).map(k=>{let V=a.slice(k*m,(k+1)*m);const h=i.addPage(),{height:A}=h.getSize();let F=A-74;V.map((_,I)=>{let o=F;I%2&&h?.drawRectangle({x:10,y:o-15,width:580,height:24,color:w(.7,.7,.7)});let Y=De(x(_?.state),n.roboto_bold,f),N=0;Y>42&&(Y=42,o=o-6);let R=_?.bagnumber;const G=n.Lexend_700.widthOfTextAtSize(x(R),5);h.drawText(x(R),{x:575-G,y:o-3,size:5,font:n.Lexend_700,color:w(0,0,0)});let j=_?.consigneeInfo?.ybcity+" | "+_?.consigneeInfo?.ybestate;const H=n.Lexend_700.widthOfTextAtSize(x(j),7);_?.cidentity&&h.drawText(x(_?.cidentity),{x:25,y:o+3,size:7,font:n.Lexend_700,color:w(0,0,0)}),_?.consigneeInfo?.ybestate&&h.drawText(x(j),{x:575-H,y:o+3,size:7,font:n.Lexend_700,color:w(0,0,0)});let t="";_?.hbls.map((s,u)=>{t+=(u>0?"  |  ":"")+s?.hbl}),h.drawText(x(t),{x:45,y:o-3,size:5,font:n.Lexend_700,color:w(0,0,0)}),N+=_?.pricePP*_?.totalWeight,F=o-18}),h.drawText("Guia: "+x(e?.guia),{x:17,y:A-22,size:12,font:n.Lexend_700,color:w(0,0,0)}),h.drawText("Fecha: "+x(e?.date),{x:19,y:A-35,size:10,font:n.Lexend_700,color:w(0,0,0)})});{const k=await i.save();return Pe(k)}};var Ee=M("<h5>"),Te=M("<div style=padding:4px>"),Fe=M('<div class="_dsplFlx hdr_bar purple"><div class="tr_bar tr_bar_5 align_itm centerBx"><div class="icon align_itm"></div></div><div class="tr_bar tr_bar_20 align_itm left_alg bottombx"><h5> / <!> Seleccionado(s)</h5></div><div class="tr_bar tr_bar_70"></div><div><div class="icon align_itm"></div></div><div><div class="icon align_itm">'),Ie=M('<div><div class=bottombx><div class="_dsplFlx flxWrp spaceAround centerBx"><h4></h4><h4></h4></div></div><div class="_dsplFlx flxWrp spaceAround centerBx"><div style=padding:4px></div><div style=padding:4px></div></div><div>'),Re=M("<div> <!>."),je=M("<div> ");const We=D(()=>z(()=>import("./LoadingColorSpinner-DguuT5wE.js"),__vite__mapDeps([0,1,2,3]))),ge=D(()=>z(()=>import("./DropDwnSearch-D_W-rrDn.js"),__vite__mapDeps([4,1,2,5,6,7,8]))),qe=D(()=>z(()=>import("./InputHr-CylqAq1X.js"),__vite__mapDeps([9,1,2,10]))),te=D(()=>z(()=>import("./SVG-CgaNqNB-.js"),__vite__mapDeps([6,1,2,7]))),Qe=D(()=>z(()=>import("./ItemOnManifestList-B-eiDZPH.js"),__vite__mapDeps([11,1,2,12,7,5,13,14,15,16,17,18]))),[B,Q]=P({list:{}}),[it,st]=ue("");function at(){const[a,l]=be(),[e,i]=P({search:""}),[n,f]=P(),[m,p]=P(),k=fe(),[V,h]=P(),[A,F]=ue(""),_=Ae(F,400),I=(t,s)=>{i({[t]:s}),_(de())};me(()=>{Q("list",void 0)}),pe(()=>{}),he(async()=>{let t=[];[33,46,40,41,42,50,52,54,56].map(d=>{let b=d,v=Z("M023009")?.whStList?.[b];X?.roles?.[v?.id]?.isActive&&t.push(v)}),h("list",t);let u=[];if(Z("M023009")?.provincias.map(d=>{let b=d.label;X?.roles?.[b]?.isActive&&u.push(d)}),h("prov",u),a?.mId){let d={id:a?.mId},b=await Ge(d);i("province",b?.province),i("city",b?.city),i("manifestObj",b),p("linked",b?.linkedBags)}});const[o,{refetch:Y}]=ve(A,async t=>{let s=e?.manifest?.id,u=e?.province,d=u&&e?.city,b=e?.warehouse?.id,v=[];if(s){const S=await Ve(e.search,s,u,d,b);f("bags",S),$(S).map(K=>{let C=S[K],r=C.currentStatus;X?.roles?.[r]?.isActive&&r.split("_")?.[1]>=33&&v.push(C)})}return v}),N=(t,s)=>{i({[t]:s}),_(de()),Q("list",void 0),setTimeout(()=>{Q("list",{})},670)},R=()=>{let t={},s=0;$(B?.list)?.length!==o()?.length?(s=1,o().map(u=>{let d=u.ssg_track_key;t[d]=s})):o().map(u=>{let d=u.ssg_track_key;t[d]=void 0}),Q("list",t)},G=async()=>{let t={...m?.linked};$(B?.list).map(s=>{t?.[s]||(t[s]={idairguide:n?.bags?.[s]?.idairguide})}),p("linked",t),await Ye({ssg_manifest_key:a?.mId},{linkedBags:t}),k("/manifest",{replace:!0})},j=()=>{let t=[];$(B?.list).map(s=>{n?.bags?.[s]&&t.push(n?.bags?.[s])}),H(t)},H=async t=>{let s=await ze(t,!0,{guia:t[0]?.idairnumber,date:Me()});window.open(s)};return(()=>{var t=Ie(),s=t.firstChild,u=s.firstChild,d=u.firstChild,b=d.nextSibling,v=s.nextSibling,S=v.firstChild,K=S.nextSibling,C=v.nextSibling;return c(d,()=>e?.manifestObj?.name),c(u,g(q,{get when(){return e?.manifestObj?.city},get children(){return["|",(()=>{var r=Ee();return c(r,()=>e?.manifestObj?.city),r})()]}}),b),c(b,()=>e?.manifestObj?.province),c(S,g(ge,{get list(){return Z("M023009")?.manifestList},lbl_empty:"Guia",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.manifest?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>N("manifest",r),width:"260px"})),c(K,g(ge,{get list(){return V?.list},lbl_empty:"Almacen",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return e?.warehouse?.id},borderColor:"#b2b2b2",hasDebounce:!0,borderActiveColor:"var(--background-red-ssg)",onSelect:r=>I("warehouse",r),width:"260px"})),c(v,g(q,{get when(){return e?.manifest?.id},get children(){var r=Te();return c(r,g(qe,{width:"260px",backColor:"#ffffff",borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",get value(){return e?.search},placeholder:"search...",colors:"#2b2b2b",handleClick:y=>I("search",y)})),r}}),null),c(C,g(q,{get when(){return xe(()=>!!e?.manifest?.id)()&&o().length>0},get children(){var r=Fe(),y=r.firstChild,W=y.firstChild,L=y.nextSibling,U=L.firstChild,re=U.firstChild,ie=re.nextSibling;ie.nextSibling;var _e=L.nextSibling,J=_e.nextSibling,se=J.firstChild,ae=J.nextSibling,ne=ae.firstChild;return r.style.setProperty("margin","18px 0"),W.$$click=R,c(W,g(te,{get name(){return $(B?.list)?.length<o()?.length?"minus-circle-outline":"check_circle_outline"},color:"var(--background-red-ssg)"})),c(U,()=>$(B?.list)?.length,re),c(U,()=>o()?.length,ie),se.$$click=G,c(se,g(te,{name:"link",color:"var(--background-red-ssg)"})),ne.$$click=j,c(ne,g(te,{name:"printer",color:"var(--background-red-ssg)"})),ce(O=>{var le=` ${ee()?"tr_bar_15":"tr_bar_05"} tr_bar  align_itm centerBx"`,oe=` ${ee()?"tr_bar_10":"tr_bar_05"} tr_bar  align_itm centerBx"`;return le!==O.e&&(J.className=O.e=le),oe!==O.t&&(ae.className=O.t=oe),O},{e:void 0,t:void 0}),r}}),null),c(C,g($e,{fallback:r=>(()=>{var y=Re(),W=y.firstChild,L=W.nextSibling;return L.nextSibling,c(y,()=>r.toString(),L),y})(),get children(){return g(ke,{get fallback(){return(()=>{var r=je();return r.firstChild,c(r,g(We,{stroke:"rgb(200 25 60 / 1)",size:62}),null),r})()},get children(){return g(q,{get when(){return o()},get children(){return g(we,{get each(){return o()},children:r=>g(Qe,{item:r,get isAlready(){return m?.linked?.[r.ssg_track_key]}})})}})}})}}),null),ce(r=>Se(C,` ${ee(),"width:86vw;"} margin: 0 auto;`,r)),t})()}const Ve=async(a,l,e,i,n)=>{let f={params:{idairguide:l,":store":n}};a&&a.split(" ").map((p,k)=>{p&&(f.params[":search"+k]=p.trim())}),e&&(f.params[":estate"]=e),i&&(f.params[":city"]=i);let m=E(802001);if(f={...f,...m},l&&n){const p=await T(f);return p?.error?{}:p}else return{}},Ye=async(a,l)=>{let e={params:a,data2update:l},i=E(709002);e={...e,...i};const n=await T(e),f=$(l?.linkedBags).map(async(m,p)=>{await Ne({ssg_track_key:m,idairguide:l?.linkedBags?.[m]?.idairguide},{currentManifestKey:a?.ssg_manifest_key})});return await Promise.all(f),n},Ne=async(a,l)=>{let e={params:a,data2update:l},i=E(809004);return e={...e,...i},await T(e)},Ge=async a=>{let l={params:a},e=E(703003);return l={...l,...e},await T(l)},nt=async a=>{let l=[];a.map(e=>{let i={params:{id:e?.ssg_track_key,idairguide:e?.idairguide}},n=E(802002);i={...i,...n},l.push(i)}),Ce(l,He)},He=async a=>{const e=await T(a);if(e)return e};ye(["click"]);export{at as default,He as fetchCSVInve,nt as loadManifest,it as manifestObs,B as selectedManifest,st as setManifestObs,Q as setSelectedManifest,Ye as updLinkedBags};
