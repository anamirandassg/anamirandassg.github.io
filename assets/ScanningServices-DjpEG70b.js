const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SVG-y2izSF3R.js","assets/index-C6GDYHVF.js","assets/index-BRlA1Q7g.css","assets/Util-CJwQ4eI5.js","assets/FlexSpace-g1DYwxLv.js","assets/DropDwnSearch-CSNDmB0A.js","assets/debounces-DWdDstI7.js","assets/DropDwnSearch-DMkLkRPc.css","assets/ScanningCamera-DwVFwSDy.js","assets/html5-qrcode-scanner-oazqLk9I.js","assets/Toast-B5mSnyhw.js","assets/Toast-DLpFKn-Q.css","assets/ShowSSG-DmJILxr0.js","assets/DialogHRM-BVGQ5Wrr.js","assets/DialogHRM-V9_lZntj.css","assets/ShowScanAlert-NS0fdH_s.js","assets/ShowQRPrintLabel-D0Noia-S.js","assets/fontkit.es-yAesCE8D.js","assets/qrcode-DHy8FFhS.js","assets/InitPrintServices-tbDVtYPt.js","assets/App.module-CbHnVtRQ.js","assets/App-BDG5NEkI.css","assets/ScanningManual-DQTP8Air.js","assets/LoadingColorSpinner-BkbKZ_cB.js","assets/LoadingColorSpinner-DPNLfwBi.css"])))=>i.map(i=>d[i]);
import"./Toast-B5mSnyhw.js";import{c as U,l as S,_ as m,a as K,b as le,o as ce,d as de,i as c,e as o,Q as T,f as C,z as ge,U as ue,V,S as W,F as be,m as z,j as Q,h as fe,t as v,W as pe,X as _e,O as ye,Y as Se,Z as H,g as q,J as me,A as N}from"./index-C6GDYHVF.js";import{F as ve,e as g,T as R,U as Y,V as J,O as B,u as d,W as he,X as ke,Y as ee,Z as te,g as X,f as Le,G as ae,a as xe,L as Ie}from"./Util-CJwQ4eI5.js";import{s as we}from"./App.module-CbHnVtRQ.js";var De=v('<ul class=inline><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Camara</div></li><li><div class="_dsplFlx flxWrp spaceAround centerBx"><div class="icon_status centerBx"></div></div><div style=width:135px>Escaner RF'),Ce=v('<div class="centerBx100 ">'),Be=v('<div class=" bottombx lowbordr centerBx "style=padding-top:26px;><h5>Escaneados'),$e=v('<div><div class="_dsplFlx flxWrp spaceAround centerBx"><h2>Escanear</h2></div><div style=padding:16px></div><div class="_dsplFlx flxWrp spaceAround centerBx"></div><div class=centerBx100 style=margin-top:20px>'),Ee=v("<div class=loader>Loading..."),Oe=v('<div style=background:#FFF;width:90%><div class="centerBx bottombx"><div class="icon_status centerBx"></div><h5 class=" centerBx "></h5><p class=" title_scan centerBx "></p></div><div class="centerBx bottombx"><h5></h5><div class=vertseparator></div><h4>');const[Fe,Ae]=U(),A=S(()=>m(()=>import("./SVG-y2izSF3R.js"),__vite__mapDeps([0,1,2,3]))),Pe=S(()=>m(()=>import("./FlexSpace-g1DYwxLv.js"),__vite__mapDeps([4,1,2]))),je=S(()=>m(()=>import("./DropDwnSearch-CSNDmB0A.js"),__vite__mapDeps([5,1,2,6,0,3,7]))),Ke=S(()=>m(()=>import("./ScanningCamera-DwVFwSDy.js"),__vite__mapDeps([8,1,2,3,9,6,10,11,12,13,14,15,16,17,18,19,20,21]))),Re=S(()=>m(()=>import("./ScanningManual-DQTP8Air.js"),__vite__mapDeps([22,1,2,3,13,14,10,11,20,21])));S(()=>m(()=>import("./LoadingColorSpinner-BkbKZ_cB.js"),__vite__mapDeps([23,1,2,24])));const[p,ne]=K(""),[$,se]=K([]);function Ge(){U({});const[e,t]=K(1),[a,n]=pe(),s=l=>()=>n(()=>t(l));le(()=>{f()}),ce(()=>{}),de(()=>{Q()&&t(0),Ze(),re(),Je()});function r(){return"geolocation"in navigator}function u(l){ye({latitude:l?.coords?.latitude,longitude:l?.coords?.longitude})}function f(){r()?navigator.geolocation.getCurrentPosition(u):showMessage("Geolocation isn't supported by your browser")}const O=()=>_e?.list?.filter(l=>l.id);return(()=>{var l=$e(),x=l.firstChild,F=x.nextSibling,G=F.nextSibling,M=G.nextSibling;return c(G,o(je,{get list(){return O()},lbl_empty:"Funciones de Escaneado",backColor:"var(--hrm-palette-primary100)",color:"var(--background-red-ssg)",get value(){return p()},borderColor:"#b2b2b2",borderActiveColor:"var(--background-red-ssg)",hasDebounce:!1,onSelect:i=>ne(i.id),width:"260px"})),c(M,o(W,{get when(){return p()},get children(){return[(()=>{var i=De(),h=i.firstChild,_=h.firstChild,I=_.firstChild,y=h.nextSibling,k=y.firstChild,w=k.firstChild;return T(h,"click",s(0),!0),c(I,o(A,{name:"qrcode-scan",size:32,color:"#2b2b2b"})),T(y,"click",s(1),!0),c(w,o(A,{name:"keyboard",size:32,color:"#2b2b2b"})),C(b=>{var L=e()===0,D=e()===1;return L!==b.e&&h.classList.toggle("selected",b.e=L),D!==b.t&&y.classList.toggle("selected",b.t=D),b},{e:void 0,t:void 0}),i})(),(()=>{var i=Ce();return c(i,o(ge,{get fallback(){return Ee()},get children(){return o(ue,{get children(){return[o(V,{get when(){return e()===0},get children(){return o(Ke,{get status(){return p()},get locat(){return p()}})}}),o(V,{get when(){return e()===1},get children(){return o(Re,{get status(){return p()},get locat(){return p()}})}})]}})}})),C(()=>i.classList.toggle("pending",!!a())),i})()]}}),null),c(M,o(W,{get when(){return $()?.length>0},get children(){return[Be(),o(be,{get each(){return ve($(),"timeStamp",0)},children:(i,h)=>(()=>{var _=Oe(),I=_.firstChild,y=I.firstChild,k=y.nextSibling,w=k.nextSibling,b=I.nextSibling,L=b.firstChild,D=L.nextSibling,oe=D.nextSibling;return c(y,o(A,{get name(){return g("M023009")?.statusListIcons?.[i?.currentStatus]},size:32})),k.style.setProperty("padding","8px"),c(k,()=>i?.idairguide),w.style.setProperty("padding","8px"),c(w,()=>i?.tracking),c(_,o(Pe,{}),b),c(L,()=>i?.city),c(oe,()=>i?.consigneeInfo?.ybestate),C(()=>z(_,`client_item_box gWXAaj jlytmu manifest  ${Q()?"isMobile":"centerBx"}`)),_})()})]}}),null),C(()=>z(l,we.App)),l})()}fe(["click"]);const st=Object.freeze(Object.defineProperty({__proto__:null,default:Ge,scannedQRs:Fe,setScannedQRs:Ae,setStatus:ne,setTaskScan:se,status:p,taskScan:$},Symbol.toStringTag,{value:"Module"}));let Me=[400,300,400,300,400],P=[300,80,300,80,300,80,300];const Te=e=>{e.split("-").length>3&&(e=e.split("-").join("")),e?.split("/")?.length>=5&&(e=e?.split("/")?.[3]),e=e.split(",")?.[0]?.trim(),e=e.split("'").join("-"),e=e.split(",").join("-"),e=e.split(";").join("-");let a=e.split("/")?.[0];return a.indexOf("230")>=0&&(a="230"+(a.split("230")?.[1]).slice(0,6)),a.indexOf("231")>=0&&(a="231"+(a.split("231")?.[1]).slice(0,5)),{params:{":search0":a},code:1}},rt=async(e,t)=>{let a=Te(e),n={timeStamp:new Date().getTime(),latitude:H?.latitude,longitude:H?.longitude,statusId:t,userId:q?.profile?.userId,userName:q?.profile?.name};if(t&&a?.params)return await Ve(a.params,n);{let s=a?.txt||a?.params?.[":search0"];return navigator.vibrate(P),{error:{alert:"error",color:"rgb(200 25 60)",scanData:{consigneeInfo:{ybestate:"Codigo Incorrecto",bagnumber:s}}}}}},Ve=async(e,t)=>{let a=null;if(me()){Qe();let n=g("manifestByHbls")?.[e?.[":search0"]],s=g("manifestByKeys")?.[n];if(!s){let r={consigneeInfo:{ybcity:"Codigo no encontrado",ybestate:"actualice las guias sin coneccion"}};return navigator.vibrate(P),{error:{alert:"error",color:"rgb(200 25 60)",scanData:r}}}a=We(s,t)}else a=await ze(e,t);if(a?.code===203||a?.code===303)return console.log(e,a),navigator.vibrate(Me),{error:{alert:"warning",color:"#FF6F1D",scanData:a.data}};if(a?.code===200){navigator.vibrate(500);let n={...a.data};return n.tracking=e?.[":search0"],n.timeStamp=new Date().getTime(),se([...$(),n]),{error:{alert:"success",color:"#0f5223ff",scanData:a.data}}}else if(!a||a?.error){let n={consigneeInfo:{ybestate:"Codigo Incorrecto"}};return navigator.vibrate(P),{error:{alert:"error",color:"rgb(200 25 60)",scanData:n}}}},We=(e,t)=>{let a={currentStatus:t?.statusId};if(e?.isSSG&&N?.roles?.SSG?.isActive,!N?.roles?.[e?.consigneeInfo?.ybestate]?.isActive)return{code:303,data:{ybestate:"Zona incorrecta",bagnumber:e?.bagnumber}};let n=g("ScannedLocByKey")?.[e?.ssg_track_key]?.statusId;if(n===t.statusId)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado",ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let s=n?.split("_")?.[1],r=t?.statusId?.split("_")?.[1];if(s&&r&&s*1>r*1)return{code:203,data:{consigneeInfo:{ybcity:"Fue escaneado en "+n,ybestate:e?.consigneeInfo?.ybestate,bagnumber:e?.bagnumber}}};let u={idairguide:e?.idairguide,city:e?.consigneeInfo?.ybcity,estate:e?.consigneeInfo?.estate,consigneeInfo:{ybestate:e?.consigneeInfo?.ybestate,ybcity:e?.consigneeInfo?.ybcity},bagnumber:e?.bagnumber,isSSG:e?.isSSG},f={...t};f.ssg_track_key=e?.ssg_track_key,f.ssg_scan_key=Ie();let O={form:f,itmN:u,params:{airguide:e?.guia},actionKey:815005};Ne(O);let l={...f};Xe(l);let x={...g("ScannedLocByKey")};return x[e?.ssg_track_key]=f,d("ScannedLocByKey",x),{code:200,data:{...u,...a}}},ze=async(e,t)=>{let a={params:e,form:t},n=X(802001);return n=X(802008),a={...a,...n},(await Le(a))?.data};let Z=null;const Qe=()=>{Z||(Z=setInterval(()=>{qe(),He()},750))},it=()=>{E=new Date().getTime()};let E=0;const He=()=>{E+1250<new Date().getTime()&&(E=99999999999990,ae(J,Y,g("dbScannedStore")))};let j=0;const qe=()=>{j+1250<new Date().getTime()&&(j=99999999999990,ae(te,ee,g("ScannedLocList")))},Ne=async e=>{E=new Date().getTime();let t={...g("dbScannedStore")};t[xe()]=e,d("dbScannedStore",t)},Xe=async e=>{j=new Date().getTime();let t={...g("ScannedLocList")};t[e?.ssg_scan_key]=e,d("ScannedLocList",t)},Ze=async()=>{let e=await R(J,Y);Ue(e)},Ue=async e=>{let t={};e&&B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key,r=n?.data2update?.currentStatus;t[s]||(t[s]={}),t[s][r]||(t[s][r]=1)}),d("alredyScan",t),Ye(),Se(B(e)?.length)},re=async()=>{let e=await R(ke,he),t={},a={},n={};return e&&B(e)?.map(s=>{let r=e?.[s];r?.hbls?.map(u=>{a[u?.hbl]||(a[u?.hbl]=r?.ssg_track_key,n[u?.hbl]=r)}),t[r?.ssg_track_key]||(t[r?.ssg_track_key]=r,t[r?.ssg_track_key].key=r?.key)}),d("manifestByKeys",t),d("manifestByHbls",a),d("hblsObjDBInd",n),t},Ye=async()=>{await ie()},Je=async()=>{await ie(),re()},ie=async()=>{let e=await R(te,ee),t={};return B(e)?.map(a=>{let n=e[a],s=n?.ssg_track_key;t[s]?t[s]?.timeStamp<n?.timeStamp&&(t[s]=n):t[s]=n}),d("ScannedLocList",e),d("ScannedLocByKey",t),e};export{st as S,Ze as a,it as b,rt as h,re as i,Je as l,Qe as s,Ne as u};
